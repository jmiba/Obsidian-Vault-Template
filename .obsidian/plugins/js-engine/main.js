/*
-------------------------------------------
JS Engine - Release Build
-------------------------------------------
By: Moritz Jung (https://mprojectscode.github.io/)
Time: Mon, 26 Feb 2024 21:20:09 GMT
Version: 0.1.2
-------------------------------------------
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";var Sl=Object.create;var Jn=Object.defineProperty;var Il=Object.getOwnPropertyDescriptor;var Pl=Object.getOwnPropertyNames;var Tl=Object.getPrototypeOf,Cl=Object.prototype.hasOwnProperty;var Fl=(n,e,t)=>e in n?Jn(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Gt=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),Ks=(n,e)=>{for(var t in e)Jn(n,t,{get:e[t],enumerable:!0})},$s=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Pl(e))!Cl.call(n,i)&&i!==t&&Jn(n,i,{get:()=>e[i],enumerable:!(r=Il(e,i))||r.enumerable});return n};var Ht=(n,e,t)=>(t=n!=null?Sl(Tl(n)):{},$s(e||!n||!n.__esModule?Jn(t,"default",{value:n,enumerable:!0}):t,n)),Ol=n=>$s(Jn({},"__esModule",{value:!0}),n);var Re=(n,e,t)=>(Fl(n,typeof e!="symbol"?e+"":e,t),t);var Ea=Gt((gs,_s)=>{(function(n,e){typeof gs=="object"&&typeof _s!="undefined"?_s.exports=e():typeof define=="function"&&define.amd?define(e):(n=typeof globalThis!="undefined"?globalThis:n||self).dayjs=e()})(gs,function(){"use strict";var n=1e3,e=6e4,t=36e5,r="millisecond",i="second",o="minute",s="hour",a="day",l="week",c="month",f="quarter",h="year",d="date",_="Invalid Date",y=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,k=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,W={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(F){var x=["th","st","nd","rd"],w=F%100;return"["+F+(x[(w-20)%10]||x[w]||x[0])+"]"}},J=function(F,x,w){var I=String(F);return!I||I.length>=x?F:""+Array(x+1-I.length).join(w)+F},Z={s:J,z:function(F){var x=-F.utcOffset(),w=Math.abs(x),I=Math.floor(w/60),T=w%60;return(x<=0?"+":"-")+J(I,2,"0")+":"+J(T,2,"0")},m:function F(x,w){if(x.date()<w.date())return-F(w,x);var I=12*(w.year()-x.year())+(w.month()-x.month()),T=x.clone().add(I,c),D=w-T<0,B=x.clone().add(I+(D?-1:1),c);return+(-(I+(w-T)/(D?T-B:B-T))||0)},a:function(F){return F<0?Math.ceil(F)||0:Math.floor(F)},p:function(F){return{M:c,y:h,w:l,d:a,D:d,h:s,m:o,s:i,ms:r,Q:f}[F]||String(F||"").toLowerCase().replace(/s$/,"")},u:function(F){return F===void 0}},re="en",U={};U[re]=W;var se="$isDayjsObject",me=function(F){return F instanceof ie||!(!F||!F[se])},g=function F(x,w,I){var T;if(!x)return re;if(typeof x=="string"){var D=x.toLowerCase();U[D]&&(T=D),w&&(U[D]=w,T=D);var B=x.split("-");if(!T&&B.length>1)return F(B[0])}else{var Y=x.name;U[Y]=x,T=Y}return!I&&T&&(re=T),T||!I&&re},b=function(F,x){if(me(F))return F.clone();var w=typeof x=="object"?x:{};return w.date=F,w.args=arguments,new ie(w)},m=Z;m.l=g,m.i=me,m.w=function(F,x){return b(F,{locale:x.$L,utc:x.$u,x:x.$x,$offset:x.$offset})};var ie=function(){function F(w){this.$L=g(w.locale,null,!0),this.parse(w),this.$x=this.$x||w.x||{},this[se]=!0}var x=F.prototype;return x.parse=function(w){this.$d=function(I){var T=I.date,D=I.utc;if(T===null)return new Date(NaN);if(m.u(T))return new Date;if(T instanceof Date)return new Date(T);if(typeof T=="string"&&!/Z$/i.test(T)){var B=T.match(y);if(B){var Y=B[2]-1||0,C=(B[7]||"0").substring(0,3);return D?new Date(Date.UTC(B[1],Y,B[3]||1,B[4]||0,B[5]||0,B[6]||0,C)):new Date(B[1],Y,B[3]||1,B[4]||0,B[5]||0,B[6]||0,C)}}return new Date(T)}(w),this.init()},x.init=function(){var w=this.$d;this.$y=w.getFullYear(),this.$M=w.getMonth(),this.$D=w.getDate(),this.$W=w.getDay(),this.$H=w.getHours(),this.$m=w.getMinutes(),this.$s=w.getSeconds(),this.$ms=w.getMilliseconds()},x.$utils=function(){return m},x.isValid=function(){return this.$d.toString()!==_},x.isSame=function(w,I){var T=b(w);return this.startOf(I)<=T&&T<=this.endOf(I)},x.isAfter=function(w,I){return b(w)<this.startOf(I)},x.isBefore=function(w,I){return this.endOf(I)<b(w)},x.$g=function(w,I,T){return m.u(w)?this[I]:this.set(T,w)},x.unix=function(){return Math.floor(this.valueOf()/1e3)},x.valueOf=function(){return this.$d.getTime()},x.startOf=function(w,I){var T=this,D=!!m.u(I)||I,B=m.p(w),Y=function(Ae,ve){var Oe=m.w(T.$u?Date.UTC(T.$y,ve,Ae):new Date(T.$y,ve,Ae),T);return D?Oe:Oe.endOf(a)},C=function(Ae,ve){return m.w(T.toDate()[Ae].apply(T.toDate("s"),(D?[0,0,0,0]:[23,59,59,999]).slice(ve)),T)},P=this.$W,j=this.$M,te=this.$D,rt="set"+(this.$u?"UTC":"");switch(B){case h:return D?Y(1,0):Y(31,11);case c:return D?Y(1,j):Y(0,j+1);case l:var $=this.$locale().weekStart||0,ye=(P<$?P+7:P)-$;return Y(D?te-ye:te+(6-ye),j);case a:case d:return C(rt+"Hours",0);case s:return C(rt+"Minutes",1);case o:return C(rt+"Seconds",2);case i:return C(rt+"Milliseconds",3);default:return this.clone()}},x.endOf=function(w){return this.startOf(w,!1)},x.$set=function(w,I){var T,D=m.p(w),B="set"+(this.$u?"UTC":""),Y=(T={},T[a]=B+"Date",T[d]=B+"Date",T[c]=B+"Month",T[h]=B+"FullYear",T[s]=B+"Hours",T[o]=B+"Minutes",T[i]=B+"Seconds",T[r]=B+"Milliseconds",T)[D],C=D===a?this.$D+(I-this.$W):I;if(D===c||D===h){var P=this.clone().set(d,1);P.$d[Y](C),P.init(),this.$d=P.set(d,Math.min(this.$D,P.daysInMonth())).$d}else Y&&this.$d[Y](C);return this.init(),this},x.set=function(w,I){return this.clone().$set(w,I)},x.get=function(w){return this[m.p(w)]()},x.add=function(w,I){var T,D=this;w=Number(w);var B=m.p(I),Y=function(j){var te=b(D);return m.w(te.date(te.date()+Math.round(j*w)),D)};if(B===c)return this.set(c,this.$M+w);if(B===h)return this.set(h,this.$y+w);if(B===a)return Y(1);if(B===l)return Y(7);var C=(T={},T[o]=e,T[s]=t,T[i]=n,T)[B]||1,P=this.$d.getTime()+w*C;return m.w(P,this)},x.subtract=function(w,I){return this.add(-1*w,I)},x.format=function(w){var I=this,T=this.$locale();if(!this.isValid())return T.invalidDate||_;var D=w||"YYYY-MM-DDTHH:mm:ssZ",B=m.z(this),Y=this.$H,C=this.$m,P=this.$M,j=T.weekdays,te=T.months,rt=T.meridiem,$=function(ve,Oe,le,ke){return ve&&(ve[Oe]||ve(I,D))||le[Oe].slice(0,ke)},ye=function(ve){return m.s(Y%12||12,ve,"0")},Ae=rt||function(ve,Oe,le){var ke=ve<12?"AM":"PM";return le?ke.toLowerCase():ke};return D.replace(k,function(ve,Oe){return Oe||function(le){switch(le){case"YY":return String(I.$y).slice(-2);case"YYYY":return m.s(I.$y,4,"0");case"M":return P+1;case"MM":return m.s(P+1,2,"0");case"MMM":return $(T.monthsShort,P,te,3);case"MMMM":return $(te,P);case"D":return I.$D;case"DD":return m.s(I.$D,2,"0");case"d":return String(I.$W);case"dd":return $(T.weekdaysMin,I.$W,j,2);case"ddd":return $(T.weekdaysShort,I.$W,j,3);case"dddd":return j[I.$W];case"H":return String(Y);case"HH":return m.s(Y,2,"0");case"h":return ye(1);case"hh":return ye(2);case"a":return Ae(Y,C,!0);case"A":return Ae(Y,C,!1);case"m":return String(C);case"mm":return m.s(C,2,"0");case"s":return String(I.$s);case"ss":return m.s(I.$s,2,"0");case"SSS":return m.s(I.$ms,3,"0");case"Z":return B}return null}(ve)||B.replace(":","")})},x.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},x.diff=function(w,I,T){var D,B=this,Y=m.p(I),C=b(w),P=(C.utcOffset()-this.utcOffset())*e,j=this-C,te=function(){return m.m(B,C)};switch(Y){case h:D=te()/12;break;case c:D=te();break;case f:D=te()/3;break;case l:D=(j-P)/6048e5;break;case a:D=(j-P)/864e5;break;case s:D=j/t;break;case o:D=j/e;break;case i:D=j/n;break;default:D=j}return T?D:m.a(D)},x.daysInMonth=function(){return this.endOf(c).$D},x.$locale=function(){return U[this.$L]},x.locale=function(w,I){if(!w)return this.$L;var T=this.clone(),D=g(w,I,!0);return D&&(T.$L=D),T},x.clone=function(){return m.w(this.$d,this)},x.toDate=function(){return new Date(this.valueOf())},x.toJSON=function(){return this.isValid()?this.toISOString():null},x.toISOString=function(){return this.$d.toISOString()},x.toString=function(){return this.$d.toUTCString()},F}(),ce=ie.prototype;return b.prototype=ce,[["$ms",r],["$s",i],["$m",o],["$H",s],["$W",a],["$M",c],["$y",h],["$D",d]].forEach(function(F){ce[F[1]]=function(x){return this.$g(x,F[0],F[1])}}),b.extend=function(F,x){return F.$i||(F(x,ie,b),F.$i=!0),b},b.locale=g,b.isDayjs=me,b.unix=function(F){return b(1e3*F)},b.en=U[re],b.Ls=U,b.p={},b})});var Br=Gt(Xe=>{"use strict";Object.defineProperty(Xe,"__esModule",{value:!0});Xe.P_HELPERS=Xe.ParserHelpers=Xe.validateRegexFlags=Xe.validateRange=Xe.getIndex=Xe.arrayUnion=void 0;var Ms=tr();function Ru(n,e){if(!(n===void 0&&e===void 0)){if(n===void 0)return e;if(e===void 0)return n;for(let t of e)n.includes(t)||n.push(t);return n}}Xe.arrayUnion=Ru;function Du(n){return n===void 0?-1:n.index}Xe.getIndex=Du;function Nu(n,e){if(e<n)throw new Error(`Invalid Range: max might not be smaller than min. Received [${n}, ${e}].`);if(n<0||e<0)throw new Error(`Invalid Range: max and min might not be smaller than 0. Received [${n}, ${e}].`);if(n===1/0||e===1/0)throw new Error(`Invalid Range: max and min might not be infinity. Received [${n}, ${e}].`);if(!Number.isInteger(n)||!Number.isInteger(e))throw new Error(`Invalid Range: max and min must be integers. Received [${n}, ${e}].`)}Xe.validateRange=Nu;function qu(n){for(let e of n)if(e!=="i"&&e!=="m"&&e!=="s"&&e!=="u")throw new Error(`RegExp flag '${e}' is not allowed. The only allowed flags are 'i', 'm', 's' and 'u'.`)}Xe.validateRegexFlags=qu;var Wr=class{followedBy(e){return new Ms.Parser(function(r){return e.p(r.copy())})}notFollowedBy(e){return new Ms.Parser(function(r){let i=r.copy(),o=e.p(i),s=r.sliceTo(i.position.index);return o.success?r.fail("not '"+s+"'"):r.succeed(void 0)})}test(e){return new Ms.Parser(function(r){let i=r.input[r.position.index];return!r.atEOF()&&e(i)?r.succeedOffset(1,i):r.fail(`a character matching ${e}`)})}};Xe.ParserHelpers=Wr;Xe.P_HELPERS=new Wr});var Is=Gt(Jr=>{"use strict";Object.defineProperty(Jr,"__esModule",{value:!0});Jr.ParserContext=void 0;var As=Br(),Ss=class n{constructor(e,t){this.input=e,this.position=t}moveToPosition(e){return this.position=e,this}copy(){return new n(this.input,{index:this.position.index,column:this.position.column,line:this.position.line})}getPosition(){return{index:this.position.index,column:this.position.column,line:this.position.line}}atEOF(){return this.position.index>=this.input.length}advanceTo(e){if(e<this.position.index)throw new Error(`Can not advance backwards. Current pos ${this.position.index}. Advance target index ${e}.`);if(e!==this.position.index){for(let t=this.position.index;t<e;t++)this.input[t]===`
`?(this.position.line+=1,this.position.column=1):this.position.column+=1;this.position.index=e}}sliceTo(e){return this.input.slice(this.position.index,e)}succeedOffset(e,t){return this.succeedAt(this.position.index+e,t)}failOffset(e,t){return this.failAt(this.position.index+e,t)}succeed(e){return this.succeedAt(this.position.index,e)}fail(e){return this.failAt(this.position.index,e)}succeedAt(e,t){return this.advanceTo(e),{success:!0,value:t,furthest:void 0,expected:void 0}}failAt(e,t){return this.advanceTo(e),{success:!1,value:void 0,furthest:this.position,expected:Array.isArray(t)?t:[t]}}merge(e,t){if(e===void 0)return t;let r=(0,As.getIndex)(e.furthest),i=(0,As.getIndex)(t.furthest);if(i>r)return t;let o=i===r?(0,As.arrayUnion)(e.expected,t.expected):e.expected;return t.furthest=e.furthest,t.expected=o,t}};Jr.ParserContext=Ss});var Ts=Gt(Gr=>{"use strict";Object.defineProperty(Gr,"__esModule",{value:!0});Gr.P_UTILS=void 0;var Ur=tr(),he=Hr(),Ps=class n{static position(){return new Ur.Parser(e=>e.succeed(e.getPosition()))}static any(){return new Ur.Parser(e=>e.atEOF()?e.fail("any character"):e.succeedOffset(1,e.input[e.position.index]))}static remaining(){return new Ur.Parser(e=>e.succeedAt(e.input.length,e.input.slice(e.position.index)))}static eof(){return new Ur.Parser(e=>e.atEOF()?e.succeed(void 0):e.fail("eof"))}static digit(){return he.P.regexp(/^[0-9]/).describe("a digit")}static digits(){return he.P.regexp(/^[0-9]+/).describe("multiple digits")}static letter(){return he.P.regexp(/^[a-z]/i).describe("a letter")}static letters(){return he.P.regexp(/^[a-z]+/i).describe("multiple letters")}static unicodeLetter(){return he.P.regexp(/^\p{L}/iu).describe("a unicode letter")}static unicodeLetters(){return he.P.regexp(/^\p{L}+/iu).describe("multiple unicode letters")}static unicodeAlphanumeric(){return he.P.regexp(/^[\p{L}\p{N}]/iu).describe("a unicode alphanumeric character")}static unicodeAlphanumerics(){return he.P.regexp(/^[\p{L}\p{N}]+/iu).describe("multiple unicode alphanumeric characters")}static optionalWhitespace(){return he.P.regexp(/^\s*/).describe("optional whitespace")}static whitespace(){return he.P.regexp(/^\s+/).describe("whitespace")}static cr(){return he.P.string("\r")}static lf(){return he.P.string(`
`)}static crlf(){return he.P.string(`\r
`)}static newline(){return he.P.or(this.crlf(),this.lf(),this.cr()).describe("newline")}static prefix(e,t,r){return he.P.sequenceMap((i,o)=>i.reduce((s,a)=>r(a,s),o),e.many(),t)}static postfix(e,t,r){return he.P.sequenceMap((i,o)=>o.reduce((s,a)=>r(a,s),i),t,e.many())}static binaryRight(e,t,r){return he.P.sequenceMap((i,o)=>i.reverse().reduce((s,a)=>{let[l,c]=a;return r(l,c,s)},o),he.P.sequence(t,e.trim(this.optionalWhitespace())).many(),t)}static binaryLeft(e,t,r){return he.P.sequenceMap((i,o)=>o.reduce((s,a)=>{let[l,c]=a;return r(s,l,c)},i),t,he.P.sequence(e.trim(this.optionalWhitespace()),t).many())}static binaryRightRange(e,t,r){return he.P.sequenceMap((i,o,s)=>i.reverse().reduce((a,l)=>{let[c,f,h]=l;return r({from:c,to:s},f,h,a)},o),he.P.sequence(n.position(),t,e.trim(this.optionalWhitespace())).many(),t,n.position())}static binaryLeftRange(e,t,r){return he.P.sequenceMap((i,o,s)=>s.reduce((a,l)=>{let[c,f,h]=l;return r({from:i,to:h},a,c,f)},o),n.position(),t,he.P.sequence(e.trim(this.optionalWhitespace()),t,n.position()).many())}static func(e,t,r){let i=typeof e=="string"?he.P.string(e):e;return he.P.sequenceMap((o,s,a,l,c,f)=>r(o,l),i,he.P.string("("),this.optionalWhitespace(),t,this.optionalWhitespace(),he.P.string(")"))}};Gr.P_UTILS=Ps});var Fs=Gt(gn=>{"use strict";Object.defineProperty(gn,"__esModule",{value:!0});gn.ParsingError=gn.createParsingErrorMessage=void 0;function ja(n,e,t){let r=`Expected ${e.expected.sort().join(" or ")}`,i=`Parse Failure: ${r} at index ${e.furthest.index}, line ${e.furthest.line}, column ${e.furthest.column}.`;if(t){let s=n.split(`
`)[e.furthest.line-1],a=`${e.furthest.line} |   `;i+=`

${a}${s}`,i+=`
${" ".repeat(e.furthest.column-1+a.length)}^ (${r})`}return i}gn.createParsingErrorMessage=ja;var Cs=class extends Error{constructor(e,t){super(ja(e,t,!0))}};gn.ParsingError=Cs});var tr=Gt(Vr=>{"use strict";Object.defineProperty(Vr,"__esModule",{value:!0});Vr.Parser=void 0;var ju=Is(),lt=Hr(),Os=Br(),_n=Ts(),zu=Fs(),Ls=class n{constructor(e){this.p=e}tryParse(e){return this.p(new ju.ParserContext(e,{index:0,line:1,column:1}))}parse(e){let t=this.tryParse(e);if(t.success)return t.value;throw new zu.ParsingError(e,t)}or(e){return lt.P.or(this,e)}trim(e){return this.wrap(e,e)}trimString(e){return this.trim(lt.P.string(e))}wrap(e,t){let r=this;return new n(function(o){let s=e.p(o);if(!s.success)return s;let a=o.merge(s,r.p(o));if(!a.success)return a;let l=o.merge(a,t.p(o));return l.success?o.merge(l,o.succeed(a.value)):l})}wrapString(e,t){return this.wrap(lt.P.string(e),lt.P.string(t))}then(e){let t=this;return new n(function(i){let o=t.p(i);if(!o.success)return o;let s=i.merge(o,e.p(i));return s.success,s})}skip(e){let t=this;return new n(function(i){let o=t.p(i);if(!o.success)return o;let s=i.merge(o,e.p(i));return s.success?i.merge(s,i.succeed(o.value)):s})}and(e){return lt.P.sequence(this,e)}many(){let e=this;return new n(function(r){let i,o=r.position.index,s=[];for(;;){let a=r.copy(),l=e.p(a);if(i=r.merge(i,l),i.success){if(a.position.index===o)throw new Error("infinite loop in many() parser detected");r.moveToPosition(a.position),s.push(i.value)}else return r.merge(i,r.succeed(s))}})}repeat(e,t){(0,Os.validateRange)(e,t);let r=this;return new n(function(o){let s,a,l=[],c=0;for(;c<e;c++)if(s=r.p(o),a=o.merge(a,s),s.success)l.push(s.value);else return a;for(;c<t;c++){let f=o.copy();if(s=r.p(f),a=o.merge(a,s),s.success)o.moveToPosition(f.position),l.push(s.value);else break}return o.merge(a,o.succeed(l))})}atMost(e){return this.repeat(0,e)}atLeast(e){return lt.P.sequenceMap((t,r)=>t.concat(r),this.repeat(e,e),this.many())}separateBy(e){return lt.P.separateBy(this,e)}separateByNotEmpty(e){return lt.P.separateByNotEmpty(this,e)}result(e){return this.map(()=>e)}map(e){let t=this;return new n(function(i){let o=t.p(i);return o.success&&(o.value=e(o.value)),o})}marker(){return lt.P.sequenceMap(function(t,r,i){return{value:r,range:{from:t,to:i}}},_n.P_UTILS.position(),this,_n.P_UTILS.position())}namedMarker(e){return lt.P.sequenceMap(function(r,i,o){return{value:i,name:e,range:{from:r,to:o}}},_n.P_UTILS.position(),this,_n.P_UTILS.position())}node(e){return lt.P.sequenceMap(function(r,i,o){return e(i,{from:r,to:o})},_n.P_UTILS.position(),this,_n.P_UTILS.position())}followedBy(e){return this.skip(Os.P_HELPERS.followedBy(e))}notFollowedBy(e){return this.skip(Os.P_HELPERS.notFollowedBy(e))}describe(e){typeof e=="string"&&(e=[e]);let t=this;return new n(function(i){let o=t.p(i);return o.expected!==void 0&&o.expected.length!==0&&(o.expected=e),o})}box(e){let t=this;return new n(function(i){var o;let s=t.p(i);return s.expected!==void 0&&s.expected.length!==0&&(s.expected=[`(${(o=s.expected)===null||o===void 0?void 0:o.join(" or ")} as part of ${e})`]),s})}optional(e){return this.or(lt.P.succeed(e))}chain(e){let t=this;return new n(function(i){let o=t.p(i);if(!o.success)return o;let a=e(o.value).p(i);return i.merge(o,a)})}thenEof(){let e=this;return new n(function(r){let i=e.p(r);return i.success?r.atEOF()?i:r.merge(i,r.fail("eof")):i})}memorize(){let e=this,t="",r=new Map,i=new Map;return new n(function(s){let a=s.position.index;if(s.input!==t)t=s.input,r.clear(),i.clear();else{let c=r.get(a),f=i.get(a);if(c!==void 0&&f!==void 0)return s.moveToPosition(Object.assign({},f)),Object.assign({},c)}let l=e.p(s);return r.set(a,Object.assign({},l)),i.set(a,s.getPosition()),l})}};Vr.Parser=Ls});var Hr=Gt(Qr=>{"use strict";Object.defineProperty(Qr,"__esModule",{value:!0});Qr.P=void 0;var et=tr(),Yr=Br(),Rs=class n{static sequence(...e){if(e.length===0)throw new Error("sequence must have at least one parser argument");return new et.Parser(function(r){let i,o=new Array(e.length);for(let s=0;s<e.length;s++){let l=e[s].p(r);if(i=r.merge(i,l),!i.success)return i;o[s]=i.value}return i.value=o,i})}static sequenceMap(e,...t){if(t.length===0)throw new Error("sequenceMap must have at least one parser argument");return new et.Parser(function(i){let o,s=new Array(t.length);for(let a=0;a<t.length;a++){let c=t[a].p(i);if(o=i.merge(o,c),!o.success)return o;s[a]=o.value}return o.value=e(...s),o})}static createLanguage(e){let t={},r={},i={};for(let o in e)i[o]=n.reference(()=>e[o](t,i)),Object.defineProperty(r,o,{get:()=>{if(t[o]!==void 0)return t[o];throw new Error(`Can not access rule '${o}' in language. Rule is not yet defined. Try to access it via 'ref'.`)}});for(let o in e)t[o]=e[o](r,i);return t}static or(...e){if(e.length===0)throw new Error("or must have at least one alternative");return new et.Parser(function(r){let i;for(let o of e){let s=o,a=r.copy(),l=s.p(a);if(i=r.merge(i,l),i.success)return r.moveToPosition(a.position),i}return i})}static separateBy(e,t){return this.separateByNotEmpty(e,t).or(n.succeed([]))}static separateByNotEmpty(e,t){return this.sequenceMap(function(i,o){return o.unshift(i),o},e,t.then(e).many())}static string(e){let t="'"+e+"'";return new et.Parser(function(i){for(let o=0;o<e.length;o++)if(i.input[i.position.index+o]!==e[o])return i.fail(t);return i.succeedAt(i.position.index+e.length,e)})}static regexp(e,t){(0,Yr.validateRegexFlags)(e.flags);let r=e.source;return t!==void 0?new et.Parser(function(o){let s=o.input.slice(o.position.index),a=e.exec(s);if(a!==null){let l=t!=null?t:0;if(l>=0&&l<=a.length){let f=a[0],h=a[l];return o.succeedOffset(f.length,h)}let c="expected valid match group (0 to "+a.length+") in "+r;return o.fail(c)}else return o.fail(r)}):new et.Parser(function(o){let s=o.input.slice(o.position.index),a=e.exec(s);if(a!==null){let l=a[0];return o.succeedOffset(l.length,l)}else return o.fail(r)})}static succeed(e){return new et.Parser(function(r){return r.succeed(e)})}static fail(e){return new et.Parser(function(r){return r.fail(e)})}static oneOf(e){return Yr.P_HELPERS.test(function(r){return e.includes(r)}).describe(`one character of '${e}'`)}static noneOf(e){return Yr.P_HELPERS.test(function(r){return!e.includes(r)}).describe(`no character of '${e}'`)}static oneStringOf(e){return this.or(...e.map(t=>this.string(t))).describe(e.map(t=>`'${t}'`).join(" or "))}static manyOf(e){return new et.Parser(function(r){let i=r.position.index;for(;i<r.input.length&&e.includes(r.input[i]);i++);return r.succeedAt(i,r.sliceTo(i))})}static manyNotOf(e){return new et.Parser(function(r){let i=r.position.index;for(;i<r.input.length&&!e.includes(r.input[i]);i++);return r.succeedAt(i,r.sliceTo(i))})}static custom(e){return new et.Parser(e)}static range(e,t){let r=e.charCodeAt(0),i=t.charCodeAt(0);return Yr.P_HELPERS.test(function(s){let a=s.charCodeAt(0);return r<=a&&a<=i}).describe(`${e}-${t}`)}static takeWhile(e){return new et.Parser(function(r){let i=r.position.index;for(;i<r.input.length&&e(r.input[i]);)i++;return r.succeedAt(i,r.input.slice(r.position.index,i))})}static reference(e){return new et.Parser(function(r){return e().p(r)})}};Qr.P=Rs});var tc={};Ks(tc,{default:()=>Qo});module.exports=Ol(tc);var ul=require("obsidian");var Ll=require("obsidian"),ea={};var Nt=require("obsidian");var ta=require("obsidian"),Mt=class{constructor(e){this.content=e}async render(e,t,r,i){await ta.MarkdownRenderer.render(e,this.content,t,r,i)}};var rn=class{toMarkdown(){return new Mt(this.toString())}};var on=class extends rn{getType(){return"LITERAL"}};var yt=class extends rn{constructor(){super();this.markdownElements=[]}getType(){return"NON_LITERAL"}addElement(t){if(this.allowElement(t))this.markdownElements.push(t);else throw new Error("Element not allowed in container.")}addText(t){let r=new ft(t,!1,!1,!1);return this.addElement(r),this}addBoldText(t){let r=new ft(t,!0,!1,!1);return this.addElement(r),this}addCursiveText(t){let r=new ft(t,!1,!0,!1);return this.addElement(r),this}addUnderlinedText(t){let r=new ft(t,!1,!1,!0);return this.addElement(r),this}addCode(t){let r=new Un(t);return this.addElement(r),this}createParagraph(t){let r=new Vn(t);return this.addElement(r),r}createHeading(t,r){let i=new Hn(t,r);return this.addElement(i),i}createBlockQuote(){let t=new Qn;return this.addElement(t),t}createCallout(t,r,i=""){let o=new Xn(t,r,i);return this.addElement(o),o}createCodeBlock(t,r){let i=new Yn(t,r);return this.addElement(i),i}createTable(t,r){let i=new Gn(t,r);return this.addElement(i),i}createList(t){let r=new Zn(t);return this.addElement(r),r}},ft=class extends on{constructor(t,r,i,o){super();this.content=t,this.bold=r,this.cursive=i,this.underline=o}toString(){let t="",r="";return this.underline&&(t+="<b>",r="</b>"+r),this.bold&&(t+="**",r="**"+r),this.cursive&&(t+="*",r="*"+r),t+this.content+r}},Un=class extends on{constructor(t){super();this.content=t}toString(){return`\`${this.content}\``}},Gn=class extends on{constructor(t,r){super();this.header=t,this.body=r}toString(){let t=this.body.length;if(t===0)return"";let r=this.header.length;if(r===0)return"";for(let s of this.body)if(s.length!==r)throw new Error("Table rows are do not contain the same number of columns.");let i=[];for(let s=0;s<r;s++){let a=0;this.header[s].length>a&&(a=this.header[s].length);for(let l of this.body)l[s].length>a&&(a=l[s].length);i.push(a)}let o="";o+="|";for(let s=0;s<r;s++){let a=this.header[s];a+=" ".repeat(i[s]-a.length),o+=" "+a+" |"}o+=`
`,o+="|";for(let s=0;s<r;s++)o+=" "+"-".repeat(i[s])+" |";o+=`
`;for(let s=0;s<t;s++){o+="|";for(let a=0;a<r;a++){let l=this.body[s][a];l+=" ".repeat(i[a]-l.length),o+=" "+l+" |"}o+=`
`}return o}},Hn=class extends yt{constructor(t,r){super();this.level=t,this.addText(r)}toString(){return`${"#".repeat(this.level)} ${this.markdownElements.map(t=>t.toString()).join("")}`}allowElement(t){return t.getType()==="LITERAL"}},Vn=class extends yt{constructor(e){super(),this.addText(e)}toString(){return this.markdownElements.map(e=>e.toString()).join("")}allowElement(e){return e.getType()==="LITERAL"}},Yn=class extends yt{constructor(t,r){super();this.language=t,this.addText(r)}allowElement(t){return t.getType()==="LITERAL"}toString(){return`\`\`\`${this.language}
${this.markdownElements.map(t=>t.toString()).join("")}
\`\`\``}},Qn=class extends yt{allowElement(e){return!0}toString(){return"> "+this.markdownElements.map(e=>e.toString().replaceAll(`
`,`
> `)).join(`
> 
> `)}},Xn=class extends yt{constructor(t,r,i){super();this.title=t,this.type=r,this.args=i}allowElement(t){return!0}toString(){return`> [!${this.type}|${this.args}] ${this.title}
> `+this.markdownElements.map(t=>t.toString().replaceAll(`
`,`
> `)).join(`
> 
> `)}},Zn=class n extends yt{constructor(t){super();this.ordered=t}allowElement(t){return!0}getPrefix(t){return this.ordered?`${t+1}. `:"- "}toString(){return this.markdownElements.map((t,r)=>t instanceof n?`	${t.toString().replaceAll(`
`,`
	`)}`:`${this.getPrefix(r)}${t.toString().replaceAll(`
`,`
	`)}`).join(`
`)}};var Vt=class extends yt{constructor(){super()}toString(){return this.markdownElements.map(e=>e.toString()).join(`

`)}allowElement(e){return!0}};var Nr=require("obsidian");var Da=require("obsidian");function ae(){}var Kn=n=>n;function xr(n,e){for(let t in e)n[t]=e[t];return n}function ns(n){return n()}function kr(){return Object.create(null)}function we(n){n.forEach(ns)}function je(n){return typeof n=="function"}function Q(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function na(n){return Object.keys(n).length===0}function Dl(n,...e){if(n==null){for(let r of e)r(void 0);return ae}let t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function ra(n,e,t){n.$$.on_destroy.push(Dl(e,t))}function ze(n,e,t,r){if(n){let i=ia(n,e,t,r);return n[0](i)}}function ia(n,e,t,r){return n[1]&&r?xr(t.ctx.slice(),n[1](r(e))):t.ctx}function We(n,e,t,r){if(n[2]&&r){let i=n[2](r(t));if(e.dirty===void 0)return i;if(typeof i=="object"){let o=[],s=Math.max(e.dirty.length,i.length);for(let a=0;a<s;a+=1)o[a]=e.dirty[a]|i[a];return o}return e.dirty|i}return e.dirty}function Be(n,e,t,r,i,o){if(i){let s=ia(e,t,r,o);n.p(s,i)}}function Je(n){if(n.ctx.length>32){let e=[],t=n.ctx.length/32;for(let r=0;r<t;r++)e[r]=-1;return e}return-1}function gt(n){return n&&je(n.destroy)?n.destroy:ae}var oa=typeof window!="undefined",rs=oa?()=>window.performance.now():()=>Date.now(),$n=oa?n=>requestAnimationFrame(n):ae;var sn=new Set;function sa(n){sn.forEach(e=>{e.c(n)||(sn.delete(e),e.f())}),sn.size!==0&&$n(sa)}function is(n){let e;return sn.size===0&&$n(sa),{promise:new Promise(t=>{sn.add(e={c:n,f:t})}),abort(){sn.delete(e)}}}var os=typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global;var Er=class n{constructor(e){Re(this,"_listeners","WeakMap"in os?new WeakMap:void 0);Re(this,"_observer");Re(this,"options");this.options=e}observe(e,t){return this._listeners.set(e,t),this._getObserver().observe(e,this.options),()=>{this._listeners.delete(e),this._observer.unobserve(e)}}_getObserver(){var e;return(e=this._observer)!=null?e:this._observer=new ResizeObserver(t=>{var r;for(let i of t)n.entries.set(i.target,i),(r=this._listeners.get(i.target))==null||r(i)})}};Er.entries="WeakMap"in os?new WeakMap:void 0;var aa=!1;function la(){aa=!0}function ua(){aa=!1}function E(n,e){n.appendChild(e)}function Ue(n,e,t){let r=Mr(n);if(!r.getElementById(e)){let i=A("style");i.id=e,i.textContent=t,fa(r,i)}}function Mr(n){if(!n)return document;let e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function ca(n){let e=A("style");return e.textContent="/* empty */",fa(Mr(n),e),e.sheet}function fa(n,e){return E(n.head||n,e),e.sheet}function N(n,e,t){n.insertBefore(e,t||null)}function L(n){n.parentNode&&n.parentNode.removeChild(n)}function an(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function A(n){return document.createElement(n)}function ne(n){return document.createTextNode(n)}function ee(){return ne(" ")}function Ie(n,e,t,r){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}function q(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function da(n){return Array.from(n.childNodes)}function Ee(n,e){e=""+e,n.data!==e&&(n.data=e)}function Pe(n,e,t){n.classList.toggle(e,!!t)}function Ar(n,e,{bubbles:t=!1,cancelable:r=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:r})}function ha(n){let e={};return n.childNodes.forEach(t=>{e[t.slot||"default"]=!0}),e}var Sr=new Map,Ir=0;function ql(n){let e=5381,t=n.length;for(;t--;)e=(e<<5)-e^n.charCodeAt(t);return e>>>0}function jl(n,e){let t={stylesheet:ca(e),rules:{}};return Sr.set(n,t),t}function Pr(n,e,t,r,i,o,s,a=0){let l=16.666/r,c=`{
`;for(let W=0;W<=1;W+=l){let J=e+(t-e)*o(W);c+=W*100+`%{${s(J,1-J)}}
`}let f=c+`100% {${s(t,1-t)}}
}`,h=`__svelte_${ql(f)}_${a}`,d=Mr(n),{stylesheet:_,rules:y}=Sr.get(d)||jl(d,n);y[h]||(y[h]=!0,_.insertRule(`@keyframes ${h} ${f}`,_.cssRules.length));let k=n.style.animation||"";return n.style.animation=`${k?`${k}, `:""}${h} ${r}ms linear ${i}ms 1 both`,Ir+=1,h}function ss(n,e){let t=(n.style.animation||"").split(", "),r=t.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),i=t.length-r.length;i&&(n.style.animation=r.join(", "),Ir-=i,Ir||zl())}function zl(){$n(()=>{Ir||(Sr.forEach(n=>{let{ownerNode:e}=n.stylesheet;e&&L(e)}),Sr.clear())})}var ln;function At(n){ln=n}function ot(n,e){let t=n.$$.callbacks[e.type];t&&t.slice().forEach(r=>r.call(this,e))}var Yt=[];var Ye=[],cn=[],ls=[],Wl=Promise.resolve(),us=!1;function pa(){us||(us=!0,Wl.then(Tr))}function St(n){cn.push(n)}function fn(n){ls.push(n)}var as=new Set,un=0;function Tr(){if(un!==0)return;let n=ln;do{try{for(;un<Yt.length;){let e=Yt[un];un++,At(e),Bl(e.$$)}}catch(e){throw Yt.length=0,un=0,e}for(At(null),Yt.length=0,un=0;Ye.length;)Ye.pop()();for(let e=0;e<cn.length;e+=1){let t=cn[e];as.has(t)||(as.add(t),t())}cn.length=0}while(Yt.length);for(;ls.length;)ls.pop()();us=!1,as.clear(),At(n)}function Bl(n){if(n.fragment!==null){n.update(),we(n.before_update);let e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(St)}}function ma(n){let e=[],t=[];cn.forEach(r=>n.indexOf(r)===-1?e.push(r):t.push(r)),t.forEach(r=>r()),cn=e}var er;function Jl(){return er||(er=Promise.resolve(),er.then(()=>{er=null})),er}function cs(n,e,t){n.dispatchEvent(Ar(`${e?"intro":"outro"}${t}`))}var Cr=new Set,It;function dt(){It={r:0,c:[],p:It}}function ht(){It.r||we(It.c),It=It.p}function V(n,e){n&&n.i&&(Cr.delete(n),n.i(e))}function K(n,e,t,r){if(n&&n.o){if(Cr.has(n))return;Cr.add(n),It.c.push(()=>{Cr.delete(n),r&&(t&&n.d(1),r())}),n.o(e)}else r&&r()}var Ul={duration:0};function Fr(n,e,t,r){let o=e(n,t,{direction:"both"}),s=r?0:1,a=null,l=null,c=null,f;function h(){c&&ss(n,c)}function d(y,k){let W=y.b-s;return k*=Math.abs(W),{a:s,b:y.b,d:W,duration:k,start:y.start,end:y.start+k,group:y.group}}function _(y){let{delay:k=0,duration:W=300,easing:J=Kn,tick:Z=ae,css:re}=o||Ul,U={start:rs()+k,b:y};y||(U.group=It,It.r+=1),"inert"in n&&(y?f!==void 0&&(n.inert=f):(f=n.inert,n.inert=!0)),a||l?l=U:(re&&(h(),c=Pr(n,s,y,W,k,J,re)),y&&Z(0,1),a=d(U,W),St(()=>cs(n,y,"start")),is(se=>{if(l&&se>l.start&&(a=d(l,W),l=null,cs(n,a.b,"start"),re&&(h(),c=Pr(n,s,a.b,a.duration,0,J,o.css))),a){if(se>=a.end)Z(s=a.b,1-s),cs(n,a.b,"end"),l||(a.b?h():--a.group.r||we(a.group.c)),a=null;else if(se>=a.start){let me=se-a.start;s=a.a+a.d*J(me/a.duration),Z(s,1-s)}}return!!(a||l)}))}return{run(y){je(o)?Jl().then(()=>{o=o({direction:y?"in":"out"}),_(y)}):_(y)},end(){h(),a=l=null}}}function st(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function ya(n,e){n.d(1),e.delete(n.key)}function ga(n,e,t,r,i,o,s,a,l,c,f,h){let d=n.length,_=o.length,y=d,k={};for(;y--;)k[n[y].key]=y;let W=[],J=new Map,Z=new Map,re=[];for(y=_;y--;){let g=h(i,o,y),b=t(g),m=s.get(b);m?r&&re.push(()=>m.p(g,e)):(m=c(b,g),m.c()),J.set(b,W[y]=m),b in k&&Z.set(b,Math.abs(y-k[b]))}let U=new Set,se=new Set;function me(g){V(g,1),g.m(a,f),s.set(g.key,g),f=g.first,_--}for(;d&&_;){let g=W[_-1],b=n[d-1],m=g.key,ie=b.key;g===b?(f=g.first,d--,_--):J.has(ie)?!s.has(m)||U.has(m)?me(g):se.has(ie)?d--:Z.get(m)>Z.get(ie)?(se.add(m),me(g)):(U.add(ie),d--):(l(b,s),d--)}for(;d--;){let g=n[d];J.has(g.key)||l(g,s)}for(;_;)me(W[_-1]);return we(re),W}var Gl=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"],Hl=new Set([...Gl]);function dn(n,e,t){let r=n.$$.props[e];r!==void 0&&(n.$$.bound[r]=t,t(n.$$.ctx[r]))}function Qe(n){n&&n.c()}function Ge(n,e,t){let{fragment:r,after_update:i}=n.$$;r&&r.m(e,t),St(()=>{let o=n.$$.on_mount.map(ns).filter(je);n.$$.on_destroy?n.$$.on_destroy.push(...o):we(o),n.$$.on_mount=[]}),i.forEach(St)}function He(n,e){let t=n.$$;t.fragment!==null&&(ma(t.after_update),we(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Yl(n,e){n.$$.dirty[0]===-1&&(Yt.push(n),pa(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function X(n,e,t,r,i,o,s=null,a=[-1]){let l=ln;At(n);let c=n.$$={fragment:null,ctx:[],props:o,update:ae,not_equal:i,bound:kr(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:kr(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};s&&s(c.root);let f=!1;if(c.ctx=t?t(n,e.props||{},(h,d,..._)=>{let y=_.length?_[0]:d;return c.ctx&&i(c.ctx[h],c.ctx[h]=y)&&(!c.skip_bound&&c.bound[h]&&c.bound[h](y),f&&Yl(n,h)),d}):[],c.update(),f=!0,we(c.before_update),c.fragment=r?r(c.ctx):!1,e.target){if(e.hydrate){la();let h=da(e.target);c.fragment&&c.fragment.l(h),h.forEach(L)}else c.fragment&&c.fragment.c();e.intro&&V(n.$$.fragment),Ge(n,e.target,e.anchor),ua(),Tr()}At(l)}var Ql;typeof HTMLElement=="function"&&(Ql=class extends HTMLElement{constructor(e,t,r){super();Re(this,"$$ctor");Re(this,"$$s");Re(this,"$$c");Re(this,"$$cn",!1);Re(this,"$$d",{});Re(this,"$$r",!1);Re(this,"$$p_d",{});Re(this,"$$l",{});Re(this,"$$l_u",new Map);this.$$ctor=e,this.$$s=t,r&&this.attachShadow({mode:"open"})}addEventListener(e,t,r){if(this.$$l[e]=this.$$l[e]||[],this.$$l[e].push(t),this.$$c){let i=this.$$c.$on(e,t);this.$$l_u.set(t,i)}super.addEventListener(e,t,r)}removeEventListener(e,t,r){if(super.removeEventListener(e,t,r),this.$$c){let i=this.$$l_u.get(t);i&&(i(),this.$$l_u.delete(t))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){let e=function(o){return()=>{let s;return{c:function(){s=A("slot"),o!=="default"&&q(s,"name",o)},m:function(c,f){N(c,s,f)},d:function(c){c&&L(s)}}}};if(await Promise.resolve(),!this.$$cn)return;let t={},r=ha(this);for(let o of this.$$s)o in r&&(t[o]=[e(o)]);for(let o of this.attributes){let s=this.$$g_p(o.name);s in this.$$d||(this.$$d[s]=fs(s,o.value,this.$$p_d,"toProp"))}for(let o in this.$$p_d)!(o in this.$$d)&&this[o]!==void 0&&(this.$$d[o]=this[o],delete this[o]);this.$$c=new this.$$ctor({target:this.shadowRoot||this,props:{...this.$$d,$$slots:t,$$scope:{ctx:[]}}});let i=()=>{this.$$r=!0;for(let o in this.$$p_d)if(this.$$d[o]=this.$$c.$$.ctx[this.$$c.$$.props[o]],this.$$p_d[o].reflect){let s=fs(o,this.$$d[o],this.$$p_d,"toAttribute");s==null?this.removeAttribute(this.$$p_d[o].attribute||o):this.setAttribute(this.$$p_d[o].attribute||o,s)}this.$$r=!1};this.$$c.$$.after_update.push(i),i();for(let o in this.$$l)for(let s of this.$$l[o]){let a=this.$$c.$on(o,s);this.$$l_u.set(s,a)}this.$$l={}}}attributeChangedCallback(e,t,r){var i;this.$$r||(e=this.$$g_p(e),this.$$d[e]=fs(e,r,this.$$p_d,"toProp"),(i=this.$$c)==null||i.$set({[e]:this.$$d[e]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then(()=>{this.$$cn||(this.$$c.$destroy(),this.$$c=void 0)})}$$g_p(e){return Object.keys(this.$$p_d).find(t=>this.$$p_d[t].attribute===e||!this.$$p_d[t].attribute&&t.toLowerCase()===e)||e}});function fs(n,e,t,r){var o;let i=(o=t[n])==null?void 0:o.type;if(e=i==="Boolean"&&typeof e!="boolean"?e!=null:e,!r||!t[n])return e;if(r==="toAttribute")switch(i){case"Object":case"Array":return e==null?null:JSON.stringify(e);case"Boolean":return e?"":null;case"Number":return e==null?null:e;default:return e}else switch(i){case"Object":case"Array":return e&&JSON.parse(e);case"Boolean":return e;case"Number":return e!=null?+e:e;default:return e}}var H=class{constructor(){Re(this,"$$");Re(this,"$$set")}$destroy(){He(this,1),this.$destroy=ae}$on(e,t){if(!je(t))return ae;let r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(t),()=>{let i=r.indexOf(t);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!na(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}};var _a="4";typeof window!="undefined"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(_a);var ps=require("obsidian");function _t(n,e){return(0,ps.setIcon)(n,e),{update(t){(0,ps.setIcon)(n,t)}}}function su(n){Ue(n,"svelte-12xcpmj","button.svelte-12xcpmj{gap:var(--size-4-1)}.mod-plain.svelte-12xcpmj{background:none;box-shadow:none;border:none;color:var(--text-muted)}.mod-plain.svelte-12xcpmj:hover{color:var(--text-normal)}.disabled.svelte-12xcpmj{opacity:0.6}")}function au(n){let e,t,r,i,o=n[5].default,s=ze(o,n,n[4],null);return{c(){e=A("button"),s&&s.c(),q(e,"aria-label",n[3]),e.disabled=n[2],q(e,"class","svelte-12xcpmj"),Pe(e,"mod-cta",n[1]==="primary"),Pe(e,"mod-warning",n[1]==="destructive"),Pe(e,"mod-plain",n[1]==="plain"),Pe(e,"disabled",n[2])},m(a,l){N(a,e,l),s&&s.m(e,null),n[7](e),t=!0,r||(i=Ie(e,"click",n[6]),r=!0)},p(a,[l]){s&&s.p&&(!t||l&16)&&Be(s,o,a,a[4],t?We(o,a[4],l,null):Je(a[4]),null),(!t||l&8)&&q(e,"aria-label",a[3]),(!t||l&4)&&(e.disabled=a[2]),(!t||l&2)&&Pe(e,"mod-cta",a[1]==="primary"),(!t||l&2)&&Pe(e,"mod-warning",a[1]==="destructive"),(!t||l&2)&&Pe(e,"mod-plain",a[1]==="plain"),(!t||l&4)&&Pe(e,"disabled",a[2])},i(a){t||(V(s,a),t=!0)},o(a){K(s,a),t=!1},d(a){a&&L(e),s&&s.d(a),n[7](null),r=!1,i()}}}function lu(n,e,t){let{$$slots:r={},$$scope:i}=e,{variant:o="default"}=e,{disabled:s=!1}=e,{tooltip:a=""}=e,{ref:l=null}=e;function c(h){ot.call(this,n,h)}function f(h){Ye[h?"unshift":"push"](()=>{l=h,t(0,l)})}return n.$$set=h=>{"variant"in h&&t(1,o=h.variant),"disabled"in h&&t(2,s=h.disabled),"tooltip"in h&&t(3,a=h.tooltip),"ref"in h&&t(0,l=h.ref),"$$scope"in h&&t(4,i=h.$$scope)},[l,o,s,a,i,r,c,f]}var ms=class extends H{constructor(e){super(),X(this,e,lu,au,Q,{variant:1,disabled:2,tooltip:3,ref:0},su)}},Or=ms;var hu=Ht(Ea());function Ma(n){let e=n-1;return e*e*e+1}function vs(n,{delay:e=0,duration:t=400,easing:r=Ma,axis:i="y"}={}){let o=getComputedStyle(n),s=+o.opacity,a=i==="y"?"height":"width",l=parseFloat(o[a]),c=i==="y"?["top","bottom"]:["left","right"],f=c.map(J=>`${J[0].toUpperCase()}${J.slice(1)}`),h=parseFloat(o[`padding${f[0]}`]),d=parseFloat(o[`padding${f[1]}`]),_=parseFloat(o[`margin${f[0]}`]),y=parseFloat(o[`margin${f[1]}`]),k=parseFloat(o[`border${f[0]}Width`]),W=parseFloat(o[`border${f[1]}Width`]);return{delay:e,duration:t,easing:r,css:J=>`overflow: hidden;opacity: ${Math.min(J*20,1)*s};${a}: ${J*l}px;padding-${c[0]}: ${J*h}px;padding-${c[1]}: ${J*d}px;margin-${c[0]}: ${J*_}px;margin-${c[1]}: ${J*y}px;border-${c[0]}-width: ${J*k}px;border-${c[1]}-width: ${J*W}px;`}}function Sa(n){let e,t,r,i;return{c(){e=A("div"),q(e,"class","js-engine-message-delete-icon callout-icon"),q(e,"aria-label","remove"),q(e,"role","button"),q(e,"tabindex","0")},m(o,s){N(o,e,s),r||(i=[Ie(e,"click",n[5]),Ie(e,"keydown",n[6]),gt(t=_t.call(null,e,"x"))],r=!0)},p:ae,d(o){o&&L(e),r=!1,we(i)}}}function Ia(n){let e,t=n[0].message.content+"",r;return{c(){e=A("p"),r=ne(t)},m(i,o){N(i,e,o),E(e,r)},p(i,o){o&1&&t!==(t=i[0].message.content+"")&&Ee(r,t)},d(i){i&&L(e)}}}function Pa(n){let e,t,r=n[0].message.code+"",i;return{c(){e=A("pre"),t=A("code"),i=ne(r),q(e,"class","language-none")},m(o,s){N(o,e,s),E(e,t),E(t,i)},p(o,s){s&1&&r!==(r=o[0].message.code+"")&&Ee(i,r)},d(o){o&&L(e)}}}function Ta(n){let e,t,r,i=n[0].message.type+"",o,s,a,l,c=n[0].time.toISOString()+"",f,h,d,_,y=n[3]&&Ca(n);return{c(){e=A("div"),t=A("p"),r=ne("Type: "),o=ne(i),s=ee(),a=A("p"),l=ne("Time: "),f=ne(c),h=ee(),y&&y.c(),q(e,"class","js-engine-message-detail-content")},m(k,W){N(k,e,W),E(e,t),E(t,r),E(t,o),E(e,s),E(e,a),E(a,l),E(a,f),E(e,h),y&&y.m(e,null),_=!0},p(k,W){(!_||W&1)&&i!==(i=k[0].message.type+"")&&Ee(o,i),(!_||W&1)&&c!==(c=k[0].time.toISOString()+"")&&Ee(f,c),k[3]?y?y.p(k,W):(y=Ca(k),y.c(),y.m(e,null)):y&&(y.d(1),y=null)},i(k){_||(k&&St(()=>{_&&(d||(d=Fr(e,vs,{duration:100},!0)),d.run(1))}),_=!0)},o(k){k&&(d||(d=Fr(e,vs,{duration:100},!1)),d.run(0)),_=!1},d(k){k&&L(e),y&&y.d(),k&&d&&d.end()}}}function Ca(n){let e,t,r=n[0].source.name+"",i,o,s,a,l=n[0].source.id+"",c;return{c(){e=A("p"),t=ne("Source Name: "),i=ne(r),o=ee(),s=A("p"),a=ne("Source ID: "),c=ne(l)},m(f,h){N(f,e,h),E(e,t),E(e,i),N(f,o,h),N(f,s,h),E(s,a),E(s,c)},p(f,h){h&1&&r!==(r=f[0].source.name+"")&&Ee(i,r),h&1&&l!==(l=f[0].source.id+"")&&Ee(c,l)},d(f){f&&(L(e),L(o),L(s))}}}function Iu(n){let e,t,r,i,o,s,a=n[0].message.title+"",l,c,f,h,d,_,y,k,W,J,Z,re,U,se,me,g,b,m,ie=n[2]&&Sa(n),ce=n[0].message.content&&Ia(n),F=n[0].message.code&&Pa(n),x=n[4]&&Ta(n);return{c(){e=A("div"),t=A("div"),r=A("div"),o=ee(),s=A("span"),l=ne(a),c=ee(),ie&&ie.c(),f=ee(),h=A("div"),ce&&ce.c(),d=ee(),F&&F.c(),_=ee(),y=A("div"),k=A("div"),W=A("span"),W.textContent="Details",J=ee(),Z=A("div"),se=ee(),x&&x.c(),q(r,"class","js-engine-message-icon callout-icon"),q(s,"class","js-engine-message-title"),q(t,"class","js-engine-message-header callout-title"),q(Z,"class","js-engine-message-icon"),q(k,"class","js-engine-message-detail-row"),q(k,"aria-expanded",U=n[4]?"true":"false"),q(k,"role","button"),q(k,"tabindex","0"),q(y,"class","js-engine-message-detail"),q(h,"class","js-engine-message-content callout-content"),q(e,"class",me="js-engine-message callout "+ws(n[0].message.type)),q(e,"data-callout",g=n[0].message.type)},m(w,I){N(w,e,I),E(e,t),E(t,r),E(t,o),E(t,s),E(s,l),E(t,c),ie&&ie.m(t,null),E(e,f),E(e,h),ce&&ce.m(h,null),E(h,d),F&&F.m(h,null),E(h,_),E(h,y),E(y,k),E(k,W),E(k,J),E(k,Z),E(y,se),x&&x.m(y,null),b||(m=[gt(i=_t.call(null,r,xs(n[0].message.type))),gt(re=_t.call(null,Z,n[4]?"chevron-down":"chevron-right")),Ie(k,"click",n[7]),Ie(k,"keydown",n[8])],b=!0)},p(w,[I]){i&&je(i.update)&&I&1&&i.update.call(null,xs(w[0].message.type)),I&1&&a!==(a=w[0].message.title+"")&&Ee(l,a),w[2]?ie?ie.p(w,I):(ie=Sa(w),ie.c(),ie.m(t,null)):ie&&(ie.d(1),ie=null),w[0].message.content?ce?ce.p(w,I):(ce=Ia(w),ce.c(),ce.m(h,d)):ce&&(ce.d(1),ce=null),w[0].message.code?F?F.p(w,I):(F=Pa(w),F.c(),F.m(h,_)):F&&(F.d(1),F=null),re&&je(re.update)&&I&16&&re.update.call(null,w[4]?"chevron-down":"chevron-right"),I&16&&U!==(U=w[4]?"true":"false")&&q(k,"aria-expanded",U),w[4]?x?(x.p(w,I),I&16&&V(x,1)):(x=Ta(w),x.c(),V(x,1),x.m(y,null)):x&&(dt(),K(x,1,1,()=>{x=null}),ht()),I&1&&me!==(me="js-engine-message callout "+ws(w[0].message.type))&&q(e,"class",me),I&1&&g!==(g=w[0].message.type)&&q(e,"data-callout",g)},i(w){V(x)},o(w){K(x)},d(w){w&&L(e),ie&&ie.d(),ce&&ce.d(),F&&F.d(),x&&x.d(),b=!1,we(m)}}}function Pu(n,e,t){let{messageWrapper:r}=e,{messageManager:i}=e,{showDeleteButton:o=!0}=e,{showMessageSource:s=!0}=e,a=!1,l=()=>i.removeMessage(r.uuid),c=d=>d.key===" "?i.removeMessage(r.uuid):void 0,f=()=>t(4,a=!a),h=d=>d.key===" "?t(4,a=!a):void 0;return n.$$set=d=>{"messageWrapper"in d&&t(0,r=d.messageWrapper),"messageManager"in d&&t(1,i=d.messageManager),"showDeleteButton"in d&&t(2,o=d.showDeleteButton),"showMessageSource"in d&&t(3,s=d.showMessageSource)},[r,i,o,s,a,l,c,f,h]}var bs=class extends H{constructor(e){super(),X(this,e,Pu,Iu,Q,{messageWrapper:0,messageManager:1,showDeleteButton:2,showMessageSource:3})}},hn=bs;function Fa(n,e,t){let r=n.slice();return r[5]=e[t][0],r[6]=e[t][1],r[7]=e,r[8]=t,r}function Tu(n){let e;return{c(){e=ne("Clear All Messages")},m(t,r){N(t,e,r)},d(t){t&&L(e)}}}function Oa(n){let e;return{c(){e=A("p"),e.textContent="None"},m(t,r){N(t,e,r)},p:ae,d(t){t&&L(e)}}}function La(n){let e,t,r;function i(s){n[4](s,n[6],n[7],n[8])}let o={messageManager:n[0]};return n[6]!==void 0&&(o.messageWrapper=n[6]),e=new hn({props:o}),Ye.push(()=>dn(e,"messageWrapper",i)),{c(){Qe(e.$$.fragment)},m(s,a){Ge(e,s,a),r=!0},p(s,a){n=s;let l={};a&1&&(l.messageManager=n[0]),!t&&a&2&&(t=!0,l.messageWrapper=n[6],fn(()=>t=!1)),e.$set(l)},i(s){r||(V(e.$$.fragment,s),r=!0)},o(s){K(e.$$.fragment,s),r=!1},d(s){He(e,s)}}}function Cu(n){let e,t,r,i,o,s;r=new Or({props:{variant:"destructive",$$slots:{default:[Tu]},$$scope:{ctx:n}}}),r.$on("click",n[3]);let a=st(n[1]),l=[];for(let h=0;h<a.length;h+=1)l[h]=La(Fa(n,a,h));let c=h=>K(l[h],1,1,()=>{l[h]=null}),f=null;return a.length||(f=Oa(n)),{c(){e=A("h2"),e.textContent="Messages",t=ee(),Qe(r.$$.fragment),i=ee(),o=A("div");for(let h=0;h<l.length;h+=1)l[h].c();f&&f.c()},m(h,d){N(h,e,d),N(h,t,d),Ge(r,h,d),N(h,i,d),N(h,o,d);for(let _=0;_<l.length;_+=1)l[_]&&l[_].m(o,null);f&&f.m(o,null),s=!0},p(h,[d]){let _={};if(d&512&&(_.$$scope={dirty:d,ctx:h}),r.$set(_),d&3){a=st(h[1]);let y;for(y=0;y<a.length;y+=1){let k=Fa(h,a,y);l[y]?(l[y].p(k,d),V(l[y],1)):(l[y]=La(k),l[y].c(),V(l[y],1),l[y].m(o,null))}for(dt(),y=a.length;y<l.length;y+=1)c(y);ht(),!a.length&&f?f.p(h,d):a.length?f&&(f.d(1),f=null):(f=Oa(h),f.c(),f.m(o,null))}},i(h){if(!s){V(r.$$.fragment,h);for(let d=0;d<a.length;d+=1)V(l[d]);s=!0}},o(h){K(r.$$.fragment,h),l=l.filter(Boolean);for(let d=0;d<l.length;d+=1)K(l[d]);s=!1},d(h){h&&(L(e),L(t),L(i),L(o)),He(r,h),an(l,h),f&&f.d()}}}function Fu(n,e,t){let r,{messageManager:i}=e,o=i.messages;ra(n,o,l=>t(1,r=l));let s=()=>i.removeAllMessages();function a(l,c,f,h){f[h][1]=l,o.set(r)}return n.$$set=l=>{"messageManager"in l&&t(0,i=l.messageManager)},[i,r,o,s,a]}var ks=class extends H{constructor(e){super(),X(this,e,Fu,Cu,Q,{messageManager:0})}},Ra=ks;var Lr=class extends Da.Modal{constructor(t,r){super(t);this.plugin=r}onOpen(){this.contentEl.empty(),this.component&&this.component.$destroy(),this.component=new Ra({target:this.contentEl,props:{messageManager:this.plugin.messageManager}})}onClose(){this.contentEl.empty(),this.component&&this.component.$destroy()}};function Na(n){return new Es(n)}var Es=class{constructor(e){this.value=e,this.subscriberCounter=0,this.subscribers=new Map}set(e){this.value!==e&&(this.value=e,this.notify())}update(e){this.set(e(this.value))}get(){return this.value}subscribe(e,t){let r=this.subscriberCounter;return this.subscriberCounter+=1,this.subscribers.set(r,e),e(this.value),()=>{this.subscribers.delete(r)}}notify(){for(let e of this.subscribers.values())e(this.value)}};function qa(n){return[...n]}var Ou=["error","warning","success","tip","info"];function ws(n){return`js-engine-message-mod-${n}`}function xs(n){var t;let e=new Map;return e.set("error","zap"),e.set("warning","alert-triangle"),e.set("success","check"),e.set("tip","flame"),e.set("info","info"),(t=e.get(n))!=null?t:"info"}function Lu(n){return`js-engine-message-indicator-mod-${n}`}var Rr=class{constructor(e,t,r,i){this.type=e,this.title=t,this.content=r,this.code=i}},pn=class{constructor(e,t){this.message=e,this.source=t,this.uuid=self.crypto.randomUUID(),this.time=(0,Nr.moment)()}},Dr=class{constructor(e,t){this.app=e,this.plugin=t,this.messages=Na(new Map)}initStatusBarItem(){this.messageDisplay=new Lr(this.app,this.plugin),this.statusBarItem=this.plugin.addStatusBarItem(),this.statusBarItem.addClass("mod-clickable"),this.statusBarItem.addEventListener("click",()=>{var e;(e=this.messageDisplay)==null||e.open()}),this.updateStatusBarItem(),this.messages.subscribe(e=>{this.updateStatusBarItem()})}addMessage(e,t){let r=new pn(e,t);return this.messages.get().set(r.uuid,r),this.messages.notify(),r}removeMessage(e){this.messages.get().delete(e),this.messages.notify()}removeAllMessages(){this.messages.get().clear(),this.messages.notify()}updateStatusBarItem(){if(!this.statusBarItem)return;this.statusBarItem.empty();let e=this.statusBarItem.createEl("div");(0,Nr.setIcon)(e,"message-square");let t=this.statusBarItem.createEl("span");t.addClass("js-engine-message-counter"),t.innerText=this.messages.get().size.toString();let r=new Set(Array.from(this.messages.get().values()).map(i=>i.message.type));for(let i of Ou)if(r.has(i)){t.addClass(Lu(i));break}r.size===0&&t.addClass("js-engine-message-indicator-mod-info")}getMessagesFromSource(e){let t=this.messages.get();return qa(t.values()).filter(r=>r.source.id===e.id)}};var mn=class{constructor(e,t){this._render=e,this.initialArgs=t}async refresh(...e){var t;(t=this.renderer)==null||t.render(await this._render(...e))}initialRender(){this.refresh(...this.initialArgs)}setRenderer(e){this.renderer=e}};var yn=class{constructor(e,t,r,i){this.plugin=e,this.container=t,this.sourcePath=r,this.component=i}async render(e){if(e!=null){if(this.container.empty(),typeof e=="string"){this.container.innerText=e;return}if(e instanceof Vt&&(e=e.toMarkdown()),e instanceof Mt){console.log(`js-engine | Rendering Markdown String
`,e.content),await e.render(this.plugin.app,this.container,this.sourcePath,this.component);return}if(e instanceof HTMLElement){this.container.append(e);return}if(e instanceof pn){new hn({target:this.container,props:{messageWrapper:e,messageManager:this.plugin.messageManager,showDeleteButton:!1,showMessageSource:!1}});return}if(e instanceof mn){e.setRenderer(this),e.initialRender();return}this.container.innerText=JSON.stringify(e)}}convertToSimpleObject(e){return e instanceof Vt?e.toMarkdown().content:e instanceof Mt?e.content:e instanceof HTMLElement?e.outerHTML:e instanceof pn?e.message:e}};var qr=class extends Nt.MarkdownRenderChild{constructor(t,r,i,o){super(t);this.plugin=r,this.content=i,this.ctx=o}getExecutionFile(){if(!this.ctx.sourcePath)return;let t=this.plugin.app.vault.getAbstractFileByPath(this.ctx.sourcePath);if(t&&t instanceof Nt.TFile)return t}buildExecutionContext(){let t=this.getExecutionFile();return{file:t,metadata:this.plugin.app.metadataCache.getFileCache(t),block:void 0}}async tryRun(t){return this.plugin.jsEngine.execute({code:this.content,context:t,contextOverrides:{},component:this,container:this.containerEl})}async renderResults(t){let r=this.buildExecutionContext();this.jsExecution=await this.tryRun(r);let i=this.jsExecution.result;await new yn(this.plugin,t,this.ctx.sourcePath,this).render(i)}renderExecutionStats(t){let r=new Nt.Menu;r.addItem(o=>{o.setTitle("Info"),o.setIcon("info"),o.onClick(()=>{var s;(s=this.jsExecution)==null||s.openStatsModal()})}),r.addItem(o=>{o.setTitle("Rerun"),o.setIcon("rotate-ccw"),o.onClick(()=>{this.render()})});let i=t.createDiv();i.addClass("js-engine-execution-stats-button"),i.addEventListener("click",o=>{r.showAtMouseEvent(o)}),(0,Nt.setIcon)(i,"info")}async render(){var t,r;this.containerEl.empty(),this.containerEl.hasClass("js-engine-execution-render-child")||this.containerEl.addClass("js-engine-execution-render-child");try{await this.renderResults(this.containerEl),this.renderExecutionStats(this.containerEl)}catch(i){this.containerEl.innerText=i instanceof Error?(r=(t=i.stack)==null?void 0:t.toString())!=null?r:"":i,this.containerEl.addClass("mod-warning")}}async onload(){await this.render()}onunload(){}};var jr=class{constructor(e){this.apiInstance=e}createBuilder(){return new Vt}create(e){return new Mt(e)}createText(e){return new ft(e,!1,!1,!1)}createBoldText(e){return new ft(e,!0,!1,!1)}createCursiveText(e){return new ft(e,!1,!0,!1)}createUnderlinedText(e){return new ft(e,!1,!1,!0)}createCode(e){return new Un(e)}createParagraph(e){return new Vn(e)}createHeading(e,t){return new Hn(e,t)}createBlockQuote(){return new Qn}createCallout(e,t,r=""){return new Xn(e,t,r)}createCodeBlock(e,t){return new Yn(e,t)}createTable(e,t){return new Gn(e,t)}createList(e){return new Zn(e)}};var zr=class{constructor(e){this.apiInstance=e,this.messageManager=e.plugin.messageManager}createMessage(e,t,r,i=""){return this.messageManager.addMessage(new Rr(e,t,r,i),this.apiInstance.instanceId)}getMessageById(e){return this.messageManager.messages.get().get(e)}getMessagesForInstance(){return this.messageManager.getMessagesFromSource(this.apiInstance.instanceId)}};var Za=Ht(Hr()),Ka=Ht(Ts()),$a=Ht(tr()),Wo=Ht(Fs()),el=Ht(Is());var Ws={};Ks(Ws,{AsyncStream:()=>jo,InvalidArgumentError:()=>ge,LengthError:()=>Ze,Stream:()=>qt,infinite:()=>Lt,math:()=>Gu,multi:()=>Hu,reduce:()=>Kr,set:()=>Vu,single:()=>vn,summary:()=>Yu,transform:()=>Qu});var ge=class extends Error{},Ze=class extends Error{};var Qt=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(f){try{c(r.next(f))}catch(h){s(h)}}function l(f){try{c(r.throw(f))}catch(h){s(h)}}function c(f){f.done?o(f.value):i(f.value).then(a,l)}c((r=r.apply(n,e||[])).next())})},vt=function(n){return this instanceof vt?(this.v=n,this):new vt(n)},za=function(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(d){r[d]&&(i[d]=function(_){return new Promise(function(y,k){o.push([d,_,y,k])>1||a(d,_)})})}function a(d,_){try{l(r[d](_))}catch(y){h(o[0][3],y)}}function l(d){d.value instanceof vt?Promise.resolve(d.value.v).then(c,f):h(o[0][2],d)}function c(d){a("next",d)}function f(d){a("throw",d)}function h(d,_){d(_),o.shift(),o.length&&a(o[0][0],o[0][1])}},Te;(function(n){n[n.SHORTEST=0]="SHORTEST",n[n.LONGEST=1]="LONGEST",n[n.STRICT_EQUAL=2]="STRICT_EQUAL"})(Te||(Te={}));function*jt(n,e,...t){if(t.length===0)return;let r=[];for(let i of t)r.push(nr(i));e:for(;;){let i=vn.map(r,l=>l.next()),o=[],s=!0,a=!1;for(let l of i){let c;l.done?(s=!1,c=e):(a=!0,c=l.value),o.push(c)}if(!s&&a)switch(n){case Te.SHORTEST:break e;case Te.STRICT_EQUAL:throw new Ze("Iterators must have equal lengths")}if(!a)break;yield o}}function zt(n,e,...t){return za(this,arguments,function*(){if(t.length===0)return yield vt(void 0);let i=[];for(let o of t)i.push(rr(o));e:for(;;){let o=[];for(let c of i){let f=yield vt(c.next());o.push(f)}let s=[],a=!0,l=!1;for(let c of o){let f;c.done?(a=!1,f=e):(l=!0,f=c.value),s.push(f)}if(!a&&l)switch(n){case Te.SHORTEST:break e;case Te.STRICT_EQUAL:throw new Ze("Iterators must have equal lengths")}if(!l)break;yield yield vt(s)}})}var Xt=class{constructor(){this.addedMap=new Map,this.deletedMap=new Map}addUsage(e,t){this.addedMap.has(e)||this.addedMap.set(e,new Map);let r=this.addedMap.get(e);r.has(t)||r.set(t,0),r.set(t,r.get(t)+1)}deleteUsage(e){this.deletedMap.has(e)?this.deletedMap.set(e,this.deletedMap.get(e)+1):this.deletedMap.set(e,1)}getOwnersCount(e){var t,r;let i=(t=this.deletedMap.get(e))!==null&&t!==void 0?t:0;return qt.of((r=this.addedMap.get(e))!==null&&r!==void 0?r:new Map).map(o=>o[1]).filter(o=>o>i).toValue(o=>o+1,0)}getUsagesCount(e,t=1){var r,i;let o=(r=this.deletedMap.get(e))!==null&&r!==void 0?r:0,s=qt.of((i=this.addedMap.get(e))!==null&&i!==void 0?i:new Map).map(a=>a[1]).map(a=>a-o).filter(a=>a>0).toArray();for(;s.length>t;){let a=Kr.toMin(s);s=qt.of(s).map(l=>l-a).filter(l=>l>0).toArray()}return Kr.toSum(s)}},Ce=class{},Xr=class{constructor(e,t){this.related=[],this.positions=[],this.cache=new Map,this.lastCacheIndex=0,this.isValid=!0,this.iterator=e;for(let r=0;r<t;++r)this.related.push(new Ds(this,r)),this.positions.push(0);this.cacheNextValue()}current(e){let t=this.getPosition(e);return this.cache.get(t)}next(e){let[t,r,i]=[this.getPosition(e),Math.min(...this.positions),Math.max(...this.positions)];t===i&&this.cacheNextValue(),this.positions[e.getId()]++,r<Math.min(...this.positions)&&this.cache.delete(r)}valid(e){return this.getPosition(e)<this.lastCacheIndex||this.isValid}getRelatedIterables(){return this.related}cacheNextValue(){let e=this.iterator.next();e.done||this.cache.set(this.lastCacheIndex++,e.value),this.isValid=!e.done}getPosition(e){return this.positions[e.getId()]}},Ds=class{constructor(e,t){this.parent=e,this.id=t}getId(){return this.id}valid(){return this.parent.valid(this)}next(){let e={value:this.current(),done:!this.valid()};return e.done||this.parent.next(this),e}current(){return this.parent.valid(this)?this.parent.current(this):void 0}*[Symbol.iterator](){for(;this.parent.valid(this);)yield this.parent.current(this),this.parent.next(this)}},Zr=class{constructor(e,t){this.related=[],this.positions=[],this.cache=new Map,this.lastCacheIndex=0,this.isValid=!0,this.isFirstIteration=!0,this.iterator=e;for(let r=0;r<t;++r)this.related.push(new Ns(this,r)),this.positions.push(0)}current(e){return Qt(this,void 0,void 0,function*(){this.isFirstIteration&&(yield this.cacheNextValue());let t=this.getPosition(e);return this.cache.get(t)})}next(e){return Qt(this,void 0,void 0,function*(){let[t,r,i]=[this.getPosition(e),Math.min(...this.positions),Math.max(...this.positions)];t===i&&(yield this.cacheNextValue()),this.positions[e.getId()]++,r<Math.min(...this.positions)&&this.cache.delete(r)})}valid(e){return Qt(this,void 0,void 0,function*(){return this.isFirstIteration&&(yield this.cacheNextValue()),this.getPosition(e)<this.lastCacheIndex||this.isValid})}getRelatedIterables(){return this.related}cacheNextValue(){return Qt(this,void 0,void 0,function*(){let e=yield this.iterator.next();e.done||this.cache.set(this.lastCacheIndex++,e.value),this.isFirstIteration=!1,this.isValid=!e.done})}getPosition(e){return this.positions[e.getId()]}},Ns=class{constructor(e,t){this.parent=e,this.id=t}getId(){return this.id}valid(){return Qt(this,void 0,void 0,function*(){return yield this.parent.valid(this)})}next(){return Qt(this,void 0,void 0,function*(){let e={value:yield this.current(),done:!(yield this.valid())};return e.done||(yield this.parent.next(this)),e})}current(){return Qt(this,void 0,void 0,function*(){return(yield this.parent.valid(this))?yield this.parent.current(this):void 0})}[Symbol.asyncIterator](){return za(this,arguments,function*(){for(;yield vt(this.parent.valid(this));)yield yield vt(yield vt(this.parent.current(this))),yield vt(this.parent.next(this))})}};var ir=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}},De=function(n){return this instanceof De?(this.v=n,this):new De(n)},or=function(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(d){r[d]&&(i[d]=function(_){return new Promise(function(y,k){o.push([d,_,y,k])>1||a(d,_)})})}function a(d,_){try{l(r[d](_))}catch(y){h(o[0][3],y)}}function l(d){d.value instanceof De?Promise.resolve(d.value.v).then(c,f):h(o[0][2],d)}function c(d){a("next",d)}function f(d){a("throw",d)}function h(d,_){d(_),o.shift(),o.length&&a(o[0][0],o[0][1])}};function*bn(...n){for(let e of jt(Te.SHORTEST,void 0,...n))yield e}function wn(...n){return or(this,arguments,function*(){var t,r,i,o;try{for(var s=!0,a=ir(zt(Te.SHORTEST,void 0,...n)),l;l=yield De(a.next()),t=l.done,!t;){o=l.value,s=!1;try{yield yield De(o)}finally{s=!0}}}catch(c){r={error:c}}finally{try{!s&&!t&&(i=a.return)&&(yield De(i.call(a)))}finally{if(r)throw r.error}}})}function*$r(n,...e){for(let t of jt(Te.LONGEST,n,...e))yield t}function ei(n,...e){return or(this,arguments,function*(){var r,i,o,s;try{for(var a=!0,l=ir(zt(Te.LONGEST,n,...e)),c;c=yield De(l.next()),r=c.done,!r;){s=c.value,a=!1;try{yield yield De(s)}finally{a=!0}}}catch(f){i={error:f}}finally{try{!a&&!r&&(o=l.return)&&(yield De(o.call(l)))}finally{if(i)throw i.error}}})}function*ti(...n){for(let e of jt(Te.LONGEST,void 0,...n))yield e}function ni(...n){return or(this,arguments,function*(){var t,r,i,o;try{for(var s=!0,a=ir(zt(Te.LONGEST,void 0,...n)),l;l=yield De(a.next()),t=l.done,!t;){o=l.value,s=!1;try{yield yield De(o)}finally{s=!0}}}catch(c){r={error:c}}finally{try{!s&&!t&&(i=a.return)&&(yield De(i.call(a)))}finally{if(r)throw r.error}}})}function*xn(...n){for(let e of jt(Te.STRICT_EQUAL,void 0,...n))yield e}function kn(...n){return or(this,arguments,function*(){var t,r,i,o;try{for(var s=!0,a=ir(zt(Te.STRICT_EQUAL,void 0,...n)),l;l=yield De(a.next()),t=l.done,!t;){o=l.value,s=!1;try{yield yield De(o)}finally{s=!0}}}catch(c){r={error:c}}finally{try{!s&&!t&&(i=a.return)&&(yield De(i.call(a)))}finally{if(r)throw r.error}}})}function*ri(...n){for(let e of n)for(let t of z(e))yield t}function ii(...n){return or(this,arguments,function*(){var t,r,i,o;for(let c of n)try{for(var s=!0,a=(r=void 0,ir(R(c))),l;l=yield De(a.next()),t=l.done,!t;){o=l.value,s=!1;try{yield yield De(o)}finally{s=!0}}}catch(f){r={error:f}}finally{try{!s&&!t&&(i=a.return)&&(yield De(i.call(a)))}finally{if(r)throw r.error}}})}var Ve=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(f){try{c(r.next(f))}catch(h){s(h)}}function l(f){try{c(r.throw(f))}catch(h){s(h)}}function c(f){f.done?o(f.value):i(f.value).then(a,l)}c((r=r.apply(n,e||[])).next())})},oi=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}};function tt(n,e,t){let r=t;for(let i of z(n))r=e(r,i);return r}function nt(n,e,t){var r,i,o,s;return Ve(this,void 0,void 0,function*(){let a=t;try{for(var l=!0,c=oi(R(n)),f;f=yield c.next(),r=f.done,!r;){s=f.value,l=!1;try{a=yield e(a,s)}finally{l=!0}}}catch(h){i={error:h}}finally{try{!l&&!r&&(o=c.return)&&(yield o.call(c))}finally{if(i)throw i.error}}return a})}function si(n){let[e,t]=tt(n,(r,i)=>{let[o,s]=r;return[o+1,s+Number(i)]},[0,0]);return e?t/e:void 0}function ai(n){return Ve(this,void 0,void 0,function*(){let[e,t]=yield nt(n,(r,i)=>{let[o,s]=r;return[o+1,s+Number(i)]},[0,0]);return e?t/e:void 0})}function li(n,e){return e!==void 0?tt(n,(t,r)=>e(r)>e(t!=null?t:r)?r:t!=null?t:r):tt(n,(t,r)=>{let i=t!=null?t:r,o=r;return i>=o?i:o})}function ui(n,e){return Ve(this,void 0,void 0,function*(){return e!==void 0?yield nt(n,(t,r)=>Ve(this,void 0,void 0,function*(){return(yield e(r))>(yield e(t!=null?t:r))?r:t!=null?t:r})):yield nt(n,(t,r)=>{let i=t!=null?t:r,o=r;return i>=o?i:o})})}function ci(n,e){return e!==void 0?tt(n,(t,r)=>e(r)<e(t!=null?t:r)?r:t!=null?t:r):tt(n,(t,r)=>{let i=t!=null?t:r,o=r;return i<=o?i:o})}function fi(n,e){return Ve(this,void 0,void 0,function*(){return e!==void 0?yield nt(n,(t,r)=>Ve(this,void 0,void 0,function*(){return(yield e(r))<(yield e(t!=null?t:r))?r:t!=null?t:r})):yield nt(n,(t,r)=>{let i=t!=null?t:r,o=r;return i<=o?i:o})})}function sr(n,e){let t=e!==void 0?e:r=>r;return tt(n,(r,i)=>{var o,s,a,l;return r=r,[t(i)<=t((o=r[0])!==null&&o!==void 0?o:i)?i:(s=r[0])!==null&&s!==void 0?s:i,t(i)>=t((a=r[1])!==null&&a!==void 0?a:i)?i:(l=r[1])!==null&&l!==void 0?l:i]},[void 0,void 0])}function ar(n,e){return Ve(this,void 0,void 0,function*(){let t=e!==void 0?e:r=>r;return yield nt(n,(r,i)=>Ve(this,void 0,void 0,function*(){var o,s,a,l;return r=r,[(yield t(i))<=(yield t((o=r[0])!==null&&o!==void 0?o:i))?i:(s=r[0])!==null&&s!==void 0?s:i,(yield t(i))>=(yield t((a=r[1])!==null&&a!==void 0?a:i))?i:(l=r[1])!==null&&l!==void 0?l:i]}),[void 0,void 0])})}function di(n){let[e,t]=sr(Wt(n,r=>Number(r)));return(t!=null?t:0)-(e!=null?e:0)}function hi(n){return Ve(this,void 0,void 0,function*(){let[e,t]=yield ar(wt(n,r=>Number(r)));return(t!=null?t:0)-(e!=null?e:0)})}function pi(n){return tt(n,(e,t)=>e+Number(t),0)}function mi(n){return Ve(this,void 0,void 0,function*(){return yield nt(n,(e,t)=>e+Number(t),0)})}function yi(n){return tt(n,(e,t)=>(e!=null?e:1)*t)}function gi(n){return Ve(this,void 0,void 0,function*(){return yield nt(n,(e,t)=>(e!=null?e:1)*t)})}function Zt(n){switch(!0){case n instanceof Array:return n.length;case bt(n):return n.length;case n instanceof Set:return n.size;case n instanceof Map:return n.size}return tt(n,e=>e+1,0)}function En(n){return Ve(this,void 0,void 0,function*(){switch(!0){case n instanceof Array:case bt(n):case n instanceof Set:case n instanceof Map:return Zt(n)}return yield nt(n,e=>e+1,0)})}function _i(n){for(let e of z(n))return e;throw new Ze("Collection is empty")}function vi(n){var e,t,r,i;return Ve(this,void 0,void 0,function*(){try{for(var o=!0,s=oi(R(n)),a;a=yield s.next(),e=a.done,!e;){i=a.value,o=!1;try{return i}finally{o=!0}}}catch(l){t={error:l}}finally{try{!o&&!e&&(r=s.return)&&(yield r.call(s))}finally{if(t)throw t.error}}throw new Ze("Collection is empty")})}function bi(n){let e=!0,t;for(let r of z(n))t=r,e=!1;if(e)throw new Ze("Collection is empty");return t}function wi(n){var e,t,r,i;return Ve(this,void 0,void 0,function*(){let o=!0,s;try{for(var a=!0,l=oi(R(n)),c;c=yield l.next(),e=c.done,!e;){i=c.value,a=!1;try{s=i,o=!1}finally{a=!0}}}catch(f){t={error:f}}finally{try{!a&&!e&&(r=l.return)&&(yield r.call(l))}finally{if(t)throw t.error}}if(o)throw new Ze("Collection is empty");return s})}function xi(n){let e=Ce,t=Ce;for(let r of z(n))e===Ce&&(e=r),t=r;if(e===Ce)throw new Ze("Collection is empty");return[e,t]}function ki(n){var e,t,r,i;return Ve(this,void 0,void 0,function*(){let o=Ce,s=Ce;try{for(var a=!0,l=oi(R(n)),c;c=yield l.next(),e=c.done,!e;){i=c.value,a=!1;try{let f=i;o===Ce&&(o=f),s=f}finally{a=!0}}}catch(f){t={error:f}}finally{try{!a&&!e&&(r=l.return)&&(yield r.call(l))}finally{if(t)throw t.error}}if(o===Ce)throw new Ze("Collection is empty");return[o,s]})}var pt=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(f){try{c(r.next(f))}catch(h){s(h)}}function l(f){try{c(r.throw(f))}catch(h){s(h)}}function c(f){f.done?o(f.value):i(f.value).then(a,l)}c((r=r.apply(n,e||[])).next())})},Pt=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}};function Ei(n,e){for(let t of z(n))if(!e(t))return!1;return!0}function Mi(n,e){var t,r,i,o;return pt(this,void 0,void 0,function*(){try{for(var s=!0,a=Pt(R(n)),l;l=yield a.next(),t=l.done,!t;){o=l.value,s=!1;try{if(!(yield e(o)))return!1}finally{s=!0}}}catch(c){r={error:c}}finally{try{!s&&!t&&(i=a.return)&&(yield i.call(a))}finally{if(r)throw r.error}}return!0})}function Ai(n){let e=new Set;for(let t of z(n)){if(e.has(t))return!1;e.add(t)}return!0}function Si(n){var e,t,r,i;return pt(this,void 0,void 0,function*(){let o=new Set;try{for(var s=!0,a=Pt(R(n)),l;l=yield a.next(),e=l.done,!e;){i=l.value,s=!1;try{let c=i;if(o.has(c))return!1;o.add(c)}finally{s=!0}}}catch(c){t={error:c}}finally{try{!s&&!e&&(r=a.return)&&(yield r.call(a))}finally{if(t)throw t.error}}return!0})}function Ii(n,e){for(let t of z(n))if(e(t))return!0;return!1}function Pi(n,e){var t,r,i,o;return pt(this,void 0,void 0,function*(){try{for(var s=!0,a=Pt(R(n)),l;l=yield a.next(),t=l.done,!t;){o=l.value,s=!1;try{if(yield e(o))return!0}finally{s=!0}}}catch(c){r={error:c}}finally{try{!s&&!t&&(i=a.return)&&(yield i.call(a))}finally{if(r)throw r.error}}return!1})}function Ti(n,e,t){if(e<0)return!1;t===void 0&&(t=i=>!!i);let r=0;for(let i of z(n))if(t(i)&&(r++,r>e))return!1;return r===e}function Ci(n,e,t){var r,i,o,s;return pt(this,void 0,void 0,function*(){if(e<0)return!1;t===void 0&&(t=h=>!!h);let a=0;try{for(var l=!0,c=Pt(R(n)),f;f=yield c.next(),r=f.done,!r;){s=f.value,l=!1;try{if((yield t(s))&&(a++,a>e))return!1}finally{l=!0}}}catch(h){i={error:h}}finally{try{!l&&!r&&(o=c.return)&&(yield o.call(c))}finally{if(i)throw i.error}}return a===e})}function Wa(n){for(let e of z(n))return!1;return!0}function Ba(n){var e,t,r,i;return pt(this,void 0,void 0,function*(){try{for(var o=!0,s=Pt(R(n)),a;a=yield s.next(),e=a.done,!e;){i=a.value,o=!1;try{let l=i;return!1}finally{o=!0}}}catch(l){t={error:l}}finally{try{!o&&!e&&(r=s.return)&&(yield r.call(s))}finally{if(t)throw t.error}}return!0})}function Ke(n){return n==null?!1:typeof n[Symbol.iterator]=="function"}function Tt(n){return n==null?!1:typeof n[Symbol.asyncIterator]=="function"}function ut(n){return n==null?!1:n.next!==void 0&&typeof n.next=="function"}function Fi(n){for(let[e,t]of Ct(z(n)))if(e<t)return!1;return!0}function Oi(n){var e,t,r,i;return pt(this,void 0,void 0,function*(){try{for(var o=!0,s=Pt(Kt(R(n))),a;a=yield s.next(),e=a.done,!e;){i=a.value,o=!1;try{let[l,c]=i;if(l<c)return!1}finally{o=!0}}}catch(l){t={error:l}}finally{try{!o&&!e&&(r=s.return)&&(yield r.call(s))}finally{if(t)throw t.error}}return!0})}function Li(n){for(let[e,t]of Ct(z(n)))if(e>t)return!1;return!0}function Ri(n){var e,t,r,i;return pt(this,void 0,void 0,function*(){try{for(var o=!0,s=Pt(Kt(R(n))),a;a=yield s.next(),e=a.done,!e;){i=a.value,o=!1;try{let[l,c]=i;if(l>c)return!1}finally{o=!0}}}catch(l){t={error:l}}finally{try{!o&&!e&&(r=s.return)&&(yield r.call(s))}finally{if(t)throw t.error}}return!0})}function bt(n){return typeof n=="string"||n instanceof String}function Di(n,e){for(let t of z(n))if(e(t))return!1;return!0}function Ni(n,e){var t,r,i,o;return pt(this,void 0,void 0,function*(){try{for(var s=!0,a=Pt(R(n)),l;l=yield a.next(),t=l.done,!t;){o=l.value,s=!1;try{if(yield e(o))return!1}finally{s=!0}}}catch(c){r={error:c}}finally{try{!s&&!t&&(i=a.return)&&(yield i.call(a))}finally{if(r)throw r.error}}return!0})}function qi(...n){try{for(let e of xn(...n))for(let[t,r]of Ct(e))if(t!==r)return!1}catch(e){return!1}return!0}function ji(...n){var e,t,r,i;return pt(this,void 0,void 0,function*(){try{try{for(var o=!0,s=Pt(kn(...n)),a;a=yield s.next(),e=a.done,!e;){i=a.value,o=!1;try{let l=i;for(let[c,f]of Ct(l))if(c!==f)return!1}finally{o=!0}}}catch(l){t={error:l}}finally{try{!o&&!e&&(r=s.return)&&(yield r.call(s))}finally{if(t)throw t.error}}}catch(l){return!1}return!0})}function zi(...n){if(n.length<=1)return!0;let e=n.map(t=>Zt(t));return new Set(e).size===1}function Wi(...n){return pt(this,void 0,void 0,function*(){if(n.length<=1)return!0;let e=yield wt(n,t=>pt(this,void 0,void 0,function*(){return yield En(t)}));return new Set(yield mt(e)).size===1})}var js=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(f){try{c(r.next(f))}catch(h){s(h)}}function l(f){try{c(r.throw(f))}catch(h){s(h)}}function c(f){f.done?o(f.value):i(f.value).then(a,l)}c((r=r.apply(n,e||[])).next())})},xt=function(n){return this instanceof xt?(this.v=n,this):new xt(n)},qs=function(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(d){r[d]&&(i[d]=function(_){return new Promise(function(y,k){o.push([d,_,y,k])>1||a(d,_)})})}function a(d,_){try{l(r[d](_))}catch(y){h(o[0][3],y)}}function l(d){d.value instanceof xt?Promise.resolve(d.value.v).then(c,f):h(o[0][2],d)}function c(d){a("next",d)}function f(d){a("throw",d)}function h(d,_){d(_),o.shift(),o.length&&a(o[0][0],o[0][1])}},Bi=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}};function z(n){if(Ke(n))return n;if(ut(n))return{[Symbol.iterator](){return n}};if(typeof n=="object"&&n!==null)return function*(){for(let e in n)Object.prototype.hasOwnProperty.call(n,e)&&(yield[e,n[e]])}();throw new ge("Given collection is not iterable or iterator.")}function R(n){if(Tt(n))return n;if(ut(n))return{[Symbol.asyncIterator](){return qs(this,arguments,function*(){for(;;){let t=yield xt(n.next());if(t.done)return yield xt(void 0);yield yield xt(t.value)}})}};if(typeof n=="object"&&n!==null&&(n=z(n)),Ke(n))return{[Symbol.asyncIterator](){return qs(this,arguments,function*(){for(let t of n)yield yield xt(t)})}};throw new ge("Given collection is not async iterable or iterator.")}function nr(n){if(ut(n))return n;if(Ke(n))return function*(){for(let e of n)yield e}();throw new ge("Given collection is not iterable or iterator.")}function rr(n){if((ut(n)||Ke(n))&&(n=R(n)),Tt(n))return function(){return qs(this,arguments,function*(){var e,t,r,i;try{for(var o=!0,s=Bi(n),a;a=yield xt(s.next()),e=a.done,!e;){i=a.value,o=!1;try{yield yield xt(i)}finally{o=!0}}}catch(l){t={error:l}}finally{try{!o&&!e&&(r=s.return)&&(yield xt(r.call(s)))}finally{if(t)throw t.error}}})}();throw new ge("Given collection is not iterable or iterator.")}function Ft(n){let e=[];for(let t of z(n))e.push(t);return e}function mt(n){var e,t,r,i;return js(this,void 0,void 0,function*(){let o=[];try{for(var s=!0,a=Bi(R(n)),l;l=yield a.next(),e=l.done,!e;){i=l.value,s=!1;try{let c=i;o.push(c)}finally{s=!0}}}catch(c){t={error:c}}finally{try{!s&&!e&&(r=a.return)&&(yield r.call(a))}finally{if(t)throw t.error}}return o})}function Ji(n){let e=new Map;for(let[t,r]of z(n))e.set(t,r);return e}function Ui(n){var e,t,r,i;return js(this,void 0,void 0,function*(){let o=new Map;try{for(var s=!0,a=Bi(R(n)),l;l=yield a.next(),e=l.done,!e;){i=l.value,s=!1;try{let[c,f]=i;o.set(c,f)}finally{s=!0}}}catch(c){t={error:c}}finally{try{!s&&!e&&(r=a.return)&&(yield r.call(a))}finally{if(t)throw t.error}}return o})}function Gi(n){let e=new Set;for(let t of z(n))e.add(t);return e}function Hi(n){var e,t,r,i;return js(this,void 0,void 0,function*(){let o=new Set;try{for(var s=!0,a=Bi(R(n)),l;l=yield a.next(),e=l.done,!e;){i=l.value,s=!1;try{let c=i;o.add(c)}finally{s=!0}}}catch(c){t={error:c}}finally{try{!s&&!e&&(r=a.return)&&(yield r.call(a))}finally{if(t)throw t.error}}return o})}function Mn(n,e){return new Xr(nr(n),e).getRelatedIterables()}function An(n,e){return new Zr(rr(n),e).getRelatedIterables()}var Wu=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(f){try{c(r.next(f))}catch(h){s(h)}}function l(f){try{c(r.throw(f))}catch(h){s(h)}}function c(f){f.done?o(f.value):i(f.value).then(a,l)}c((r=r.apply(n,e||[])).next())})},xe=function(n){return this instanceof xe?(this.v=n,this):new xe(n)},Sn=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}},In=function(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(d){r[d]&&(i[d]=function(_){return new Promise(function(y,k){o.push([d,_,y,k])>1||a(d,_)})})}function a(d,_){try{l(r[d](_))}catch(y){h(o[0][3],y)}}function l(d){d.value instanceof xe?Promise.resolve(d.value.v).then(c,f):h(o[0][2],d)}function c(d){a("next",d)}function f(d){a("throw",d)}function h(d,_){d(_),o.shift(),o.length&&a(o[0][0],o[0][1])}},Ja=function(n){var e,t;return e={},r("next"),r("throw",function(i){throw i}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(i,o){e[i]=n[i]?function(s){return(t=!t)?{value:xe(n[i](s)),done:i==="return"}:o?o(s):s}:o}};function*$t(n,e){let t=new Set;if(n instanceof Map){e===void 0&&(e=r=>r[1]);for(let r of n){let i=e(r);t.has(i)||(yield r,t.add(i))}}else{e===void 0&&(e=r=>r);for(let r of z(n)){let i=e(r);t.has(i)||(yield r,t.add(i))}}}function Pn(n,e){return In(this,arguments,function*(){var r,i,o,s;let a=new Set;if(n instanceof Map)for(let h of $t(n,e))yield yield xe(yield xe(h));else{e===void 0&&(e=h=>h);try{for(var l=!0,c=Sn(R(n)),f;f=yield xe(c.next()),r=f.done,!r;){s=f.value,l=!1;try{let h=s,d=e(h);a.has(d)||(yield yield xe(h),a.add(d))}finally{l=!0}}}catch(h){i={error:h}}finally{try{!l&&!r&&(o=c.return)&&(yield xe(o.call(c)))}finally{if(i)throw i.error}}}})}function*Vi(...n){yield*Tn(n.length,...n)}function Yi(...n){return In(this,arguments,function*(){yield xe(yield*Ja(Sn(Cn(n.length,...n))))})}function*Tn(n,...e){let t=new Xt,r=jt(Te.LONGEST,Ce,...e);for(let i of r)for(let[o,s]of Ot(i))s!==Ce&&(t.addUsage(s,`${o}`),t.getOwnersCount(s)===n&&(yield s,t.deleteUsage(s)))}function Cn(n,...e){return In(this,arguments,function*(){var r,i,o,s;let a=new Xt,l=zt(Te.LONGEST,Ce,...e);try{for(var c=!0,f=Sn(l),h;h=yield xe(f.next()),r=h.done,!r;){s=h.value,c=!1;try{let d=s;for(let[_,y]of Ot(d))y!==Ce&&(a.addUsage(y,`${_}`),a.getOwnersCount(y)===n&&(yield yield xe(y),a.deleteUsage(y)))}finally{c=!0}}}catch(d){i={error:d}}finally{try{!c&&!r&&(o=f.return)&&(yield xe(o.call(f)))}finally{if(i)throw i.error}}})}function*Qi(...n){let e=new Xt,t=new Set,r=jt(Te.LONGEST,Ce,...n);for(let i of r)for(let[o,s]of Ot(i))s!==Ce&&(e.addUsage(s,`${o}`),t.add(s),e.getOwnersCount(s)===n.length&&e.deleteUsage(s));for(let i of t)for(let o of vn.repeat(i,e.getUsagesCount(i)))yield o}function Xi(...n){return In(this,arguments,function*(){var t,r,i,o;let s=new Xt,a=new Set,l=zt(Te.LONGEST,Ce,...n);try{for(var c=!0,f=Sn(l),h;h=yield xe(f.next()),t=h.done,!t;){o=h.value,c=!1;try{let d=o;for(let[_,y]of Ot(d))y!==Ce&&(s.addUsage(y,`${_}`),a.add(y),s.getOwnersCount(y)===n.length&&s.deleteUsage(y))}finally{c=!0}}}catch(d){r={error:d}}finally{try{!c&&!t&&(i=f.return)&&(yield xe(i.call(f)))}finally{if(r)throw r.error}}for(let d of a)for(let _ of vn.repeat(d,s.getUsagesCount(d)))yield yield xe(_)})}function*Zi(...n){yield*Tn(1,...n)}function Ki(...n){return In(this,arguments,function*(){yield xe(yield*Ja(Sn(Cn(1,...n))))})}function*$i(...n){if(n.length===0)return;if(n.length===1){for(let r of z(n[0]))yield[r];return}let t=Ft(Wt(n,r=>Ft(r))).reduce((r,i)=>r.flatMap(o=>i.map(s=>[...o,s])),[[]]);for(let r of t)yield r}function eo(...n){return In(this,arguments,function*(){var t,r,i,o;if(n.length===0)return yield xe(void 0);if(n.length===1){try{for(var s=!0,a=Sn(R(n[0])),l;l=yield xe(a.next()),t=l.done,!t;){o=l.value,s=!1;try{yield yield xe([o])}finally{s=!0}}}catch(h){r={error:h}}finally{try{!s&&!t&&(i=a.return)&&(yield xe(i.call(a)))}finally{if(r)throw r.error}}return yield xe(void 0)}let f=(yield xe(mt(wt(n,h=>Wu(this,void 0,void 0,function*(){return yield mt(h)}))))).reduce((h,d)=>h.flatMap(_=>d.map(y=>[..._,y])),[[]]);for(let h of f)yield yield xe(h)})}var Me=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}},M=function(n){return this instanceof M?(this.v=n,this):new M(n)},Fe=function(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(d){r[d]&&(i[d]=function(_){return new Promise(function(y,k){o.push([d,_,y,k])>1||a(d,_)})})}function a(d,_){try{l(r[d](_))}catch(y){h(o[0][3],y)}}function l(d){d.value instanceof M?Promise.resolve(d.value.v).then(c,f):h(o[0][2],d)}function c(d){a("next",d)}function f(d){a("throw",d)}function h(d,_){d(_),o.shift(),o.length&&a(o[0][0],o[0][1])}};function*Wt(n,e){for(let t of z(n))yield e(t)}function wt(n,e){return Fe(this,arguments,function*(){var r,i,o,s;try{for(var a=!0,l=Me(R(n)),c;c=yield M(l.next()),r=c.done,!r;){s=c.value,a=!1;try{yield yield M(yield M(e(s)))}finally{a=!0}}}catch(f){i={error:f}}finally{try{!a&&!r&&(o=l.return)&&(yield M(o.call(l)))}finally{if(i)throw i.error}}})}function*to(n,e){for(let[t,r]of bn(n,e))r&&(yield t)}function no(n,e){return Fe(this,arguments,function*(){var r,i,o,s;try{for(var a=!0,l=Me(wn(n,e)),c;c=yield M(l.next()),r=c.done,!r;){s=c.value,a=!1;try{let[f,h]=s;h&&(yield yield M(f))}finally{a=!0}}}catch(f){i={error:f}}finally{try{!a&&!r&&(o=l.return)&&(yield M(o.call(l)))}finally{if(i)throw i.error}}})}function*ro(n,e){let t=!0;for(let r of z(n)){if(t){if(!e(r)){t=!1,yield r;continue}continue}yield r}}function io(n,e){return Fe(this,arguments,function*(){var r,i,o,s;let a=!0;try{for(var l=!0,c=Me(R(n)),f;f=yield M(c.next()),r=f.done,!r;){s=f.value,l=!1;try{let h=s;if(a){if(!(yield M(e(h)))){a=!1,yield yield M(h);continue}continue}yield yield M(h)}finally{l=!0}}}catch(h){i={error:h}}finally{try{!l&&!r&&(o=c.return)&&(yield M(o.call(c)))}finally{if(i)throw i.error}}})}function*oo(n,e){for(let t of z(n))if(e(t))yield t;else break}function so(n,e){return Fe(this,arguments,function*(){var r,i,o,s;try{for(var a=!0,l=Me(R(n)),c;c=yield M(l.next()),r=c.done,!r;){s=c.value,a=!1;try{let f=s;if(yield M(e(f)))yield yield M(f);else break}finally{a=!0}}}catch(f){i={error:f}}finally{try{!a&&!r&&(o=l.return)&&(yield M(o.call(l)))}finally{if(i)throw i.error}}})}function*Ua(n,e){if(e<0)throw new ge(`Number of repetitions cannot be negative: ${e}`);for(let t=e;t>0;--t)yield n}function Ga(n,e){return Fe(this,arguments,function*(){if(e<0)throw new ge(`Number of repetitions cannot be negative: ${e}`);let r=yield M(n);for(let i=e;i>0;--i)yield yield M(r)})}function*ao(n,e){for(let t of z(n)){let r=e(t,e);if(Ke(r))for(let i of z(r))yield i;else yield r}}function lo(n,e){return Fe(this,arguments,function*(){var r,i,o,s,a,l,c,f;try{for(var h=!0,d=Me(R(n)),_;_=yield M(d.next()),r=_.done,!r;){s=_.value,h=!1;try{let Z=yield M(e(s,e));if(Ke(Z)||Tt(Z))try{for(var y=!0,k=(l=void 0,Me(R(Z))),W;W=yield M(k.next()),a=W.done,!a;){f=W.value,y=!1;try{yield yield M(f)}finally{y=!0}}}catch(re){l={error:re}}finally{try{!y&&!a&&(c=k.return)&&(yield M(c.call(k)))}finally{if(l)throw l.error}}else yield yield M(Z)}finally{h=!0}}}catch(J){i={error:J}}finally{try{!h&&!r&&(o=d.return)&&(yield M(o.call(d)))}finally{if(i)throw i.error}}})}function*lr(n,e=1/0){if(e<1){for(let t of z(n))n instanceof Map&&(t=t[1]),yield t;return}for(let t of z(n))if(n instanceof Map&&(t=t[1]),(Ke(t)||ut(t))&&!bt(t))for(let r of lr(t,e-1))yield r;else yield t}function ur(n,e=1/0){return Fe(this,arguments,function*(){var r,i,o,s,a,l,c,f,h,d,_,y;if(e<1){try{for(var k=!0,W=Me(R(n)),J;J=yield M(W.next()),r=J.done,!r;){s=J.value,k=!1;try{let b=s;n instanceof Map&&(b=b[1]),yield yield M(b)}finally{k=!0}}}catch(b){i={error:b}}finally{try{!k&&!r&&(o=W.return)&&(yield M(o.call(W)))}finally{if(i)throw i.error}}return yield M(void 0)}try{for(var Z=!0,re=Me(R(n)),U;U=yield M(re.next()),a=U.done,!a;){f=U.value,Z=!1;try{let b=f;if(n instanceof Map&&(b=b[1]),(Tt(b)||Ke(b)||ut(b))&&!bt(b))try{for(var se=!0,me=(d=void 0,Me(ur(b,e-1))),g;g=yield M(me.next()),h=g.done,!h;){y=g.value,se=!1;try{yield yield M(y)}finally{se=!0}}}catch(m){d={error:m}}finally{try{!se&&!h&&(_=me.return)&&(yield M(_.call(me)))}finally{if(d)throw d.error}}else yield yield M(b)}finally{Z=!0}}}catch(b){l={error:b}}finally{try{!Z&&!a&&(c=re.return)&&(yield M(c.call(re)))}finally{if(l)throw l.error}}})}function*uo(n,e){for(let t of z(n))e(t)&&(yield t)}function co(n,e){return Fe(this,arguments,function*(){var r,i,o,s;try{for(var a=!0,l=Me(R(n)),c;c=yield M(l.next()),r=c.done,!r;){s=c.value,a=!1;try{let f=s;(yield M(e(f)))&&(yield yield M(f))}finally{a=!0}}}catch(f){i={error:f}}finally{try{!a&&!r&&(o=l.return)&&(yield M(o.call(l)))}finally{if(i)throw i.error}}})}function*Fn(n,e,t,r=!0){if(e<1)throw new ge(`Chunk size must be \u2265 1. Got ${e}`);if(t>=e)throw new ge("Overlap size must be less than chunk size");let i=[],o=!1;for(let s of z(n))o=!1,i.push(s),i.length===e&&(yield i,i=i.slice(e-t),o=!0);!o&&i.length>0&&r&&(yield i)}function On(n,e,t,r=!0){return Fe(this,arguments,function*(){var o,s,a,l;if(e<1)throw new ge(`Chunk size must be \u2265 1. Got ${e}`);if(t>=e)throw new ge("Overlap size must be less than chunk size");let c=[],f=!1;try{for(var h=!0,d=Me(R(n)),_;_=yield M(d.next()),o=_.done,!o;){l=_.value,h=!1;try{let y=l;f=!1,c.push(y),c.length===e&&(yield yield M(c),c=c.slice(e-t),f=!0)}finally{h=!0}}}catch(y){s={error:y}}finally{try{!h&&!o&&(a=d.return)&&(yield M(a.call(d)))}finally{if(s)throw s.error}}!f&&c.length>0&&r&&(yield yield M(c))})}function*fo(n,e){for(let t of Fn(n,e,0))yield t}function ho(n,e){return Fe(this,arguments,function*(){var r,i,o,s;try{for(var a=!0,l=Me(On(n,e,0)),c;c=yield M(l.next()),r=c.done,!r;){s=c.value,a=!1;try{yield yield M(s)}finally{a=!0}}}catch(f){i={error:f}}finally{try{!a&&!r&&(o=l.return)&&(yield M(o.call(l)))}finally{if(i)throw i.error}}})}function*Ct(n){let e=Fn(n,2,1,!1);for(let t of e)yield t}function Kt(n){return Fe(this,arguments,function*(){var t,r,i,o;let s=On(n,2,1,!1);try{for(var a=!0,l=Me(s),c;c=yield M(l.next()),t=c.done,!t;){o=c.value,a=!1;try{yield yield M(o)}finally{a=!0}}}catch(f){r={error:f}}finally{try{!a&&!t&&(i=l.return)&&(yield M(i.call(l)))}finally{if(r)throw r.error}}})}function*po(n,e){if(e<0)throw new ge(`Limit must be \u2265 0. Got ${e}`);let t=0;for(let r of z(n)){if(t>=e)return;yield r,++t}}function mo(n,e){return Fe(this,arguments,function*(){var r,i,o,s;if(e<0)throw new ge(`Limit must be \u2265 0. Got ${e}`);let a=0;try{for(var l=!0,c=Me(R(n)),f;f=yield M(c.next()),r=f.done,!r;){s=f.value,l=!1;try{let h=s;if(a>=e)return yield M(void 0);yield yield M(h),++a}finally{l=!0}}}catch(h){i={error:h}}finally{try{!l&&!r&&(o=c.return)&&(yield M(o.call(c)))}finally{if(i)throw i.error}}})}function*Ot(n){let e=0;for(let t of z(n))yield[e++,t]}function yo(n){return Fe(this,arguments,function*(){var t,r,i,o;let s=0;try{for(var a=!0,l=Me(R(n)),c;c=yield M(l.next()),t=c.done,!t;){o=c.value,a=!1;try{let f=o;yield yield M([s++,f])}finally{a=!0}}}catch(f){r={error:f}}finally{try{!a&&!t&&(i=l.return)&&(yield M(i.call(l)))}finally{if(r)throw r.error}}})}function*go(n,e=0,t,r=1){if(e<0)throw new ge("Parameter 'start' cannot be negative");if(t!==void 0&&t<0)throw new ge("Parameter 'count' cannot be negative");if(r<=0)throw new ge("Parameter 'step' must be positive");let i=0,o=0;for(let s of z(n))if(!(i++<e||(i-e-1)%r!==0)){if(o++===t&&t!==void 0)break;yield s}}function _o(n,e=0,t,r=1){return Fe(this,arguments,function*(){var o,s,a,l;if(e<0)throw new ge("Parameter 'start' cannot be negative");if(t!==void 0&&t<0)throw new ge("Parameter 'count' cannot be negative");if(r<=0)throw new ge("Parameter 'step' must be positive");let c=0,f=0;try{for(var h=!0,d=Me(R(n)),_;_=yield M(d.next()),o=_.done,!o;){l=_.value,h=!1;try{let y=l;if(c++<e||(c-e-1)%r!==0)continue;if(f++===t&&t!==void 0)break;yield yield M(y)}finally{h=!0}}}catch(y){s={error:y}}finally{try{!h&&!o&&(a=d.return)&&(yield M(a.call(d)))}finally{if(s)throw s.error}}})}function*vo(n){for(let[e]of z(n))yield e}function bo(n){return Fe(this,arguments,function*(){var t,r,i,o;try{for(var s=!0,a=Me(R(n)),l;l=yield M(a.next()),t=l.done,!t;){o=l.value,s=!1;try{let[c]=o;yield yield M(c)}finally{s=!0}}}catch(c){r={error:c}}finally{try{!s&&!t&&(i=a.return)&&(yield M(i.call(a)))}finally{if(r)throw r.error}}})}function*wo(n,e,t=0){if(e<0||t<0)throw new ge;let r=-t;for(let i of z(n))(r<0||r>=e)&&(yield i),++r}function xo(n,e,t=0){return Fe(this,arguments,function*(){var i,o,s,a;if(e<0||t<0)throw new ge;let l=-t;try{for(var c=!0,f=Me(R(n)),h;h=yield M(f.next()),i=h.done,!i;){a=h.value,c=!1;try{let d=a;(l<0||l>=e)&&(yield yield M(d)),++l}finally{c=!0}}}catch(d){o={error:d}}finally{try{!c&&!i&&(s=f.return)&&(yield M(s.call(f)))}finally{if(o)throw o.error}}})}function*ko(n){for(let[,e]of z(n))yield e}function Eo(n){return Fe(this,arguments,function*(){var t,r,i,o;try{for(var s=!0,a=Me(R(n)),l;l=yield M(a.next()),t=l.done,!t;){o=l.value,s=!1;try{let[,c]=o;yield yield M(c)}finally{s=!0}}}catch(c){r={error:c}}finally{try{!s&&!t&&(i=a.return)&&(yield M(i.call(a)))}finally{if(r)throw r.error}}})}function*Mo(n,e,t){let r=new Map,i=o=>{r.has(o)||(t!==void 0?r.set(o,{}):r.set(o,[]))};for(let o of z(n)){let s=e(o),a=t!==void 0?t(o):void 0,l=(Ke(s)||ut(s))&&!bt(s)?s:[s];for(let c of $t(l))i(c),a===void 0?r.get(c).push(o):r.get(c)[a]=o}for(let o of r)yield o}function Ao(n,e,t){return Fe(this,arguments,function*(){var i,o,s,a,l,c,f,h;let d=new Map,_=U=>{d.has(U)||(t!==void 0?d.set(U,{}):d.set(U,[]))};try{for(var y=!0,k=Me(R(n)),W;W=yield M(k.next()),i=W.done,!i;){a=W.value,y=!1;try{let U=a,se=yield M(e(U)),me=t!==void 0?yield M(t(U)):void 0,g=(Tt(se)||Ke(se)||ut(se))&&!bt(se)?se:[se];try{for(var J=!0,Z=(c=void 0,Me(Pn(g))),re;re=yield M(Z.next()),l=re.done,!l;){h=re.value,J=!1;try{let b=h;_(b),me===void 0?d.get(b).push(U):d.get(b)[me]=U}finally{J=!0}}}catch(b){c={error:b}}finally{try{!J&&!l&&(f=Z.return)&&(yield M(f.call(Z)))}finally{if(c)throw c.error}}}finally{y=!0}}}catch(U){o={error:U}}finally{try{!y&&!i&&(s=k.return)&&(yield M(s.call(k)))}finally{if(o)throw o.error}}for(let U of d)yield yield M(U)})}function*So(n,e){let t=Ft(n);e!==void 0?t.sort(e):t.sort();for(let r of t)yield r}function Io(n,e){return Fe(this,arguments,function*(){let r=yield M(mt(n));e!==void 0?r.sort(e):r.sort();for(let i of r)yield yield M(i)})}var Ha=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}},Bt=function(n){return this instanceof Bt?(this.v=n,this):new Bt(n)},Bu=function(n){var e,t;return e={},r("next"),r("throw",function(i){throw i}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(i,o){e[i]=n[i]?function(s){return(t=!t)?{value:Bt(n[i](s)),done:i==="return"}:o?o(s):s}:o}},Ju=function(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(d){r[d]&&(i[d]=function(_){return new Promise(function(y,k){o.push([d,_,y,k])>1||a(d,_)})})}function a(d,_){try{l(r[d](_))}catch(y){h(o[0][3],y)}}function l(d){d.value instanceof Bt?Promise.resolve(d.value.v).then(c,f):h(o[0][2],d)}function c(d){a("next",d)}function f(d){a("throw",d)}function h(d,_){d(_),o.shift(),o.length&&a(o[0][0],o[0][1])}};function*Va(n=1,e=1){for(let t=n;;t+=e)yield t}function*zs(n){let e=[...z(n)];if(e.length!==0)for(;;)for(let t of e)yield t}function Ya(n){return Ju(this,arguments,function*(){var t,r,i,o;let s=[];try{for(var a=!0,l=Ha(R(n)),c;c=yield Bt(l.next()),t=c.done,!t;){o=c.value,a=!1;try{let f=o;s.push(f),yield yield Bt(f)}finally{a=!0}}}catch(f){r={error:f}}finally{try{!a&&!t&&(i=l.return)&&(yield Bt(i.call(l)))}finally{if(r)throw r.error}}yield Bt(yield*Bu(Ha(zs(s))))})}function*Qa(n){for(;;)yield n}var Ln=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}},_e=function(n){return this instanceof _e?(this.v=n,this):new _e(n)},Rn=function(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(d){r[d]&&(i[d]=function(_){return new Promise(function(y,k){o.push([d,_,y,k])>1||a(d,_)})})}function a(d,_){try{l(r[d](_))}catch(y){h(o[0][3],y)}}function l(d){d.value instanceof _e?Promise.resolve(d.value.v).then(c,f):h(o[0][2],d)}function c(d){a("next",d)}function f(d){a("throw",d)}function h(d,_){d(_),o.shift(),o.length&&a(o[0][0],o[0][1])}};function*Po(n,e){let t=0;for(let r of cr(z(n),e))t++,yield r/t}function To(n,e){return Rn(this,arguments,function*(){var r,i,o,s;let a=0;try{for(var l=!0,c=Ln(fr(R(n),e)),f;f=yield _e(c.next()),r=f.done,!r;){s=f.value,l=!1;try{let h=s;a++,yield yield _e(h/a)}finally{l=!0}}}catch(h){i={error:h}}finally{try{!l&&!r&&(o=c.return)&&(yield _e(o.call(c)))}finally{if(i)throw i.error}}})}function*Co(n,e){e!==void 0&&(yield e);let t=e!=null?e:0;for(let r of z(n))t-=Number(r),yield t}function Fo(n,e){return Rn(this,arguments,function*(){var r,i,o,s;e!==void 0&&(yield yield _e(e));let a=e!=null?e:0;try{for(var l=!0,c=Ln(R(n)),f;f=yield _e(c.next()),r=f.done,!r;){s=f.value,l=!1;try{a-=Number(s),yield yield _e(a)}finally{l=!0}}}catch(h){i={error:h}}finally{try{!l&&!r&&(o=c.return)&&(yield _e(o.call(c)))}finally{if(i)throw i.error}}})}function*Oo(n,e){e!==void 0&&(yield e);let t=e!=null?e:-1/0;for(let r of z(n))t=Math.max(t,r),yield t}function Lo(n,e){return Rn(this,arguments,function*(){var r,i,o,s;e!==void 0&&(yield yield _e(e));let a=e!=null?e:-1/0;try{for(var l=!0,c=Ln(R(n)),f;f=yield _e(c.next()),r=f.done,!r;){s=f.value,l=!1;try{a=Math.max(a,s),yield yield _e(a)}finally{l=!0}}}catch(h){i={error:h}}finally{try{!l&&!r&&(o=c.return)&&(yield _e(o.call(c)))}finally{if(i)throw i.error}}})}function*Ro(n,e){e!==void 0&&(yield e);let t=e!=null?e:1/0;for(let r of z(n))t=Math.min(t,r),yield t}function Do(n,e){return Rn(this,arguments,function*(){var r,i,o,s;e!==void 0&&(yield yield _e(e));let a=e!=null?e:1/0;try{for(var l=!0,c=Ln(R(n)),f;f=yield _e(c.next()),r=f.done,!r;){s=f.value,l=!1;try{a=Math.min(a,s),yield yield _e(a)}finally{l=!0}}}catch(h){i={error:h}}finally{try{!l&&!r&&(o=c.return)&&(yield _e(o.call(c)))}finally{if(i)throw i.error}}})}function*No(n,e){e!==void 0&&(yield e);let t=e!=null?e:1;for(let r of z(n))t*=Number(r),yield t}function qo(n,e){return Rn(this,arguments,function*(){var r,i,o,s;e!==void 0&&(yield yield _e(e));let a=e!=null?e:1;try{for(var l=!0,c=Ln(R(n)),f;f=yield _e(c.next()),r=f.done,!r;){s=f.value,l=!1;try{a*=Number(s),yield yield _e(a)}finally{l=!0}}}catch(h){i={error:h}}finally{try{!l&&!r&&(o=c.return)&&(yield _e(o.call(c)))}finally{if(i)throw i.error}}})}function*cr(n,e){e!==void 0&&(yield e);let t=e!=null?e:0;for(let r of z(n))t+=Number(r),yield t}function fr(n,e){return Rn(this,arguments,function*(){var r,i,o,s;e!==void 0&&(yield yield _e(e));let a=e!=null?e:0;try{for(var l=!0,c=Ln(R(n)),f;f=yield _e(c.next()),r=f.done,!r;){s=f.value,l=!1;try{a+=Number(s),yield yield _e(a)}finally{l=!0}}}catch(h){i={error:h}}finally{try{!l&&!r&&(o=c.return)&&(yield _e(o.call(c)))}finally{if(i)throw i.error}}})}var qt=class n{static of(e){return new n(z(e))}static ofEmpty(){return new n([])}static ofCount(e=1,t=1){return new n(Lt.count(e,t))}static ofCycle(e){return new n(Lt.cycle(e))}static ofRepeat(e){return new n(Lt.repeat(e))}zipWith(...e){return this.data=bn(this.data,...e),this}zipFilledWith(e,...t){return this.data=$r(e,this.data,...t),this}zipLongestWith(...e){return this.data=ti(this.data,...e),this}zipEqualWith(...e){return this.data=xn(this.data,...e),this}chainWith(...e){return this.data=ri(this.data,...e),this}chunkwiseOverlap(e,t,r=!0){return this.data=Fn(this.data,e,t,r),this}chunkwise(e){return this.data=fo(this.data,e),this}compress(e){return this.data=to(this.data,e),this}dropWhile(e){return this.data=ro(this.data,e),this}filter(e){return this.data=uo(this.data,e),this}enumerate(){return this.data=Ot(this.data),this}keys(){return this.data=vo(this.data),this}limit(e){return this.data=po(this.data,e),this}map(e){return this.data=Wt(this.data,e),this}flatMap(e){return this.data=ao(this.data,e),this}flatten(e=1/0){return this.data=lr(this.data,e),this}groupBy(e,t){return this.data=Mo(this.data,e,t),this}pairwise(){return this.data=Ct(this.data),this}runningAverage(e){return this.data=Po(this.data,e),this}runningDifference(e){return this.data=Co(this.data,e),this}runningMax(e){return this.data=Oo(this.data,e),this}runningMin(e){return this.data=Ro(this.data,e),this}runningProduct(e){return this.data=No(this.data,e),this}runningTotal(e){return this.data=cr(this.data,e),this}skip(e,t=0){return this.data=wo(this.data,e,t),this}slice(e=0,t,r=1){return this.data=go(this.data,e,t,r),this}takeWhile(e){return this.data=oo(this.data,e),this}values(){return this.data=ko(this.data),this}sort(e){return this.data=So(this.data,e),this}distinct(e){return this.data=$t(this.data,e),this}intersectionWith(...e){return this.data=Vi(this.data,...e),this}partialIntersectionWith(e,...t){return this.data=Tn(e,this.data,...t),this}symmetricDifferenceWith(...e){return this.data=Qi(this.data,...e),this}unionWith(...e){return this.data=Zi(this.data,...e),this}cartesianProductWith(...e){return this.data=$i(this.data,...e),this}peek(e){let[t,r]=Mn(this.data,2);this.data=t;for(let i of r)e(i);return this}peekStream(e){let[t,r]=Mn(this.data,2);return this.data=t,e(n.of(r)),this}toValue(e,t){return tt(this,e,t)}toAverage(){return si(this)}toCount(){return Zt(this)}toMax(e){return li(this,e)}toMin(e){return ci(this,e)}toMinMax(e){return sr(this,e)}toFirst(){return _i(this)}toFirstAndLast(){return xi(this)}toLast(){return bi(this)}toSum(){return pi(this)}toProduct(){return yi(this)}toRange(){return di(this)}allMatch(e){return Ei(this,e)}allUnique(){return Ai(this)}anyMatch(e){return Ii(this,e)}exactlyN(e,t){return Ti(this,e,t)}isSorted(){return Li(this)}isReversed(){return Fi(this)}noneMatch(e){return Di(this,e)}sameWith(...e){return qi(this.data,...e)}sameCountWith(...e){return zi(this.data,...e)}tee(e){return Mn(this.data,e).map(t=>new n(t))}toArray(){return Ft(this)}toMap(){return Ji(this)}toSet(){return Gi(this)}*[Symbol.iterator](){for(let e of this.data)yield e}constructor(e){this.data=e}};var be=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(f){try{c(r.next(f))}catch(h){s(h)}}function l(f){try{c(r.throw(f))}catch(h){s(h)}}function c(f){f.done?o(f.value):i(f.value).then(a,l)}c((r=r.apply(n,e||[])).next())})},Xa=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}},Dn=function(n){return this instanceof Dn?(this.v=n,this):new Dn(n)},Uu=function(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(d){r[d]&&(i[d]=function(_){return new Promise(function(y,k){o.push([d,_,y,k])>1||a(d,_)})})}function a(d,_){try{l(r[d](_))}catch(y){h(o[0][3],y)}}function l(d){d.value instanceof Dn?Promise.resolve(d.value.v).then(c,f):h(o[0][2],d)}function c(d){a("next",d)}function f(d){a("throw",d)}function h(d,_){d(_),o.shift(),o.length&&a(o[0][0],o[0][1])}},jo=class n{static of(e){return new n(R(e))}static ofEmpty(){return new n(R([]))}static ofCount(e=1,t=1){return new n(R(Lt.count(e,t)))}static ofCycle(e){return new n(Lt.cycleAsync(e))}static ofRepeat(e){return new n(R(Lt.repeat(e)))}zipWith(...e){return this.data=wn(this.data,...e),this}zipFilledWith(e,...t){return this.data=ei(e,this.data,...t),this}zipLongestWith(...e){return this.data=ni(this.data,...e),this}zipEqualWith(...e){return this.data=kn(this.data,...e),this}chainWith(...e){return this.data=ii(this.data,...e),this}chunkwiseOverlap(e,t,r=!0){return this.data=On(this.data,e,t,r),this}chunkwise(e){return this.data=ho(this.data,e),this}compress(e){return this.data=no(this.data,e),this}dropWhile(e){return this.data=io(this.data,e),this}filter(e){return this.data=co(this.data,e),this}enumerate(){return this.data=yo(this.data),this}keys(){return this.data=bo(this.data),this}limit(e){return this.data=mo(this.data,e),this}map(e){return this.data=wt(this.data,e),this}flatMap(e){return this.data=lo(this.data,e),this}flatten(e=1/0){return this.data=ur(this.data,e),this}groupBy(e,t){return this.data=Ao(this.data,e,t),this}pairwise(){return this.data=Kt(this.data),this}runningAverage(e){return this.data=To(this.data,e),this}runningDifference(e){return this.data=Fo(this.data,e),this}runningMax(e){return this.data=Lo(this.data,e),this}runningMin(e){return this.data=Do(this.data,e),this}runningProduct(e){return this.data=qo(this.data,e),this}runningTotal(e){return this.data=fr(this.data,e),this}skip(e,t=0){return this.data=xo(this.data,e,t),this}slice(e=0,t,r=1){return this.data=_o(this.data,e,t,r),this}takeWhile(e){return this.data=so(this.data,e),this}values(){return this.data=Eo(this.data),this}sort(e){return this.data=Io(this.data,e),this}distinct(e){return this.data=Pn(this.data,e),this}intersectionWith(...e){return this.data=Yi(this.data,...e),this}partialIntersectionWith(e,...t){return this.data=Cn(e,this.data,...t),this}symmetricDifferenceWith(...e){return this.data=Xi(this.data,...e),this}unionWith(...e){return this.data=Ki(this.data,...e),this}cartesianProductWith(...e){return this.data=eo(this.data,...e),this}peek(e){let[t,r]=An(this.data,2);return this.data=t,be(this,void 0,void 0,function*(){var i,o,s,a;try{for(var l=!0,c=Xa(r),f;f=yield c.next(),i=f.done,!i;){a=f.value,l=!1;try{e(a)}finally{l=!0}}}catch(h){o={error:h}}finally{try{!l&&!i&&(s=c.return)&&(yield s.call(c))}finally{if(o)throw o.error}}}),this}peekStream(e){let[t,r]=An(this.data,2);return this.data=t,e(n.of(r)),this}toValue(e,t){return be(this,void 0,void 0,function*(){return yield nt(this,e,t)})}toAverage(){return be(this,void 0,void 0,function*(){return yield ai(this)})}toCount(){return be(this,void 0,void 0,function*(){return yield En(this)})}toMax(e){return be(this,void 0,void 0,function*(){return yield ui(this,e)})}toMin(e){return be(this,void 0,void 0,function*(){return yield fi(this,e)})}toMinMax(e){return be(this,void 0,void 0,function*(){return yield ar(this,e)})}toFirst(){return be(this,void 0,void 0,function*(){return yield vi(this)})}toFirstAndLast(){return be(this,void 0,void 0,function*(){return yield ki(this)})}toLast(){return be(this,void 0,void 0,function*(){return yield wi(this)})}toSum(){return be(this,void 0,void 0,function*(){return yield mi(this)})}toProduct(){return be(this,void 0,void 0,function*(){return yield gi(this)})}toRange(){return be(this,void 0,void 0,function*(){return yield hi(this)})}allMatch(e){return be(this,void 0,void 0,function*(){return yield Mi(this,e)})}allUnique(){return be(this,void 0,void 0,function*(){return yield Si(this)})}anyMatch(e){return be(this,void 0,void 0,function*(){return yield Pi(this,e)})}exactlyNAsync(e,t){return be(this,void 0,void 0,function*(){return Ci(this,e,t)})}isSorted(){return be(this,void 0,void 0,function*(){return yield Ri(this)})}isReversed(){return be(this,void 0,void 0,function*(){return yield Oi(this)})}noneMatch(e){return be(this,void 0,void 0,function*(){return yield Ni(this,e)})}sameWith(...e){return be(this,void 0,void 0,function*(){return yield ji(this.data,...e)})}sameCountWith(...e){return be(this,void 0,void 0,function*(){return yield Wi(this.data,...e)})}tee(e){return An(this.data,e).map(t=>new n(t))}toArray(){return be(this,void 0,void 0,function*(){return yield mt(this)})}toMap(){return be(this,void 0,void 0,function*(){return yield Ui(this)})}toSet(){return be(this,void 0,void 0,function*(){return yield Hi(this)})}[Symbol.asyncIterator](){return Uu(this,arguments,function*(){var t,r,i,o;try{for(var s=!0,a=Xa(this.data),l;l=yield Dn(a.next()),t=l.done,!t;){o=l.value,s=!1;try{yield yield Dn(o)}finally{s=!0}}}catch(c){r={error:c}}finally{try{!s&&!t&&(i=a.return)&&(yield Dn(i.call(a)))}finally{if(r)throw r.error}}})}constructor(e){this.data=e}};var vn={chunkwise:fo,chunkwiseOverlap:Fn,compress:to,dropWhile:ro,enumerate:Ot,filter:uo,flatMap:ao,flatten:lr,groupBy:Mo,keys:vo,limit:po,map:Wt,pairwise:Ct,repeat:Ua,skip:wo,slice:go,sort:So,takeWhile:oo,values:ko,chunkwiseAsync:ho,chunkwiseOverlapAsync:On,compressAsync:no,dropWhileAsync:io,enumerateAsync:yo,filterAsync:co,flatMapAsync:lo,flattenAsync:ur,groupByAsync:Ao,keysAsync:bo,limitAsync:mo,mapAsync:wt,pairwiseAsync:Kt,repeatAsync:Ga,skipAsync:xo,sliceAsync:_o,sortAsync:Io,takeWhileAsync:so,valuesAsync:Eo},Lt={count:Va,cycle:zs,cycleAsync:Ya,repeat:Qa},Gu={runningAverage:Po,runningDifference:Co,runningMax:Oo,runningMin:Ro,runningProduct:No,runningTotal:cr,runningAverageAsync:To,runningDifferenceAsync:Fo,runningMaxAsync:Lo,runningMinAsync:Do,runningProductAsync:qo,runningTotalAsync:fr},Hu={chain:ri,zip:bn,zipFilled:$r,zipLongest:ti,zipEqual:xn,chainAsync:ii,zipAsync:wn,zipFilledAsync:ei,zipLongestAsync:ni,zipEqualAsync:kn},Vu={distinct:$t,intersection:Vi,partialIntersection:Tn,symmetricDifference:Qi,union:Zi,cartesianProduct:$i,distinctAsync:Pn,intersectionAsync:Yi,partialIntersectionAsync:Cn,symmetricDifferenceAsync:Xi,unionAsync:Ki,cartesianProductAsync:eo},Kr={toAverage:si,toCount:Zt,toFirst:_i,toFirstAndLast:xi,toLast:bi,toMax:li,toMin:ci,toMinMax:sr,toProduct:yi,toRange:di,toSum:pi,toValue:tt,toAverageAsync:ai,toCountAsync:En,toFirstAsync:vi,toFirstAndLastAsync:ki,toLastAsync:wi,toMaxAsync:ui,toMinAsync:fi,toMinMaxAsync:ar,toProductAsync:gi,toRangeAsync:hi,toSumAsync:mi,toValueAsync:nt},Yu={allMatch:Ei,allUnique:Ai,anyMatch:Ii,exactlyN:Ti,isEmpty:Wa,isAsyncIterable:Tt,isIterable:Ke,isIterator:ut,isReversed:Fi,isSorted:Li,isString:bt,noneMatch:Di,same:qi,sameCount:zi,allMatchAsync:Mi,allUniqueAsync:Si,anyMatchAsync:Pi,exactlyNAsync:Ci,isEmptyAsync:Ba,isReversedAsync:Oi,isSortedAsync:Ri,noneMatchAsync:Ni,sameAsync:ji,sameCountAsync:Wi},Qu={tee:Mn,toArray:Ft,toAsyncIterable:R,toAsyncIterator:rr,toIterable:z,toIterator:nr,toMap:Ji,toSet:Gi,teeAsync:An,toArrayAsync:mt,toMapAsync:Ui,toSetAsync:Hi};var zo=class{constructor(e){this.apiInstance=e}parsinom(){return{P:Za.P,P_UTILS:Ka.P_UTILS,Parser:$a.Parser,createParsingErrorMessage:Wo.createParsingErrorMessage,ParsingError:Wo.ParsingError,ParserContext:el.ParserContext}}itertools(){return Ws}};var dr=require("obsidian");var Bo=class{constructor(e){this.apiInstance=e}async execute(e){return await this.apiInstance.plugin.jsEngine.execute(e)}createRenderer(e,t,r){return new yn(this.apiInstance.plugin,e,t,r)}async executeFile(e,t){let r=this.apiInstance.app.vault.getAbstractFileByPath(e);if(!r||!(r instanceof dr.TFile))throw new Error(`File ${e} not found.`);let i=t;return i.code=await this.apiInstance.app.vault.read(r),await this.execute(i)}async executeFileSimple(e,t){let r=new dr.Component;r.load();try{return await this.executeFile(e,{component:r,...t})}finally{r.unload()}}async getContextForFile(e){let t=this.apiInstance.app.vault.getAbstractFileByPath(e);if(!t||!(t instanceof dr.TFile))throw new Error(`File ${e} not found.`);let r=this.apiInstance.app.metadataCache.getFileCache(t);return{file:t,metadata:r,block:void 0}}};var Nn=class{constructor(e,t,r){this.app=e,this.plugin=t,this.instanceId=r,this.markdown=new jr(this),this.message=new zr(this),this.lib=new zo(this),this.internal=new Bo(this)}async importJs(e){let t=this.app.vault.adapter.getResourcePath(e);if(!t.includes("?")){let r=this.app.metadataCache.getFirstLinkpathDest(e,"");r&&(t+="?"+r.stat.mtime)}return import(t)}getPlugin(e){return this.app.plugins.getPlugin(e)}reactive(e,...t){return new mn(e,t)}};var qn=class n{constructor(e,t){this.name=e,this.id=t}static create(e){return new n(e,self.crypto.randomUUID())}};var Zu=Ht(require("obsidian")),Ku=async function(){}.constructor,Jo=class{constructor(e){this.app=e.app,this.plugin=e.plugin,this.code=e.code,this.context=Object.assign({},e.context,e.contextOverrides),this.uuid=self.crypto.randomUUID(),this.apiInstance=new Nn(this.app,this.plugin,new qn("JS_EXECUTION",this.uuid)),this.messages=[],this.func=void 0,this.globals={app:this.app,engine:this.apiInstance,context:this.context,component:e.component,container:e.container,obsidian:Zu}}buildFunction(){var t;let e=performance.now();try{this.func=Ku(...Object.keys(this.globals),this.code)}catch(r){r instanceof Error&&(this.functionBuildError=r,this.result=(t=this.plugin.api)==null?void 0:t.message.createMessage("error","Failed to parse JS",`Failed to parse JS during execution "${this.uuid}"`,r.stack))}this.functionBuildTime=performance.now()-e}async runFunction(){if(this.functionBuildError)throw new Error("can not run function, function construction failed");if(!this.func)throw new Error("can not run function, function has not been constructed yet");let e=performance.now();try{this.result=await Promise.resolve(this.func(...Object.values(this.globals)))}catch(t){console.warn("failed to execute JS",t),t instanceof Error&&(this.functionRunError=t,this.result=this.apiInstance.message.createMessage("error","Failed to execute JS",`Failed to execute JS during execution "${this.uuid}"`,t.stack))}this.messages=this.apiInstance.message.getMessagesForInstance(),this.functionRunTime=performance.now()-e}isSuccessful(){return!this.functionBuildError&&!this.functionRunError}getMessages(){return this.messages}openStatsModal(){this.plugin.jsEngine.openExecutionStatsModal(this)}};var ll=require("obsidian");function tl(n,e,t){let r=n.slice();return r[2]=e[t],r}function nl(n,e,t){let r=n.slice();return r[5]=e[t],r}function rl(n){let e;return{c(){e=A("tr"),e.innerHTML="<td>none</td> <td>-</td> "},m(t,r){N(t,e,r)},p:ae,d(t){t&&L(e)}}}function il(n,e){let t,r,i=e[5][0]+"",o,s,a,l=typeof e[5][1],c,f;return{key:n,first:null,c(){t=A("tr"),r=A("td"),o=ne(i),s=ee(),a=A("td"),c=ne(l),f=ee(),this.first=t},m(h,d){N(h,t,d),E(t,r),E(r,o),E(t,s),E(t,a),E(a,c),E(t,f)},p(h,d){e=h,d&1&&i!==(i=e[5][0]+"")&&Ee(o,i),d&1&&l!==(l=typeof e[5][1])&&Ee(c,l)},d(h){h&&L(t)}}}function ol(n){let e;return{c(){e=A("p"),e.textContent="None"},m(t,r){N(t,e,r)},p:ae,d(t){t&&L(e)}}}function sl(n){let e,t;return e=new hn({props:{messageWrapper:n[2],messageManager:n[0].plugin.messageManager,showDeleteButton:!1,showMessageSource:!1}}),{c(){Qe(e.$$.fragment)},m(r,i){Ge(e,r,i),t=!0},p(r,i){let o={};i&1&&(o.messageManager=r[0].plugin.messageManager),e.$set(o)},i(r){t||(V(e.$$.fragment,r),t=!0)},o(r){K(e.$$.fragment,r),t=!1},d(r){He(e,r)}}}function $u(n){var jn,pr;let e,t,r,i,o,s=n[0].uuid+"",a,l,c,f,h,d,_=n[0].code+"",y,k,W,J,Z,re,U=Math.round((jn=n[0].functionBuildTime)!=null?jn:0)+"",se,me,g,b,m,ie=Math.round((pr=n[0].functionRunTime)!=null?pr:0)+"",ce,F,x,w,I,T,D,B,Y,C,P=[],j=new Map,te,rt,$,ye,Ae,ve=st(Object.entries(n[0].globals)),Oe=G=>G[5][0];for(let G=0;G<ve.length;G+=1){let ue=nl(n,ve,G),Ne=Oe(ue);j.set(Ne,P[G]=il(Ne,ue))}let le=null;ve.length||(le=rl(n));let ke=st(n[1]),pe=[];for(let G=0;G<ke.length;G+=1)pe[G]=sl(tl(n,ke,G));let Xo=G=>K(pe[G],1,1,()=>{pe[G]=null}),Le=null;return ke.length||(Le=ol(n)),{c(){e=A("div"),t=A("h2"),t.textContent="JS Execution Stats",r=ee(),i=A("p"),o=ne("Execution ID: "),a=ne(s),l=ee(),c=A("h3"),c.textContent="Code",f=ee(),h=A("pre"),d=A("code"),y=ne(_),k=ee(),W=A("h3"),W.textContent="Time",J=ee(),Z=A("p"),re=ne("Build Time: "),se=ne(U),me=ne(" ms"),g=ee(),b=A("p"),m=ne("Execution Time: "),ce=ne(ie),F=ne(" ms"),x=ee(),w=A("h3"),w.textContent="Arguments",I=ee(),T=A("div"),D=A("table"),B=A("thead"),B.innerHTML="<tr><th>Argument Name</th> <th>Value Type</th></tr>",Y=ee(),C=A("tbody");for(let G=0;G<P.length;G+=1)P[G].c();le&&le.c(),te=ee(),rt=A("h3"),rt.textContent="Messages",$=ee(),ye=A("div");for(let G=0;G<pe.length;G+=1)pe[G].c();Le&&Le.c(),q(h,"class","language-none"),q(T,"class","markdown-rendered")},m(G,ue){N(G,e,ue),E(e,t),E(e,r),E(e,i),E(i,o),E(i,a),E(e,l),E(e,c),E(e,f),E(e,h),E(h,d),E(d,y),E(e,k),E(e,W),E(e,J),E(e,Z),E(Z,re),E(Z,se),E(Z,me),E(e,g),E(e,b),E(b,m),E(b,ce),E(b,F),E(e,x),E(e,w),E(e,I),E(e,T),E(T,D),E(D,B),E(D,Y),E(D,C);for(let Ne=0;Ne<P.length;Ne+=1)P[Ne]&&P[Ne].m(C,null);le&&le.m(C,null),E(e,te),E(e,rt),E(e,$),E(e,ye);for(let Ne=0;Ne<pe.length;Ne+=1)pe[Ne]&&pe[Ne].m(ye,null);Le&&Le.m(ye,null),Ae=!0},p(G,[ue]){var Ne,mr;if((!Ae||ue&1)&&s!==(s=G[0].uuid+"")&&Ee(a,s),(!Ae||ue&1)&&_!==(_=G[0].code+"")&&Ee(y,_),(!Ae||ue&1)&&U!==(U=Math.round((Ne=G[0].functionBuildTime)!=null?Ne:0)+"")&&Ee(se,U),(!Ae||ue&1)&&ie!==(ie=Math.round((mr=G[0].functionRunTime)!=null?mr:0)+"")&&Ee(ce,ie),ue&1&&(ve=st(Object.entries(G[0].globals)),P=ga(P,ue,Oe,1,G,ve,j,C,ya,il,null,nl),!ve.length&&le?le.p(G,ue):ve.length?le&&(le.d(1),le=null):(le=rl(G),le.c(),le.m(C,null))),ue&3){ke=st(G[1]);let Se;for(Se=0;Se<ke.length;Se+=1){let yr=tl(G,ke,Se);pe[Se]?(pe[Se].p(yr,ue),V(pe[Se],1)):(pe[Se]=sl(yr),pe[Se].c(),V(pe[Se],1),pe[Se].m(ye,null))}for(dt(),Se=ke.length;Se<pe.length;Se+=1)Xo(Se);ht(),!ke.length&&Le?Le.p(G,ue):ke.length?Le&&(Le.d(1),Le=null):(Le=ol(G),Le.c(),Le.m(ye,null))}},i(G){if(!Ae){for(let ue=0;ue<ke.length;ue+=1)V(pe[ue]);Ae=!0}},o(G){pe=pe.filter(Boolean);for(let ue=0;ue<pe.length;ue+=1)K(pe[ue]);Ae=!1},d(G){G&&L(e);for(let ue=0;ue<P.length;ue+=1)P[ue].d();le&&le.d(),an(pe,G),Le&&Le.d()}}}function ec(n,e,t){let{execution:r}=e,i=r.getMessages();return n.$$set=o=>{"execution"in o&&t(0,r=o.execution)},[r,i]}var Bs=class extends H{constructor(e){super(),X(this,e,ec,$u,Q,{execution:0})}},al=Bs;var Uo=class extends ll.Modal{constructor(t,r){super(t);this.plugin=r}setExecution(t){this.execution=t}onOpen(){this.contentEl.empty(),this.component&&this.component.$destroy(),this.contentEl.hasClass("js-engine-execution-stats-modal")||this.contentEl.addClass("js-engine-execution-stats-modal"),this.component=new al({target:this.contentEl,props:{execution:this.execution}})}onClose(){this.contentEl.empty(),this.component&&this.component.$destroy()}};var Go=class{constructor(e,t){this.app=e,this.plugin=t,this.executionStatsModal=new Uo(this.app,this.plugin),this.activeExecutions=new Map}async execute(e){let t=new Jo({app:this.app,plugin:this.plugin,...e});return this.activeExecutions.set(t.uuid,t),t.buildFunction(),t.functionBuildError||await t.runFunction(),this.activeExecutions.delete(t.uuid),t}openExecutionStatsModal(e){this.executionStatsModal.setExecution(e),this.executionStatsModal.open()}};function Ho(n){var e=n.statementIndent,t=n.jsonld,r=n.json||t,i=n.typescript,o=n.wordCharacters||/[\w$\xa1-\uffff]/,s=function(){function u($e){return{type:$e,style:"keyword"}}var p=u("keyword a"),v=u("keyword b"),S=u("keyword c"),O=u("keyword d"),oe=u("operator"),de={type:"atom",style:"atom"};return{if:u("if"),while:p,with:p,else:v,do:v,try:v,finally:v,return:O,break:O,continue:O,new:u("new"),delete:S,void:S,throw:S,debugger:u("debugger"),var:u("var"),const:u("var"),let:u("var"),function:u("function"),catch:u("catch"),for:u("for"),switch:u("switch"),case:u("case"),default:u("default"),in:oe,typeof:oe,instanceof:oe,true:de,false:de,null:de,undefined:de,NaN:de,Infinity:de,this:u("this"),class:u("class"),super:u("atom"),yield:S,export:u("export"),import:u("import"),extends:S,await:S}}(),a=/[+\-*&%=<>!?|~^@]/,l=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function c(u){for(var p=!1,v,S=!1;(v=u.next())!=null;){if(!p){if(v=="/"&&!S)return;v=="["?S=!0:S&&v=="]"&&(S=!1)}p=!p&&v=="\\"}}var f,h;function d(u,p,v){return f=u,h=v,p}function _(u,p){var v=u.next();if(v=='"'||v=="'")return p.tokenize=y(v),p.tokenize(u,p);if(v=="."&&u.match(/^\d[\d_]*(?:[eE][+\-]?[\d_]+)?/))return d("number","number");if(v=="."&&u.match(".."))return d("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(v))return d(v);if(v=="="&&u.eat(">"))return d("=>","operator");if(v=="0"&&u.match(/^(?:x[\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/))return d("number","number");if(/\d/.test(v))return u.match(/^[\d_]*(?:n|(?:\.[\d_]*)?(?:[eE][+\-]?[\d_]+)?)?/),d("number","number");if(v=="/")return u.eat("*")?(p.tokenize=k,k(u,p)):u.eat("/")?(u.skipToEnd(),d("comment","comment")):Al(u,p,1)?(c(u),u.match(/^\b(([gimyus])(?![gimyus]*\2))+\b/),d("regexp","string.special")):(u.eat("="),d("operator","operator",u.current()));if(v=="`")return p.tokenize=W,W(u,p);if(v=="#"&&u.peek()=="!")return u.skipToEnd(),d("meta","meta");if(v=="#"&&u.eatWhile(o))return d("variable","property");if(v=="<"&&u.match("!--")||v=="-"&&u.match("->")&&!/\S/.test(u.string.slice(0,u.start)))return u.skipToEnd(),d("comment","comment");if(a.test(v))return(v!=">"||!p.lexical||p.lexical.type!=">")&&(u.eat("=")?(v=="!"||v=="=")&&u.eat("="):/[<>*+\-|&?]/.test(v)&&(u.eat(v),v==">"&&u.eat(v))),v=="?"&&u.eat(".")?d("."):d("operator","operator",u.current());if(o.test(v)){u.eatWhile(o);var S=u.current();if(p.lastType!="."){if(s.propertyIsEnumerable(S)){var O=s[S];return d(O.type,O.style,S)}if(S=="async"&&u.match(/^(\s|\/\*([^*]|\*(?!\/))*?\*\/)*[\[\(\w]/,!1))return d("async","keyword",S)}return d("variable","variable",S)}}function y(u){return function(p,v){var S=!1,O;if(t&&p.peek()=="@"&&p.match(l))return v.tokenize=_,d("jsonld-keyword","meta");for(;(O=p.next())!=null&&!(O==u&&!S);)S=!S&&O=="\\";return S||(v.tokenize=_),d("string","string")}}function k(u,p){for(var v=!1,S;S=u.next();){if(S=="/"&&v){p.tokenize=_;break}v=S=="*"}return d("comment","comment")}function W(u,p){for(var v=!1,S;(S=u.next())!=null;){if(!v&&(S=="`"||S=="$"&&u.eat("{"))){p.tokenize=_;break}v=!v&&S=="\\"}return d("quasi","string.special",u.current())}var J="([{}])";function Z(u,p){p.fatArrowAt&&(p.fatArrowAt=null);var v=u.string.indexOf("=>",u.start);if(!(v<0)){if(i){var S=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(u.string.slice(u.start,v));S&&(v=S.index)}for(var O=0,oe=!1,de=v-1;de>=0;--de){var $e=u.string.charAt(de),it=J.indexOf($e);if(it>=0&&it<3){if(!O){++de;break}if(--O==0){$e=="("&&(oe=!0);break}}else if(it>=3&&it<6)++O;else if(o.test($e))oe=!0;else if(/["'\/`]/.test($e))for(;;--de){if(de==0)return;var Bn=u.string.charAt(de-1);if(Bn==$e&&u.string.charAt(de-2)!="\\"){de--;break}}else if(oe&&!O){++de;break}}oe&&!O&&(p.fatArrowAt=de)}}var re={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,import:!0,"jsonld-keyword":!0};function U(u,p,v,S,O,oe){this.indented=u,this.column=p,this.type=v,this.prev=O,this.info=oe,S!=null&&(this.align=S)}function se(u,p){for(var v=u.localVars;v;v=v.next)if(v.name==p)return!0;for(var S=u.context;S;S=S.prev)for(var v=S.vars;v;v=v.next)if(v.name==p)return!0}function me(u,p,v,S,O){var oe=u.cc;for(g.state=u,g.stream=O,g.marked=null,g.cc=oe,g.style=p,u.lexical.hasOwnProperty("align")||(u.lexical.align=!0);;){var de=oe.length?oe.pop():r?$:te;if(de(v,S)){for(;oe.length&&oe[oe.length-1].lex;)oe.pop()();return g.marked?g.marked:v=="variable"&&se(u,S)?"variableName.local":p}}}var g={state:null,column:null,marked:null,cc:null};function b(){for(var u=arguments.length-1;u>=0;u--)g.cc.push(arguments[u])}function m(){return b.apply(null,arguments),!0}function ie(u,p){for(var v=p;v;v=v.next)if(v.name==u)return!0;return!1}function ce(u){var p=g.state;if(g.marked="def",p.context){if(p.lexical.info=="var"&&p.context&&p.context.block){var v=F(u,p.context);if(v!=null){p.context=v;return}}else if(!ie(u,p.localVars)){p.localVars=new I(u,p.localVars);return}}n.globalVars&&!ie(u,p.globalVars)&&(p.globalVars=new I(u,p.globalVars))}function F(u,p){if(p)if(p.block){var v=F(u,p.prev);return v?v==p.prev?p:new w(v,p.vars,!0):null}else return ie(u,p.vars)?p:new w(p.prev,new I(u,p.vars),!1);else return null}function x(u){return u=="public"||u=="private"||u=="protected"||u=="abstract"||u=="readonly"}function w(u,p,v){this.prev=u,this.vars=p,this.block=v}function I(u,p){this.name=u,this.next=p}var T=new I("this",new I("arguments",null));function D(){g.state.context=new w(g.state.context,g.state.localVars,!1),g.state.localVars=T}function B(){g.state.context=new w(g.state.context,g.state.localVars,!0),g.state.localVars=null}D.lex=B.lex=!0;function Y(){g.state.localVars=g.state.context.vars,g.state.context=g.state.context.prev}Y.lex=!0;function C(u,p){var v=function(){var S=g.state,O=S.indented;if(S.lexical.type=="stat")O=S.lexical.indented;else for(var oe=S.lexical;oe&&oe.type==")"&&oe.align;oe=oe.prev)O=oe.indented;S.lexical=new U(O,g.stream.column(),u,null,S.lexical,p)};return v.lex=!0,v}function P(){var u=g.state;u.lexical.prev&&(u.lexical.type==")"&&(u.indented=u.lexical.indented),u.lexical=u.lexical.prev)}P.lex=!0;function j(u){function p(v){return v==u?m():u==";"||v=="}"||v==")"||v=="]"?b():m(p)}return p}function te(u,p){return u=="var"?m(C("vardef",p),es,j(";"),P):u=="keyword a"?m(C("form"),Ae,te,P):u=="keyword b"?m(C("form"),te,P):u=="keyword d"?g.stream.match(/^\s*$/,!1)?m():m(C("stat"),Oe,j(";"),P):u=="debugger"?m(j(";")):u=="{"?m(C("}"),B,gr,P,Y):u==";"?m():u=="if"?(g.state.lexical.info=="else"&&g.state.cc[g.state.cc.length-1]==P&&g.state.cc.pop()(),m(C("form"),Ae,te,P,Gs)):u=="function"?m(Dt):u=="for"?m(C("form"),B,Hs,te,Y,P):u=="class"||i&&p=="interface"?(g.marked="keyword",m(C("form",u=="class"?u:p),Ys,P)):u=="variable"?i&&p=="declare"?(g.marked="keyword",m(te)):i&&(p=="module"||p=="enum"||p=="type")&&g.stream.match(/^\s*\w/,!1)?(g.marked="keyword",p=="enum"?m(Zs):p=="type"?m(Vs,j("operator"),fe,j(";")):m(C("form"),ct,j("{"),C("}"),gr,P,P)):i&&p=="namespace"?(g.marked="keyword",m(C("form"),$,te,P)):i&&p=="abstract"?(g.marked="keyword",m(te)):m(C("stat"),Ne):u=="switch"?m(C("form"),Ae,j("{"),C("}","switch"),B,gr,P,P,Y):u=="case"?m($,j(":")):u=="default"?m(j(":")):u=="catch"?m(C("form"),D,rt,te,P,Y):u=="export"?m(C("stat"),bl,P):u=="import"?m(C("stat"),wl,P):u=="async"?m(te):p=="@"?m($,te):b(C("stat"),$,j(";"),P)}function rt(u){if(u=="(")return m(Ut,j(")"))}function $(u,p){return ve(u,p,!1)}function ye(u,p){return ve(u,p,!0)}function Ae(u){return u!="("?b():m(C(")"),Oe,j(")"),P)}function ve(u,p,v){if(g.state.fatArrowAt==g.stream.start){var S=v?jn:Le;if(u=="(")return m(D,C(")"),qe(Ut,")"),P,j("=>"),S,Y);if(u=="variable")return b(D,ct,j("=>"),S,Y)}var O=v?ke:le;return re.hasOwnProperty(u)?m(O):u=="function"?m(Dt,O):u=="class"||i&&p=="interface"?(g.marked="keyword",m(C("form"),vl,P)):u=="keyword c"||u=="async"?m(v?ye:$):u=="("?m(C(")"),Oe,j(")"),P,O):u=="operator"||u=="spread"?m(v?ye:$):u=="["?m(C("]"),kl,P,O):u=="{"?zn(Se,"}",null,O):u=="quasi"?b(pe,O):u=="new"?m(pr(v)):m()}function Oe(u){return u.match(/[;\}\)\],]/)?b():b($)}function le(u,p){return u==","?m(Oe):ke(u,p,!1)}function ke(u,p,v){var S=v==!1?le:ke,O=v==!1?$:ye;if(u=="=>")return m(D,v?jn:Le,Y);if(u=="operator")return/\+\+|--/.test(p)||i&&p=="!"?m(S):i&&p=="<"&&g.stream.match(/^([^<>]|<[^<>]*>)*>\s*\(/,!1)?m(C(">"),qe(fe,">"),P,S):p=="?"?m($,j(":"),O):m(O);if(u=="quasi")return b(pe,S);if(u!=";"){if(u=="(")return zn(ye,")","call",S);if(u==".")return m(mr,S);if(u=="[")return m(C("]"),Oe,j("]"),P,S);if(i&&p=="as")return g.marked="keyword",m(fe,S);if(u=="regexp")return g.state.lastType=g.marked="operator",g.stream.backUp(g.stream.pos-g.stream.start-1),m(O)}}function pe(u,p){return u!="quasi"?b():p.slice(p.length-2)!="${"?m(pe):m(Oe,Xo)}function Xo(u){if(u=="}")return g.marked="string.special",g.state.tokenize=W,m(pe)}function Le(u){return Z(g.stream,g.state),b(u=="{"?te:$)}function jn(u){return Z(g.stream,g.state),b(u=="{"?te:ye)}function pr(u){return function(p){return p=="."?m(u?ue:G):p=="variable"&&i?m(pl,u?ke:le):b(u?ye:$)}}function G(u,p){if(p=="target")return g.marked="keyword",m(le)}function ue(u,p){if(p=="target")return g.marked="keyword",m(ke)}function Ne(u){return u==":"?m(P,te):b(le,j(";"),P)}function mr(u){if(u=="variable")return g.marked="property",m()}function Se(u,p){if(u=="async")return g.marked="property",m(Se);if(u=="variable"||g.style=="keyword"){if(g.marked="property",p=="get"||p=="set")return m(yr);var v;return i&&g.state.fatArrowAt==g.stream.start&&(v=g.stream.match(/^\s*:\s*/,!1))&&(g.state.fatArrowAt=g.stream.pos+v[0].length),m(Jt)}else{if(u=="number"||u=="string")return g.marked=t?"property":g.style+" property",m(Jt);if(u=="jsonld-keyword")return m(Jt);if(i&&x(p))return g.marked="keyword",m(Se);if(u=="[")return m($,en,j("]"),Jt);if(u=="spread")return m(ye,Jt);if(p=="*")return g.marked="keyword",m(Se);if(u==":")return b(Jt)}}function yr(u){return u!="variable"?b(Jt):(g.marked="property",m(Dt))}function Jt(u){if(u==":")return m(ye);if(u=="(")return b(Dt)}function qe(u,p,v){function S(O,oe){if(v?v.indexOf(O)>-1:O==","){var de=g.state.lexical;return de.info=="call"&&(de.pos=(de.pos||0)+1),m(function($e,it){return $e==p||it==p?b():b(u)},S)}return O==p||oe==p?m():v&&v.indexOf(";")>-1?b(u):m(j(p))}return function(O,oe){return O==p||oe==p?m():b(u,S)}}function zn(u,p,v){for(var S=3;S<arguments.length;S++)g.cc.push(arguments[S]);return m(C(p,v),qe(u,p),P)}function gr(u){return u=="}"?m():b(te,gr)}function en(u,p){if(i){if(u==":")return m(fe);if(p=="?")return m(en)}}function cl(u,p){if(i&&(u==":"||p=="in"))return m(fe)}function Js(u){if(i&&u==":")return g.stream.match(/^\s*\w+\s+is\b/,!1)?m($,fl,fe):m(fe)}function fl(u,p){if(p=="is")return g.marked="keyword",m()}function fe(u,p){if(p=="keyof"||p=="typeof"||p=="infer"||p=="readonly")return g.marked="keyword",m(p=="typeof"?ye:fe);if(u=="variable"||p=="void")return g.marked="type",m(kt);if(p=="|"||p=="&")return m(fe);if(u=="string"||u=="number"||u=="atom")return m(kt);if(u=="[")return m(C("]"),qe(fe,"]",","),P,kt);if(u=="{")return m(C("}"),Zo,P,kt);if(u=="(")return m(qe($o,")"),dl,kt);if(u=="<")return m(qe(fe,">"),fe);if(u=="quasi")return b(Ko,kt)}function dl(u){if(u=="=>")return m(fe)}function Zo(u){return u.match(/[\}\)\]]/)?m():u==","||u==";"?m(Zo):b(Wn,Zo)}function Wn(u,p){if(u=="variable"||g.style=="keyword")return g.marked="property",m(Wn);if(p=="?"||u=="number"||u=="string")return m(Wn);if(u==":")return m(fe);if(u=="[")return m(j("variable"),cl,j("]"),Wn);if(u=="(")return b(nn,Wn);if(!u.match(/[;\}\)\],]/))return m()}function Ko(u,p){return u!="quasi"?b():p.slice(p.length-2)!="${"?m(Ko):m(fe,hl)}function hl(u){if(u=="}")return g.marked="string.special",g.state.tokenize=W,m(Ko)}function $o(u,p){return u=="variable"&&g.stream.match(/^\s*[?:]/,!1)||p=="?"?m($o):u==":"?m(fe):u=="spread"?m($o):b(fe)}function kt(u,p){if(p=="<")return m(C(">"),qe(fe,">"),P,kt);if(p=="|"||u=="."||p=="&")return m(fe);if(u=="[")return m(fe,j("]"),kt);if(p=="extends"||p=="implements")return g.marked="keyword",m(fe);if(p=="?")return m(fe,j(":"),fe)}function pl(u,p){if(p=="<")return m(C(">"),qe(fe,">"),P,kt)}function _r(){return b(fe,ml)}function ml(u,p){if(p=="=")return m(fe)}function es(u,p){return p=="enum"?(g.marked="keyword",m(Zs)):b(ct,en,Rt,gl)}function ct(u,p){if(i&&x(p))return g.marked="keyword",m(ct);if(u=="variable")return ce(p),m();if(u=="spread")return m(ct);if(u=="[")return zn(yl,"]");if(u=="{")return zn(Us,"}")}function Us(u,p){return u=="variable"&&!g.stream.match(/^\s*:/,!1)?(ce(p),m(Rt)):(u=="variable"&&(g.marked="property"),u=="spread"?m(ct):u=="}"?b():u=="["?m($,j("]"),j(":"),Us):m(j(":"),ct,Rt))}function yl(){return b(ct,Rt)}function Rt(u,p){if(p=="=")return m(ye)}function gl(u){if(u==",")return m(es)}function Gs(u,p){if(u=="keyword b"&&p=="else")return m(C("form","else"),te,P)}function Hs(u,p){if(p=="await")return m(Hs);if(u=="(")return m(C(")"),_l,P)}function _l(u){return u=="var"?m(es,tn):u=="variable"?m(tn):b(tn)}function tn(u,p){return u==")"?m():u==";"?m(tn):p=="in"||p=="of"?(g.marked="keyword",m($,tn)):b($,tn)}function Dt(u,p){if(p=="*")return g.marked="keyword",m(Dt);if(u=="variable")return ce(p),m(Dt);if(u=="(")return m(D,C(")"),qe(Ut,")"),P,Js,te,Y);if(i&&p=="<")return m(C(">"),qe(_r,">"),P,Dt)}function nn(u,p){if(p=="*")return g.marked="keyword",m(nn);if(u=="variable")return ce(p),m(nn);if(u=="(")return m(D,C(")"),qe(Ut,")"),P,Js,Y);if(i&&p=="<")return m(C(">"),qe(_r,">"),P,nn)}function Vs(u,p){if(u=="keyword"||u=="variable")return g.marked="type",m(Vs);if(p=="<")return m(C(">"),qe(_r,">"),P)}function Ut(u,p){return p=="@"&&m($,Ut),u=="spread"?m(Ut):i&&x(p)?(g.marked="keyword",m(Ut)):i&&u=="this"?m(en,Rt):b(ct,en,Rt)}function vl(u,p){return u=="variable"?Ys(u,p):vr(u,p)}function Ys(u,p){if(u=="variable")return ce(p),m(vr)}function vr(u,p){if(p=="<")return m(C(">"),qe(_r,">"),P,vr);if(p=="extends"||p=="implements"||i&&u==",")return p=="implements"&&(g.marked="keyword"),m(i?fe:$,vr);if(u=="{")return m(C("}"),Et,P)}function Et(u,p){if(u=="async"||u=="variable"&&(p=="static"||p=="get"||p=="set"||i&&x(p))&&g.stream.match(/^\s+#?[\w$\xa1-\uffff]/,!1))return g.marked="keyword",m(Et);if(u=="variable"||g.style=="keyword")return g.marked="property",m(br,Et);if(u=="number"||u=="string")return m(br,Et);if(u=="[")return m($,en,j("]"),br,Et);if(p=="*")return g.marked="keyword",m(Et);if(i&&u=="(")return b(nn,Et);if(u==";"||u==",")return m(Et);if(u=="}")return m();if(p=="@")return m($,Et)}function br(u,p){if(p=="!"||p=="?")return m(br);if(u==":")return m(fe,Rt);if(p=="=")return m(ye);var v=g.state.lexical.prev,S=v&&v.info=="interface";return b(S?nn:Dt)}function bl(u,p){return p=="*"?(g.marked="keyword",m(ts,j(";"))):p=="default"?(g.marked="keyword",m($,j(";"))):u=="{"?m(qe(Qs,"}"),ts,j(";")):b(te)}function Qs(u,p){if(p=="as")return g.marked="keyword",m(j("variable"));if(u=="variable")return b(ye,Qs)}function wl(u){return u=="string"?m():u=="("?b($):u=="."?b(le):b(wr,Xs,ts)}function wr(u,p){return u=="{"?zn(wr,"}"):(u=="variable"&&ce(p),p=="*"&&(g.marked="keyword"),m(xl))}function Xs(u){if(u==",")return m(wr,Xs)}function xl(u,p){if(p=="as")return g.marked="keyword",m(wr)}function ts(u,p){if(p=="from")return g.marked="keyword",m($)}function kl(u){return u=="]"?m():b(qe(ye,"]"))}function Zs(){return b(C("form"),ct,j("{"),C("}"),qe(El,"}"),P,P)}function El(){return b(ct,Rt)}function Ml(u,p){return u.lastType=="operator"||u.lastType==","||a.test(p.charAt(0))||/[,.]/.test(p.charAt(0))}function Al(u,p,v){return p.tokenize==_&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\[{}\(,;:]|=>)$/.test(p.lastType)||p.lastType=="quasi"&&/\{\s*$/.test(u.string.slice(0,u.pos-(v||0)))}return{name:n.name,startState:function(u){var p={tokenize:_,lastType:"sof",cc:[],lexical:new U(-u,0,"block",!1),localVars:n.localVars,context:n.localVars&&new w(null,null,!1),indented:0};return n.globalVars&&typeof n.globalVars=="object"&&(p.globalVars=n.globalVars),p},token:function(u,p){if(u.sol()&&(p.lexical.hasOwnProperty("align")||(p.lexical.align=!1),p.indented=u.indentation(),Z(u,p)),p.tokenize!=k&&u.eatSpace())return null;var v=p.tokenize(u,p);return f=="comment"?v:(p.lastType=f=="operator"&&(h=="++"||h=="--")?"incdec":f,me(p,v,f,h,u))},indent:function(u,p,v){if(u.tokenize==k||u.tokenize==W)return null;if(u.tokenize!=_)return 0;var S=p&&p.charAt(0),O=u.lexical,oe;if(!/^\s*else\b/.test(p))for(var de=u.cc.length-1;de>=0;--de){var $e=u.cc[de];if($e==P)O=O.prev;else if($e!=Gs&&$e!=Y)break}for(;(O.type=="stat"||O.type=="form")&&(S=="}"||(oe=u.cc[u.cc.length-1])&&(oe==le||oe==ke)&&!/^[,\.=+\-*:?[\(]/.test(p));)O=O.prev;e&&O.type==")"&&O.prev.type=="stat"&&(O=O.prev);var it=O.type,Bn=S==it;return it=="vardef"?O.indented+(u.lastType=="operator"||u.lastType==","?O.info.length+1:0):it=="form"&&S=="{"?O.indented:it=="form"?O.indented+v.unit:it=="stat"?O.indented+(Ml(u,p)?e||v.unit:0):O.info=="switch"&&!Bn&&n.doubleIndentSwitch!=!1?O.indented+(/^(?:case|default)\b/.test(p)?v.unit:2*v.unit):O.align?O.column+(Bn?0:1):O.indented+(Bn?0:v.unit)},languageData:{indentOnInput:/^\s*(?:case .*?:|default:|\{|\})$/,commentTokens:r?void 0:{line:"//",block:{open:"/*",close:"*/"}},closeBrackets:{brackets:["(","[","{","'",'"',"`"]},wordChars:"$"}}}var hr=Ho({name:"javascript"}),G_=Ho({name:"json",json:!0}),H_=Ho({name:"json",jsonld:!0}),V_=Ho({name:"typescript",typescript:!0});var Yo=require("obsidian"),Vo=class extends Yo.FuzzySuggestModal{constructor(t,r){super(t.app);this.plugin=t,this.selectCallback=r}getItems(){return this.app.vault.getAllLoadedFiles().filter(r=>r instanceof Yo.TFile).filter(r=>r.extension==="js")}getItemText(t){return t.path}onChooseItem(t,r){this.selectCallback(t)}};var Qo=class extends ul.Plugin{constructor(t,r){super(t,r);this.messageManager=new Dr(this.app,this),this.jsEngine=new Go(this.app,this),this.api=new Nn(this.app,this,qn.create("PLUGIN"))}async onload(){await this.loadSettings(),this.messageManager.initStatusBarItem(),this.registerMarkdownCodeBlockProcessor("js-engine",(t,r,i)=>{let o=new qr(r,this,t,i);i.addChild(o)}),this.addCommand({id:"execute-js-file",name:"Execute JS File",callback:()=>{new Vo(this,async t=>{await this.api.internal.executeFileSimple(t.path)}).open()}}),await this.registerCodeMirrorMode()}onunload(){}async loadSettings(){let t=await this.loadData();this.settings=Object.assign({},ea,t)}async saveSettings(){await this.saveData(this.settings)}async registerCodeMirrorMode(){window.CodeMirror.defineMode("js-engine",t=>({startState:()=>{var i,o;return(o=(i=hr).startState)==null?void 0:o.call(i,4)},blankLine:i=>{var o,s;return(s=(o=hr).blankLine)==null?void 0:s.call(o,i,4)},copyState:i=>{var o,s;return(s=(o=hr).startState)==null?void 0:s.call(o,4)},token:(i,o)=>{var a,l;return`line-HyperMD-codeblock ${(l=(a=hr).token)==null?void 0:l.call(a,i,o)}`}}))}};
