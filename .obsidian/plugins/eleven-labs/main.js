/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => ElevenLabsPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian6 = require("obsidian");

// src/settings.ts
var import_obsidian = require("obsidian");
var DEFAULT_MODEL_ID = "eleven_monolingual_v1";
var DEFAULT_SETTINGS = {
  apiKey: "",
  selectedVoiceId: null,
  selectedModelId: null,
  voiceSettings: {}
};
var ElevenLabsSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("API Key").setDesc("Your Eleven Labs API Key").addText(
      (text) => text.setPlaceholder("Enter your API Key").setValue(this.plugin.settings.apiKey).onChange(async (value) => {
        this.plugin.settings.apiKey = value;
        await this.plugin.saveSettings();
      }).inputEl.type = "password"
      // Set input type to password
    );
  }
};

// src/eleven_labs_api.ts
var import_obsidian2 = require("obsidian");
var BASE_URL = "https://api.elevenlabs.io/v1";
var ElevenLabsApi = class {
  static async getVoices(apiKey) {
    return (0, import_obsidian2.requestUrl)({
      url: `${BASE_URL}/voices`,
      method: "GET",
      headers: {
        "xi-api-key": apiKey
      }
    });
  }
  static async getModels(apiKey) {
    return (0, import_obsidian2.requestUrl)({
      url: `${BASE_URL}/models`,
      method: "GET",
      headers: {
        "xi-api-key": apiKey
      }
    });
  }
  static async textToSpeech(apiKey, text, voiceId, modelId, options) {
    const data = {
      model_id: modelId,
      text
    };
    if (options) {
      const settings = {
        stability: options.stability / 100,
        similarity_boost: options.similarity_boost / 100
      };
      data.voice_settings = settings;
    }
    return (0, import_obsidian2.requestUrl)({
      url: `${BASE_URL}/text-to-speech/${voiceId}`,
      method: "POST",
      headers: {
        Accept: "audio/mpeg",
        "xi-api-key": apiKey,
        "Content-Type": "application/json"
      },
      body: JSON.stringify(data)
    });
  }
};
var eleven_labs_api_default = ElevenLabsApi;

// src/modals.ts
var import_obsidian5 = require("obsidian");

// src/util/audio.ts
var import_obsidian3 = require("obsidian");

// src/util/file.ts
function generateFilename(voiceName, date) {
  const year = date.getFullYear();
  const month = (date.getMonth() + 1).toString().padStart(2, "0");
  const day = date.getDate().toString().padStart(2, "0");
  const hour = date.getHours().toString().padStart(2, "0");
  const minutes = date.getMinutes().toString().padStart(2, "0");
  const seconds = date.getSeconds().toString().padStart(2, "0");
  return `${year}-${month}-${day}_${hour}-${minutes}-${seconds}_${voiceName}`;
}
function createVaultDirectories(vault, directories) {
  directories.forEach((directory) => {
    if (!vault.getAbstractFileByPath(directory)) {
      vault.createFolder(directory);
    }
  });
}

// src/util/audio.ts
function createAudioNote(vault, text, filename, voiceName, modelName, enabled, stability, similarityBoost, date, notePath) {
  const content = `
**Voice:** ${voiceName}
**Model:** ${modelName}
**Created:** ${date.toLocaleString()}
**Voice Settings Enabled:** ${enabled}
**Stability:** ${stability}
**Similarity Boost:** ${similarityBoost}
**Note:** [[${notePath}]]

${text.split("\n").map((line) => `> ${line}`).join("\n")}

![[ElevenLabs/Audio/${filename}.mp3]]

---
`;
  vault.create(`ElevenLabs/${filename}.md`, content);
}
function createAudioFile(vault, filename, data) {
  vault.createBinary(`ElevenLabs/Audio/${filename}.mp3`, data);
}
async function generateAudio(plugin, text, voiceName, voiceId, modelName, modelId, enabled, stability, similarityBoost) {
  var _a;
  let voiceSettings = void 0;
  if (enabled) {
    voiceSettings = {
      stability,
      similarity_boost: similarityBoost
    };
  }
  const activeView = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
  const notePath = (_a = activeView == null ? void 0 : activeView.file) == null ? void 0 : _a.basename;
  try {
    const response = await eleven_labs_api_default.textToSpeech(
      plugin.settings.apiKey,
      text,
      voiceId,
      modelId,
      voiceSettings
    );
    console.log(response);
    const date = new Date();
    const filename = generateFilename(voiceName, date);
    createAudioFile(plugin.app.vault, filename, response.arrayBuffer);
    createAudioNote(
      plugin.app.vault,
      text,
      filename,
      voiceName,
      modelName,
      enabled,
      stability,
      similarityBoost,
      date,
      notePath
    );
    new import_obsidian3.Notice(`Eleven Labs: Created audio file (${filename})`, 5e3);
  } catch (error) {
    console.log(error);
  }
}

// src/util/ui.ts
var import_obsidian4 = require("obsidian");
function renderGenerateAudioButton(parent, callback) {
  new import_obsidian4.ButtonComponent(parent).setClass("btn-generate-audio").setButtonText("Generate audio").onClick(callback);
}
function renderModelLanguageChips(plugin, parent) {
  parent.empty();
  const models = plugin.models;
  const selectedModelId = plugin.settings.selectedModelId || DEFAULT_MODEL_ID;
  const selectedModel = models.find(
    (model) => model.model_id === selectedModelId
  );
  const languages = selectedModel.languages.map((language) => {
    return language.name;
  });
  languages.forEach((language) => {
    parent.createEl("span", {
      text: language,
      cls: "language-chip"
    });
  });
}
function renderVoiceSettings(plugin, parent) {
  parent.empty();
  const selectedVoiceId = plugin.settings.selectedVoiceId || "";
  let voiceSettings = plugin.settings.voiceSettings[selectedVoiceId];
  if (voiceSettings == void 0) {
    voiceSettings = {
      enabled: false,
      stability: 0,
      similarity_boost: 0
    };
    plugin.settings.voiceSettings[selectedVoiceId] = voiceSettings;
  }
  parent.createEl("h6", { text: "Voice settings" });
  const voiceSettingsToggle = new import_obsidian4.ToggleComponent(parent).setValue(voiceSettings.enabled).setTooltip("Enable voice settings").onChange((value) => {
    voiceSettingsContainer.toggle(value);
    plugin.settings.voiceSettings[selectedVoiceId]["enabled"] = value;
  });
  const voiceSettingsContainer = parent.createDiv("voice-settings-container");
  voiceSettingsContainer.createDiv({
    cls: "voice-settings-description",
    text: "These settings will override the stored settings for this voice. They only apply to this audio file."
  });
  voiceSettingsContainer.toggle(voiceSettings.enabled);
  const stabilityInitialValue = plugin.settings.voiceSettings[selectedVoiceId]["stability"] || 0;
  const stabilityEl = voiceSettingsContainer.createEl("div", {
    text: `Stability: ${stabilityInitialValue}`
  });
  const stabilitySlider = new import_obsidian4.SliderComponent(voiceSettingsContainer).setValue(stabilityInitialValue).setLimits(0, 100, 1).onChange((value) => {
    stabilityEl.setText(`Stability: ${value}`);
    plugin.settings.voiceSettings[selectedVoiceId]["stability"] = value;
  });
  const similarityBoostInitialValue = plugin.settings.voiceSettings[selectedVoiceId]["similarity_boost"] || 0;
  const similarityEl = voiceSettingsContainer.createEl("div", {
    text: `Similarity boost: ${similarityBoostInitialValue}`
  });
  const similaritySlider = new import_obsidian4.SliderComponent(voiceSettingsContainer).setValue(similarityBoostInitialValue).setLimits(0, 100, 1).onChange((value) => {
    similarityEl.setText(`Similarity boost: ${value}`);
    plugin.settings.voiceSettings[selectedVoiceId]["similarity_boost"] = value;
  });
  return {
    voiceSettingsToggle,
    stabilitySlider,
    similaritySlider
  };
}
function renderTextSection(parent, selectedText) {
  parent.createDiv("eleven-labs-text-area", (el) => {
    el.createEl("h6", { text: "Text" });
    new import_obsidian4.TextAreaComponent(el).setPlaceholder("Enter text here").setValue(selectedText).setDisabled(true);
    const charCountEl = el.createDiv("char-count");
    charCountEl.setText(`Characters: ${selectedText.length}`);
  });
}
function addVoicesToOptionGroup(voices, optgroupEl, selectedVoiceId) {
  voices.forEach((voice) => {
    const optionEl = optgroupEl.createEl("option", {
      text: voice.name,
      value: voice.voice_id
    });
    if (voice.voice_id === selectedVoiceId) {
      optionEl.setAttribute("selected", "selected");
    }
  });
}
function addCategory(selectEl, label, voices, selectedVoiceId) {
  if (voices) {
    const optgroupEl = selectEl.createEl("optgroup");
    optgroupEl.label = label;
    addVoicesToOptionGroup(voices, optgroupEl, selectedVoiceId);
  }
}
function voicesGroupedByCategory(voices) {
  return voices.reduce((acc, voice) => {
    if (!acc.has(voice.category)) {
      acc.set(voice.category, []);
    }
    acc.get(voice.category).push(voice);
    return acc;
  }, /* @__PURE__ */ new Map());
}
function renderVoiceSelect(plugin, parent, onVoiceSelected) {
  const voices = plugin.voices;
  const selectedVoiceId = plugin.settings.selectedVoiceId || "";
  return parent.createEl("select", "dropdown", (selectEl) => {
    const defaultOptionEl = selectEl.createEl("option", {
      text: "Select a voice"
    });
    defaultOptionEl.setAttribute("selected", "selected");
    defaultOptionEl.setAttribute("disabled", "disabled");
    const groupedByCategory = voicesGroupedByCategory(voices);
    addCategory(
      selectEl,
      "Cloned",
      groupedByCategory.get("cloned"),
      selectedVoiceId
    );
    addCategory(
      selectEl,
      "Generated",
      groupedByCategory.get("generated"),
      selectedVoiceId
    );
    addCategory(
      selectEl,
      "Premade",
      groupedByCategory.get("premade"),
      selectedVoiceId
    );
    selectEl.addEventListener("change", (_) => {
      const selectedOption = selectEl.value;
      plugin.settings.selectedVoiceId = selectedOption;
      plugin.saveSettings();
      onVoiceSelected();
    });
  });
}
function renderModelSelect(plugin, parent, onModelSelected) {
  const models = plugin.models;
  const selectedModelId = plugin.settings.selectedModelId || "";
  const options = models.reduce((acc, obj) => {
    acc[obj.model_id] = obj.name;
    return acc;
  }, {});
  const dropdown = new import_obsidian4.DropdownComponent(parent).addOptions(options).setValue(selectedModelId || DEFAULT_MODEL_ID).onChange((value) => {
    plugin.settings.selectedModelId = value;
    plugin.saveSettings();
    onModelSelected();
  });
  dropdown.selectEl.classList.add("eleven-labs-model-select");
  return dropdown.selectEl;
}

// src/modals.ts
var ElevenLabsModal = class extends import_obsidian5.Modal {
  constructor(plugin, selectedText) {
    super(plugin.app);
    this.plugin = plugin;
    this.selectedText = selectedText;
    this.shouldRestoreSelection = true;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.addClass("eleven-labs-modal");
    let voiceSettings;
    let voiceSelectEl;
    let modelSelectEl;
    contentEl.createDiv("settings", (el) => {
      voiceSelectEl = renderVoiceSelect(this.plugin, el, () => {
        voiceSettings = renderVoiceSettings(
          this.plugin,
          voiceSettingsContainer
        );
      });
      modelSelectEl = renderModelSelect(this.plugin, el, () => {
        renderModelLanguageChips(this.plugin, languageChipsContainer);
      });
      const languageChipsContainer = el.createDiv("chips-container");
      renderModelLanguageChips(this.plugin, languageChipsContainer);
      el.createEl("hr");
      const voiceSettingsContainer = el.createDiv("voice-settings");
      voiceSettings = renderVoiceSettings(
        this.plugin,
        voiceSettingsContainer
      );
      el.createEl("hr");
    });
    renderTextSection(contentEl, this.selectedText);
    contentEl.createDiv("actions", (el) => {
      renderGenerateAudioButton(el, () => {
        new import_obsidian5.Notice("Eleven Labs: Generating audio...", 5e3);
        createVaultDirectories(this.app.vault, [
          "ElevenLabs",
          "ElevenLabs/Audio"
        ]);
        generateAudio(
          this.plugin,
          this.selectedText,
          voiceSelectEl.options[voiceSelectEl.selectedIndex].text,
          voiceSelectEl.value,
          modelSelectEl.options[modelSelectEl.selectedIndex].text,
          modelSelectEl.value,
          voiceSettings.voiceSettingsToggle.getValue(),
          voiceSettings.stabilitySlider.getValue(),
          voiceSettings.similaritySlider.getValue()
        );
        this.close();
      });
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// main.ts
var ElevenLabsPlugin = class extends import_obsidian6.Plugin {
  constructor() {
    super(...arguments);
    this.addContextMenuItems = (menu, editor, info) => {
      menu.addItem((item) => {
        const markdownView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
        const selectedText = markdownView == null ? void 0 : markdownView.editor.getSelection();
        item.setTitle("Eleven Labs").setIcon("file-audio").onClick(async () => {
          if (selectedText != null) {
            new ElevenLabsModal(this, selectedText).open();
          }
        });
        item.setDisabled(selectedText == null);
      });
    };
    this.openModalCommand = {
      id: "eleven-labs-open-modal",
      name: "Open Modal",
      editorCheckCallback: (checking, editor, view) => {
        const selectedText = view == null ? void 0 : view.editor.getSelection();
        if (selectedText) {
          if (!checking) {
            new ElevenLabsModal(this, selectedText).open();
          }
          return true;
        }
        return false;
      }
    };
  }
  async onload() {
    await this.loadSettings();
    this.loadVoices();
    this.loadModels();
    this.app.workspace.on("editor-menu", this.addContextMenuItems);
    this.addCommand(this.openModalCommand);
    this.addSettingTab(new ElevenLabsSettingTab(this.app, this));
  }
  onunload() {
    this.app.workspace.off("editor-menu", this.addContextMenuItems);
  }
  async loadVoices() {
    try {
      const response = await eleven_labs_api_default.getVoices(
        this.settings.apiKey
      );
      this.voices = response.json.voices;
    } catch (error) {
      console.log(error);
    }
  }
  async loadModels() {
    try {
      const response = await eleven_labs_api_default.getModels(
        this.settings.apiKey
      );
      this.models = response.json.filter(
        (m) => m.can_do_text_to_speech
      );
    } catch (error) {
      console.log(error);
    }
  }
  async loadSettings() {
    this.settings = Object.assign(
      {},
      DEFAULT_SETTINGS,
      await this.loadData()
    );
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL2VsZXZlbl9sYWJzX2FwaS50cyIsICJzcmMvbW9kYWxzLnRzIiwgInNyYy91dGlsL2F1ZGlvLnRzIiwgInNyYy91dGlsL2ZpbGUudHMiLCAic3JjL3V0aWwvdWkudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7XG4gICAgRWRpdG9yLFxuICAgIE1hcmtkb3duVmlldyxcbiAgICBQbHVnaW4sXG4gICAgTWVudSxcbiAgICBNYXJrZG93bkZpbGVJbmZvLFxufSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7XG4gICAgRWxldmVuTGFic1BsdWdpblNldHRpbmdzLFxuICAgIERFRkFVTFRfU0VUVElOR1MsXG4gICAgRWxldmVuTGFic1NldHRpbmdUYWIsXG59IGZyb20gXCIuL3NyYy9zZXR0aW5nc1wiO1xuaW1wb3J0IEVsZXZlbkxhYnNBcGkgZnJvbSBcIi4vc3JjL2VsZXZlbl9sYWJzX2FwaVwiO1xuaW1wb3J0IHsgRWxldmVuTGFic01vZGFsIH0gZnJvbSBcIi4vc3JjL21vZGFsc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBFbGV2ZW5MYWJzUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcbiAgICBzZXR0aW5nczogRWxldmVuTGFic1BsdWdpblNldHRpbmdzO1xuICAgIHZvaWNlczogYW55W107XG4gICAgbW9kZWxzOiBhbnlbXTtcblxuICAgIGFkZENvbnRleHRNZW51SXRlbXMgPSAoXG4gICAgICAgIG1lbnU6IE1lbnUsXG4gICAgICAgIGVkaXRvcjogRWRpdG9yLFxuICAgICAgICBpbmZvOiBNYXJrZG93blZpZXcgfCBNYXJrZG93bkZpbGVJbmZvXG4gICAgKSA9PiB7XG4gICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbWFya2Rvd25WaWV3ID1cbiAgICAgICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRUZXh0ID0gbWFya2Rvd25WaWV3Py5lZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG5cbiAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoXCJFbGV2ZW4gTGFic1wiKVxuICAgICAgICAgICAgICAgIC5zZXRJY29uKFwiZmlsZS1hdWRpb1wiKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkVGV4dCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgRWxldmVuTGFic01vZGFsKHRoaXMsIHNlbGVjdGVkVGV4dCkub3BlbigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGl0ZW0uc2V0RGlzYWJsZWQoc2VsZWN0ZWRUZXh0ID09IG51bGwpOyAvLyBEaXNhYmxlIHRoZSBpdGVtIGlmIG5vIHRleHQgaXMgc2VsZWN0ZWRcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIG9wZW5Nb2RhbENvbW1hbmQgPSB7XG4gICAgICAgIGlkOiBcImVsZXZlbi1sYWJzLW9wZW4tbW9kYWxcIixcbiAgICAgICAgbmFtZTogXCJPcGVuIE1vZGFsXCIsXG4gICAgICAgIGVkaXRvckNoZWNrQ2FsbGJhY2s6IChcbiAgICAgICAgICAgIGNoZWNraW5nOiBib29sZWFuLFxuICAgICAgICAgICAgZWRpdG9yOiBFZGl0b3IsXG4gICAgICAgICAgICB2aWV3OiBNYXJrZG93blZpZXdcbiAgICAgICAgKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzZWxlY3RlZFRleHQgPSB2aWV3Py5lZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgaWYgKCFjaGVja2luZykge1xuICAgICAgICAgICAgICAgICAgICBuZXcgRWxldmVuTGFic01vZGFsKHRoaXMsIHNlbGVjdGVkVGV4dCkub3BlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcbiAgICB9O1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXG4gICAgICAgIC8vIExvYWQgdm9pY2VzXG4gICAgICAgIHRoaXMubG9hZFZvaWNlcygpO1xuXG4gICAgICAgIC8vIExvYWQgbW9kZWxzXG4gICAgICAgIHRoaXMubG9hZE1vZGVscygpO1xuXG4gICAgICAgIC8vIEFkZCBjb250ZXh0IG1lbnUgaXRlbVxuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJlZGl0b3ItbWVudVwiLCB0aGlzLmFkZENvbnRleHRNZW51SXRlbXMpO1xuXG4gICAgICAgIC8vIEFkZCBjb21tYW5kIHRvIG9wZW4gbW9kYWxcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHRoaXMub3Blbk1vZGFsQ29tbWFuZCk7XG5cbiAgICAgICAgLy8gVGhpcyBhZGRzIGEgc2V0dGluZ3MgdGFiIHNvIHRoZSB1c2VyIGNhbiBjb25maWd1cmUgdmFyaW91cyBhc3BlY3RzIG9mIHRoZSBwbHVnaW5cbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBFbGV2ZW5MYWJzU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuICAgIH1cblxuICAgIG9udW5sb2FkKCkge1xuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub2ZmKFwiZWRpdG9yLW1lbnVcIiwgdGhpcy5hZGRDb250ZXh0TWVudUl0ZW1zKTtcbiAgICB9XG5cbiAgICBhc3luYyBsb2FkVm9pY2VzKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBFbGV2ZW5MYWJzQXBpLmdldFZvaWNlcyhcbiAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLmFwaUtleVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRoaXMudm9pY2VzID0gcmVzcG9uc2UuanNvbi52b2ljZXM7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBsb2FkTW9kZWxzKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBFbGV2ZW5MYWJzQXBpLmdldE1vZGVscyhcbiAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLmFwaUtleVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRoaXMubW9kZWxzID0gcmVzcG9uc2UuanNvbi5maWx0ZXIoXG4gICAgICAgICAgICAgICAgKG06IGFueSkgPT4gbS5jYW5fZG9fdGV4dF90b19zcGVlY2hcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKFxuICAgICAgICAgICAge30sXG4gICAgICAgICAgICBERUZBVUxUX1NFVFRJTkdTLFxuICAgICAgICAgICAgYXdhaXQgdGhpcy5sb2FkRGF0YSgpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBFbGV2ZW5MYWJzUGx1Z2luIGZyb20gXCIuLi9tYWluXCI7XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX01PREVMX0lEID0gXCJlbGV2ZW5fbW9ub2xpbmd1YWxfdjFcIjtcblxuZXhwb3J0IGludGVyZmFjZSBWb2ljZVNldHRpbmdzIHtcbiAgICBlbmFibGVkOiBib29sZWFuO1xuICAgIHN0YWJpbGl0eTogbnVtYmVyO1xuICAgIHNpbWlsYXJpdHlfYm9vc3Q6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFbGV2ZW5MYWJzUGx1Z2luU2V0dGluZ3Mge1xuICAgIGFwaUtleTogc3RyaW5nO1xuICAgIHNlbGVjdGVkVm9pY2VJZDogc3RyaW5nIHwgbnVsbDtcbiAgICBzZWxlY3RlZE1vZGVsSWQ6IHN0cmluZyB8IG51bGw7XG4gICAgdm9pY2VTZXR0aW5nczogeyBba2V5OiBzdHJpbmddOiBWb2ljZVNldHRpbmdzIH07XG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBFbGV2ZW5MYWJzUGx1Z2luU2V0dGluZ3MgPSB7XG4gICAgYXBpS2V5OiBcIlwiLFxuICAgIHNlbGVjdGVkVm9pY2VJZDogbnVsbCxcbiAgICBzZWxlY3RlZE1vZGVsSWQ6IG51bGwsXG4gICAgdm9pY2VTZXR0aW5nczoge30sXG59O1xuXG5leHBvcnQgY2xhc3MgRWxldmVuTGFic1NldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IEVsZXZlbkxhYnNQbHVnaW47XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBFbGV2ZW5MYWJzUGx1Z2luKSB7XG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgfVxuXG4gICAgZGlzcGxheSgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblxuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJBUEkgS2V5XCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIllvdXIgRWxldmVuIExhYnMgQVBJIEtleVwiKVxuICAgICAgICAgICAgLmFkZFRleHQoXG4gICAgICAgICAgICAgICAgKHRleHQpID0+XG4gICAgICAgICAgICAgICAgICAgICh0ZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJFbnRlciB5b3VyIEFQSSBLZXlcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5hcGlLZXkpXG4gICAgICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuYXBpS2V5ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5pbnB1dEVsLnR5cGUgPSBcInBhc3N3b3JkXCIpIC8vIFNldCBpbnB1dCB0eXBlIHRvIHBhc3N3b3JkXG4gICAgICAgICAgICApO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyByZXF1ZXN0VXJsIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmV4cG9ydCBjb25zdCBCQVNFX1VSTCA9IFwiaHR0cHM6Ly9hcGkuZWxldmVubGFicy5pby92MVwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIFZvaWNlU2V0dGluZ3Mge1xuICAgIHN0YWJpbGl0eTogbnVtYmVyO1xuICAgIHNpbWlsYXJpdHlfYm9vc3Q6IG51bWJlcjtcbn1cblxuaW50ZXJmYWNlIFRleHRUb1NwZWVjaFJlcXVlc3Qge1xuICAgIG1vZGVsX2lkOiBzdHJpbmc7XG4gICAgdGV4dDogc3RyaW5nO1xuICAgIHZvaWNlX3NldHRpbmdzPzogVm9pY2VTZXR0aW5ncztcbn1cblxuY2xhc3MgRWxldmVuTGFic0FwaSB7XG4gICAgc3RhdGljIGFzeW5jIGdldFZvaWNlcyhhcGlLZXk6IHN0cmluZykge1xuICAgICAgICByZXR1cm4gcmVxdWVzdFVybCh7XG4gICAgICAgICAgICB1cmw6IGAke0JBU0VfVVJMfS92b2ljZXNgLFxuICAgICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgIFwieGktYXBpLWtleVwiOiBhcGlLZXksXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzdGF0aWMgYXN5bmMgZ2V0TW9kZWxzKGFwaUtleTogc3RyaW5nKSB7XG4gICAgICAgIHJldHVybiByZXF1ZXN0VXJsKHtcbiAgICAgICAgICAgIHVybDogYCR7QkFTRV9VUkx9L21vZGVsc2AsXG4gICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgXCJ4aS1hcGkta2V5XCI6IGFwaUtleSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHN0YXRpYyBhc3luYyB0ZXh0VG9TcGVlY2goXG4gICAgICAgIGFwaUtleTogc3RyaW5nLFxuICAgICAgICB0ZXh0OiBzdHJpbmcsXG4gICAgICAgIHZvaWNlSWQ6IHN0cmluZyxcbiAgICAgICAgbW9kZWxJZDogc3RyaW5nLFxuICAgICAgICBvcHRpb25zPzogVm9pY2VTZXR0aW5nc1xuICAgICkge1xuICAgICAgICBjb25zdCBkYXRhOiBUZXh0VG9TcGVlY2hSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgbW9kZWxfaWQ6IG1vZGVsSWQsXG4gICAgICAgICAgICB0ZXh0OiB0ZXh0LFxuICAgICAgICB9O1xuICAgICAgICBpZiAob3B0aW9ucykge1xuICAgICAgICAgICAgY29uc3Qgc2V0dGluZ3M6IFZvaWNlU2V0dGluZ3MgPSB7XG4gICAgICAgICAgICAgICAgc3RhYmlsaXR5OiBvcHRpb25zLnN0YWJpbGl0eSAvIDEwMC4wLFxuICAgICAgICAgICAgICAgIHNpbWlsYXJpdHlfYm9vc3Q6IG9wdGlvbnMuc2ltaWxhcml0eV9ib29zdCAvIDEwMC4wLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGRhdGEudm9pY2Vfc2V0dGluZ3MgPSBzZXR0aW5ncztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXF1ZXN0VXJsKHtcbiAgICAgICAgICAgIHVybDogYCR7QkFTRV9VUkx9L3RleHQtdG8tc3BlZWNoLyR7dm9pY2VJZH1gLFxuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICBBY2NlcHQ6IFwiYXVkaW8vbXBlZ1wiLFxuICAgICAgICAgICAgICAgIFwieGktYXBpLWtleVwiOiBhcGlLZXksXG4gICAgICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksXG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRWxldmVuTGFic0FwaTtcbiIsICJpbXBvcnQgeyBNb2RhbCwgTm90aWNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRWxldmVuTGFic1BsdWdpbiBmcm9tIFwiLi4vbWFpblwiO1xuaW1wb3J0IHsgZ2VuZXJhdGVBdWRpbyB9IGZyb20gXCIuL3V0aWwvYXVkaW9cIjtcbmltcG9ydCB7IGNyZWF0ZVZhdWx0RGlyZWN0b3JpZXMgfSBmcm9tIFwiLi91dGlsL2ZpbGVcIjtcbmltcG9ydCB7XG4gICAgcmVuZGVyR2VuZXJhdGVBdWRpb0J1dHRvbixcbiAgICByZW5kZXJUZXh0U2VjdGlvbixcbiAgICByZW5kZXJWb2ljZVNlbGVjdCxcbiAgICByZW5kZXJNb2RlbFNlbGVjdCxcbiAgICByZW5kZXJWb2ljZVNldHRpbmdzLFxuICAgIHJlbmRlck1vZGVsTGFuZ3VhZ2VDaGlwcyxcbn0gZnJvbSBcIi4vdXRpbC91aVwiO1xuXG5leHBvcnQgY2xhc3MgRWxldmVuTGFic01vZGFsIGV4dGVuZHMgTW9kYWwge1xuICAgIHBsdWdpbjogRWxldmVuTGFic1BsdWdpbjtcbiAgICBzZWxlY3RlZFRleHQ6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogRWxldmVuTGFic1BsdWdpbiwgc2VsZWN0ZWRUZXh0OiBzdHJpbmcpIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLnNlbGVjdGVkVGV4dCA9IHNlbGVjdGVkVGV4dDtcbiAgICAgICAgdGhpcy5zaG91bGRSZXN0b3JlU2VsZWN0aW9uID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuYWRkQ2xhc3MoXCJlbGV2ZW4tbGFicy1tb2RhbFwiKTtcblxuICAgICAgICBsZXQgdm9pY2VTZXR0aW5nczogYW55O1xuICAgICAgICBsZXQgdm9pY2VTZWxlY3RFbDogSFRNTFNlbGVjdEVsZW1lbnQ7XG4gICAgICAgIGxldCBtb2RlbFNlbGVjdEVsOiBIVE1MU2VsZWN0RWxlbWVudDtcblxuICAgICAgICAvLyBTZXR0aW5nc1xuICAgICAgICBjb250ZW50RWwuY3JlYXRlRGl2KFwic2V0dGluZ3NcIiwgKGVsKSA9PiB7XG4gICAgICAgICAgICAvLyBTZWxlY3Qgdm9pY2VcbiAgICAgICAgICAgIHZvaWNlU2VsZWN0RWwgPSByZW5kZXJWb2ljZVNlbGVjdCh0aGlzLnBsdWdpbiwgZWwsICgpID0+IHtcbiAgICAgICAgICAgICAgICB2b2ljZVNldHRpbmdzID0gcmVuZGVyVm9pY2VTZXR0aW5ncyhcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgIHZvaWNlU2V0dGluZ3NDb250YWluZXJcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFNlbGVjdCBtb2RlbFxuICAgICAgICAgICAgbW9kZWxTZWxlY3RFbCA9IHJlbmRlck1vZGVsU2VsZWN0KHRoaXMucGx1Z2luLCBlbCwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHJlbmRlck1vZGVsTGFuZ3VhZ2VDaGlwcyh0aGlzLnBsdWdpbiwgbGFuZ3VhZ2VDaGlwc0NvbnRhaW5lcik7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gTGFuZ3VhZ2UgY2hpcHNcbiAgICAgICAgICAgIGNvbnN0IGxhbmd1YWdlQ2hpcHNDb250YWluZXIgPSBlbC5jcmVhdGVEaXYoXCJjaGlwcy1jb250YWluZXJcIik7XG4gICAgICAgICAgICByZW5kZXJNb2RlbExhbmd1YWdlQ2hpcHModGhpcy5wbHVnaW4sIGxhbmd1YWdlQ2hpcHNDb250YWluZXIpO1xuXG4gICAgICAgICAgICAvLyBEaXZpZGVyXG4gICAgICAgICAgICBlbC5jcmVhdGVFbChcImhyXCIpO1xuXG4gICAgICAgICAgICBjb25zdCB2b2ljZVNldHRpbmdzQ29udGFpbmVyID0gZWwuY3JlYXRlRGl2KFwidm9pY2Utc2V0dGluZ3NcIik7XG5cbiAgICAgICAgICAgIC8vIFZvaWNlIHNldHRpbmdzXG4gICAgICAgICAgICB2b2ljZVNldHRpbmdzID0gcmVuZGVyVm9pY2VTZXR0aW5ncyhcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbixcbiAgICAgICAgICAgICAgICB2b2ljZVNldHRpbmdzQ29udGFpbmVyXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAvLyBEaXZpZGVyXG4gICAgICAgICAgICBlbC5jcmVhdGVFbChcImhyXCIpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBUZXh0XG4gICAgICAgIHJlbmRlclRleHRTZWN0aW9uKGNvbnRlbnRFbCwgdGhpcy5zZWxlY3RlZFRleHQpO1xuXG4gICAgICAgIC8vIEFjdGlvbnNcbiAgICAgICAgY29udGVudEVsLmNyZWF0ZURpdihcImFjdGlvbnNcIiwgKGVsKSA9PiB7XG4gICAgICAgICAgICByZW5kZXJHZW5lcmF0ZUF1ZGlvQnV0dG9uKGVsLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShcIkVsZXZlbiBMYWJzOiBHZW5lcmF0aW5nIGF1ZGlvLi4uXCIsIDUwMDApO1xuICAgICAgICAgICAgICAgIGNyZWF0ZVZhdWx0RGlyZWN0b3JpZXModGhpcy5hcHAudmF1bHQsIFtcbiAgICAgICAgICAgICAgICAgICAgXCJFbGV2ZW5MYWJzXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiRWxldmVuTGFicy9BdWRpb1wiLFxuICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgIGdlbmVyYXRlQXVkaW8oXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkVGV4dCxcbiAgICAgICAgICAgICAgICAgICAgdm9pY2VTZWxlY3RFbC5vcHRpb25zW3ZvaWNlU2VsZWN0RWwuc2VsZWN0ZWRJbmRleF0udGV4dCxcbiAgICAgICAgICAgICAgICAgICAgdm9pY2VTZWxlY3RFbC52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxTZWxlY3RFbC5vcHRpb25zW21vZGVsU2VsZWN0RWwuc2VsZWN0ZWRJbmRleF0udGV4dCxcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxTZWxlY3RFbC52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgdm9pY2VTZXR0aW5ncy52b2ljZVNldHRpbmdzVG9nZ2xlLmdldFZhbHVlKCksXG4gICAgICAgICAgICAgICAgICAgIHZvaWNlU2V0dGluZ3Muc3RhYmlsaXR5U2xpZGVyLmdldFZhbHVlKCksXG4gICAgICAgICAgICAgICAgICAgIHZvaWNlU2V0dGluZ3Muc2ltaWxhcml0eVNsaWRlci5nZXRWYWx1ZSgpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBOb3RpY2UsIE1hcmtkb3duVmlldywgVmF1bHQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IGdlbmVyYXRlRmlsZW5hbWUgfSBmcm9tIFwiLi9maWxlXCI7XG5pbXBvcnQgRWxldmVuTGFic0FwaSwgeyBWb2ljZVNldHRpbmdzIH0gZnJvbSBcInNyYy9lbGV2ZW5fbGFic19hcGlcIjtcbmltcG9ydCBFbGV2ZW5MYWJzUGx1Z2luIGZyb20gXCJtYWluXCI7XG5cbmZ1bmN0aW9uIGNyZWF0ZUF1ZGlvTm90ZShcbiAgICB2YXVsdDogVmF1bHQsXG4gICAgdGV4dDogc3RyaW5nLFxuICAgIGZpbGVuYW1lOiBzdHJpbmcsXG4gICAgdm9pY2VOYW1lOiBzdHJpbmcsXG4gICAgbW9kZWxOYW1lOiBzdHJpbmcsXG4gICAgZW5hYmxlZDogYm9vbGVhbixcbiAgICBzdGFiaWxpdHk6IG51bWJlcixcbiAgICBzaW1pbGFyaXR5Qm9vc3Q6IG51bWJlcixcbiAgICBkYXRlOiBEYXRlLFxuICAgIG5vdGVQYXRoOiBzdHJpbmcgfCB1bmRlZmluZWRcbikge1xuICAgIGNvbnN0IGNvbnRlbnQgPSBgXG4qKlZvaWNlOioqICR7dm9pY2VOYW1lfVxuKipNb2RlbDoqKiAke21vZGVsTmFtZX1cbioqQ3JlYXRlZDoqKiAke2RhdGUudG9Mb2NhbGVTdHJpbmcoKX1cbioqVm9pY2UgU2V0dGluZ3MgRW5hYmxlZDoqKiAke2VuYWJsZWR9XG4qKlN0YWJpbGl0eToqKiAke3N0YWJpbGl0eX1cbioqU2ltaWxhcml0eSBCb29zdDoqKiAke3NpbWlsYXJpdHlCb29zdH1cbioqTm90ZToqKiBbWyR7bm90ZVBhdGh9XV1cblxuJHt0ZXh0LnNwbGl0KFwiXFxuXCIpLm1hcChsaW5lID0+IGA+ICR7bGluZX1gKS5qb2luKFwiXFxuXCIpfVxuXG4hW1tFbGV2ZW5MYWJzL0F1ZGlvLyR7ZmlsZW5hbWV9Lm1wM11dXG5cbi0tLVxuYDtcbiAgICB2YXVsdC5jcmVhdGUoYEVsZXZlbkxhYnMvJHtmaWxlbmFtZX0ubWRgLCBjb250ZW50KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQXVkaW9GaWxlKHZhdWx0OiBWYXVsdCwgZmlsZW5hbWU6IHN0cmluZywgZGF0YTogYW55KSB7XG4gICAgdmF1bHQuY3JlYXRlQmluYXJ5KGBFbGV2ZW5MYWJzL0F1ZGlvLyR7ZmlsZW5hbWV9Lm1wM2AsIGRhdGEpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVBdWRpbyhcbiAgICBwbHVnaW46IEVsZXZlbkxhYnNQbHVnaW4sXG4gICAgdGV4dDogc3RyaW5nLFxuICAgIHZvaWNlTmFtZTogc3RyaW5nLFxuICAgIHZvaWNlSWQ6IHN0cmluZyxcbiAgICBtb2RlbE5hbWU6IHN0cmluZyxcbiAgICBtb2RlbElkOiBzdHJpbmcsXG4gICAgZW5hYmxlZDogYm9vbGVhbixcbiAgICBzdGFiaWxpdHk6IG51bWJlcixcbiAgICBzaW1pbGFyaXR5Qm9vc3Q6IG51bWJlclxuKSB7XG4gICAgbGV0IHZvaWNlU2V0dGluZ3M6IFZvaWNlU2V0dGluZ3MgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG4gICAgaWYgKGVuYWJsZWQpIHtcbiAgICAgICAgdm9pY2VTZXR0aW5ncyA9IHtcbiAgICAgICAgICAgIHN0YWJpbGl0eTogc3RhYmlsaXR5LFxuICAgICAgICAgICAgc2ltaWxhcml0eV9ib29zdDogc2ltaWxhcml0eUJvb3N0LFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgIGNvbnN0IG5vdGVQYXRoID0gYWN0aXZlVmlldz8uZmlsZT8uYmFzZW5hbWU7XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IEVsZXZlbkxhYnNBcGkudGV4dFRvU3BlZWNoKFxuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLmFwaUtleSxcbiAgICAgICAgICAgIHRleHQsXG4gICAgICAgICAgICB2b2ljZUlkLFxuICAgICAgICAgICAgbW9kZWxJZCxcbiAgICAgICAgICAgIHZvaWNlU2V0dGluZ3NcbiAgICAgICAgKTtcblxuICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG5cbiAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGNvbnN0IGZpbGVuYW1lID0gZ2VuZXJhdGVGaWxlbmFtZSh2b2ljZU5hbWUsIGRhdGUpO1xuXG4gICAgICAgIGNyZWF0ZUF1ZGlvRmlsZShwbHVnaW4uYXBwLnZhdWx0LCBmaWxlbmFtZSwgcmVzcG9uc2UuYXJyYXlCdWZmZXIpO1xuICAgICAgICBjcmVhdGVBdWRpb05vdGUoXG4gICAgICAgICAgICBwbHVnaW4uYXBwLnZhdWx0LFxuICAgICAgICAgICAgdGV4dCxcbiAgICAgICAgICAgIGZpbGVuYW1lLFxuICAgICAgICAgICAgdm9pY2VOYW1lLFxuICAgICAgICAgICAgbW9kZWxOYW1lLFxuICAgICAgICAgICAgZW5hYmxlZCxcbiAgICAgICAgICAgIHN0YWJpbGl0eSxcbiAgICAgICAgICAgIHNpbWlsYXJpdHlCb29zdCxcbiAgICAgICAgICAgIGRhdGUsXG4gICAgICAgICAgICBub3RlUGF0aFxuICAgICAgICApO1xuICAgICAgICBuZXcgTm90aWNlKGBFbGV2ZW4gTGFiczogQ3JlYXRlZCBhdWRpbyBmaWxlICgke2ZpbGVuYW1lfSlgLCA1MDAwKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFZhdWx0IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZUZpbGVuYW1lKHZvaWNlTmFtZTogc3RyaW5nLCBkYXRlOiBEYXRlKSB7XG4gICAgY29uc3QgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICBjb25zdCBtb250aCA9IChkYXRlLmdldE1vbnRoKCkgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsIFwiMFwiKTtcbiAgICBjb25zdCBkYXkgPSBkYXRlLmdldERhdGUoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsIFwiMFwiKTtcbiAgICBjb25zdCBob3VyID0gZGF0ZS5nZXRIb3VycygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpO1xuICAgIGNvbnN0IG1pbnV0ZXMgPSBkYXRlLmdldE1pbnV0ZXMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsIFwiMFwiKTtcbiAgICBjb25zdCBzZWNvbmRzID0gZGF0ZS5nZXRTZWNvbmRzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCBcIjBcIik7XG4gICAgcmV0dXJuIGAke3llYXJ9LSR7bW9udGh9LSR7ZGF5fV8ke2hvdXJ9LSR7bWludXRlc30tJHtzZWNvbmRzfV8ke3ZvaWNlTmFtZX1gO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVmF1bHREaXJlY3Rvcmllcyh2YXVsdDogVmF1bHQsIGRpcmVjdG9yaWVzOiBzdHJpbmdbXSkge1xuICAgIGRpcmVjdG9yaWVzLmZvckVhY2goKGRpcmVjdG9yeSkgPT4ge1xuICAgICAgICBpZiAoIXZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChkaXJlY3RvcnkpKSB7XG4gICAgICAgICAgICB2YXVsdC5jcmVhdGVGb2xkZXIoZGlyZWN0b3J5KTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuIiwgImltcG9ydCBFbGV2ZW5MYWJzUGx1Z2luIGZyb20gXCJtYWluXCI7XG5pbXBvcnQge1xuICAgIEJ1dHRvbkNvbXBvbmVudCxcbiAgICBEcm9wZG93bkNvbXBvbmVudCxcbiAgICBTbGlkZXJDb21wb25lbnQsXG4gICAgVGV4dEFyZWFDb21wb25lbnQsXG4gICAgVG9nZ2xlQ29tcG9uZW50LFxufSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IFZvaWNlU2V0dGluZ3MsIERFRkFVTFRfTU9ERUxfSUQgfSBmcm9tIFwic3JjL3NldHRpbmdzXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJHZW5lcmF0ZUF1ZGlvQnV0dG9uKFxuICAgIHBhcmVudDogSFRNTEVsZW1lbnQsXG4gICAgY2FsbGJhY2s6ICgpID0+IHZvaWRcbikge1xuICAgIC8vIEdlbmVyYXRlIGF1ZGlvIGJ1dHRvblxuICAgIG5ldyBCdXR0b25Db21wb25lbnQocGFyZW50KVxuICAgICAgICAuc2V0Q2xhc3MoXCJidG4tZ2VuZXJhdGUtYXVkaW9cIilcbiAgICAgICAgLnNldEJ1dHRvblRleHQoXCJHZW5lcmF0ZSBhdWRpb1wiKVxuICAgICAgICAub25DbGljayhjYWxsYmFjayk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJNb2RlbExhbmd1YWdlQ2hpcHMoXG4gICAgcGx1Z2luOiBFbGV2ZW5MYWJzUGx1Z2luLFxuICAgIHBhcmVudDogSFRNTEVsZW1lbnQsXG4pIHtcbiAgICBwYXJlbnQuZW1wdHkoKTtcbiAgICBjb25zdCBtb2RlbHM6IGFueVtdID0gcGx1Z2luLm1vZGVscztcbiAgICBjb25zdCBzZWxlY3RlZE1vZGVsSWQ6IHN0cmluZyA9IHBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZE1vZGVsSWQgfHwgREVGQVVMVF9NT0RFTF9JRDtcbiAgICBjb25zdCBzZWxlY3RlZE1vZGVsID0gbW9kZWxzLmZpbmQoXG4gICAgICAgIChtb2RlbCkgPT4gbW9kZWwubW9kZWxfaWQgPT09IHNlbGVjdGVkTW9kZWxJZFxuICAgICk7XG4gICAgY29uc3QgbGFuZ3VhZ2VzOiBzdHJpbmdbXSA9IHNlbGVjdGVkTW9kZWwubGFuZ3VhZ2VzLm1hcCgobGFuZ3VhZ2U6IGFueSk6IHN0cmluZyA9PiB7IHJldHVybiBsYW5ndWFnZS5uYW1lIH0pO1xuICAgIGxhbmd1YWdlcy5mb3JFYWNoKChsYW5ndWFnZTogc3RyaW5nKSA9PiB7XG4gICAgICAgIHBhcmVudC5jcmVhdGVFbChcInNwYW5cIiwge1xuICAgICAgICAgICAgdGV4dDogbGFuZ3VhZ2UsXG4gICAgICAgICAgICBjbHM6IFwibGFuZ3VhZ2UtY2hpcFwiLFxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlclZvaWNlU2V0dGluZ3MoXG4gICAgcGx1Z2luOiBFbGV2ZW5MYWJzUGx1Z2luLFxuICAgIHBhcmVudDogSFRNTEVsZW1lbnRcbikge1xuICAgIHBhcmVudC5lbXB0eSgpO1xuXG4gICAgY29uc3Qgc2VsZWN0ZWRWb2ljZUlkID0gcGx1Z2luLnNldHRpbmdzLnNlbGVjdGVkVm9pY2VJZCB8fCBcIlwiO1xuXG4gICAgbGV0IHZvaWNlU2V0dGluZ3M6IFZvaWNlU2V0dGluZ3MgPVxuICAgICAgICBwbHVnaW4uc2V0dGluZ3Mudm9pY2VTZXR0aW5nc1tzZWxlY3RlZFZvaWNlSWRdO1xuICAgIGlmICh2b2ljZVNldHRpbmdzID09IHVuZGVmaW5lZCkge1xuICAgICAgICB2b2ljZVNldHRpbmdzID0ge1xuICAgICAgICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgICAgICAgICBzdGFiaWxpdHk6IDAsXG4gICAgICAgICAgICBzaW1pbGFyaXR5X2Jvb3N0OiAwLFxuICAgICAgICB9O1xuICAgICAgICBwbHVnaW4uc2V0dGluZ3Mudm9pY2VTZXR0aW5nc1tzZWxlY3RlZFZvaWNlSWRdID0gdm9pY2VTZXR0aW5ncztcbiAgICB9XG5cbiAgICBwYXJlbnQuY3JlYXRlRWwoXCJoNlwiLCB7IHRleHQ6IFwiVm9pY2Ugc2V0dGluZ3NcIiB9KTtcbiAgICBjb25zdCB2b2ljZVNldHRpbmdzVG9nZ2xlID0gbmV3IFRvZ2dsZUNvbXBvbmVudChwYXJlbnQpXG4gICAgICAgIC5zZXRWYWx1ZSh2b2ljZVNldHRpbmdzLmVuYWJsZWQpXG4gICAgICAgIC5zZXRUb29sdGlwKFwiRW5hYmxlIHZvaWNlIHNldHRpbmdzXCIpXG4gICAgICAgIC5vbkNoYW5nZSgodmFsdWUpID0+IHtcbiAgICAgICAgICAgIHZvaWNlU2V0dGluZ3NDb250YWluZXIudG9nZ2xlKHZhbHVlKTtcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy52b2ljZVNldHRpbmdzW3NlbGVjdGVkVm9pY2VJZF1bXCJlbmFibGVkXCJdID0gdmFsdWU7XG4gICAgICAgIH0pO1xuICAgIGNvbnN0IHZvaWNlU2V0dGluZ3NDb250YWluZXIgPSBwYXJlbnQuY3JlYXRlRGl2KFwidm9pY2Utc2V0dGluZ3MtY29udGFpbmVyXCIpO1xuICAgIHZvaWNlU2V0dGluZ3NDb250YWluZXIuY3JlYXRlRGl2KHtcbiAgICAgICAgY2xzOiBcInZvaWNlLXNldHRpbmdzLWRlc2NyaXB0aW9uXCIsXG4gICAgICAgIHRleHQ6IFwiVGhlc2Ugc2V0dGluZ3Mgd2lsbCBvdmVycmlkZSB0aGUgc3RvcmVkIHNldHRpbmdzIGZvciB0aGlzIHZvaWNlLiBUaGV5IG9ubHkgYXBwbHkgdG8gdGhpcyBhdWRpbyBmaWxlLlwiLFxuICAgIH0pO1xuXG4gICAgdm9pY2VTZXR0aW5nc0NvbnRhaW5lci50b2dnbGUodm9pY2VTZXR0aW5ncy5lbmFibGVkKTtcblxuICAgIGNvbnN0IHN0YWJpbGl0eUluaXRpYWxWYWx1ZSA9XG4gICAgICAgIHBsdWdpbi5zZXR0aW5ncy52b2ljZVNldHRpbmdzW3NlbGVjdGVkVm9pY2VJZF1bXCJzdGFiaWxpdHlcIl0gfHwgMDtcblxuICAgIGNvbnN0IHN0YWJpbGl0eUVsID0gdm9pY2VTZXR0aW5nc0NvbnRhaW5lci5jcmVhdGVFbChcImRpdlwiLCB7XG4gICAgICAgIHRleHQ6IGBTdGFiaWxpdHk6ICR7c3RhYmlsaXR5SW5pdGlhbFZhbHVlfWAsXG4gICAgfSk7XG4gICAgY29uc3Qgc3RhYmlsaXR5U2xpZGVyID0gbmV3IFNsaWRlckNvbXBvbmVudCh2b2ljZVNldHRpbmdzQ29udGFpbmVyKVxuICAgICAgICAuc2V0VmFsdWUoc3RhYmlsaXR5SW5pdGlhbFZhbHVlKSAvLyBTZXRzIGluaXRpYWwgdmFsdWVcbiAgICAgICAgLnNldExpbWl0cygwLCAxMDAsIDEpIC8vIE1pbmltdW0sIE1heGltdW0sIFN0ZXBcbiAgICAgICAgLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgc3RhYmlsaXR5RWwuc2V0VGV4dChgU3RhYmlsaXR5OiAke3ZhbHVlfWApO1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLnZvaWNlU2V0dGluZ3Nbc2VsZWN0ZWRWb2ljZUlkXVtcInN0YWJpbGl0eVwiXSA9IHZhbHVlO1xuICAgICAgICB9KTtcblxuICAgIGNvbnN0IHNpbWlsYXJpdHlCb29zdEluaXRpYWxWYWx1ZSA9XG4gICAgICAgIHBsdWdpbi5zZXR0aW5ncy52b2ljZVNldHRpbmdzW3NlbGVjdGVkVm9pY2VJZF1bXCJzaW1pbGFyaXR5X2Jvb3N0XCJdIHx8IDA7XG5cbiAgICBjb25zdCBzaW1pbGFyaXR5RWwgPSB2b2ljZVNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHtcbiAgICAgICAgdGV4dDogYFNpbWlsYXJpdHkgYm9vc3Q6ICR7c2ltaWxhcml0eUJvb3N0SW5pdGlhbFZhbHVlfWAsXG4gICAgfSk7XG4gICAgLy8gQWRkIGEgc2xpZGVyXG4gICAgY29uc3Qgc2ltaWxhcml0eVNsaWRlciA9IG5ldyBTbGlkZXJDb21wb25lbnQodm9pY2VTZXR0aW5nc0NvbnRhaW5lcilcbiAgICAgICAgLnNldFZhbHVlKHNpbWlsYXJpdHlCb29zdEluaXRpYWxWYWx1ZSkgLy8gU2V0cyBpbml0aWFsIHZhbHVlXG4gICAgICAgIC5zZXRMaW1pdHMoMCwgMTAwLCAxKSAvLyBNaW5pbXVtLCBNYXhpbXVtLCBTdGVwXG4gICAgICAgIC5vbkNoYW5nZSgodmFsdWUpID0+IHtcbiAgICAgICAgICAgIHNpbWlsYXJpdHlFbC5zZXRUZXh0KGBTaW1pbGFyaXR5IGJvb3N0OiAke3ZhbHVlfWApO1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLnZvaWNlU2V0dGluZ3Nbc2VsZWN0ZWRWb2ljZUlkXVtcInNpbWlsYXJpdHlfYm9vc3RcIl0gPVxuICAgICAgICAgICAgICAgIHZhbHVlO1xuICAgICAgICB9KTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIHZvaWNlU2V0dGluZ3NUb2dnbGUsXG4gICAgICAgIHN0YWJpbGl0eVNsaWRlcixcbiAgICAgICAgc2ltaWxhcml0eVNsaWRlcixcbiAgICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyVGV4dFNlY3Rpb24ocGFyZW50OiBIVE1MRWxlbWVudCwgc2VsZWN0ZWRUZXh0OiBzdHJpbmcpIHtcbiAgICBwYXJlbnQuY3JlYXRlRGl2KFwiZWxldmVuLWxhYnMtdGV4dC1hcmVhXCIsIChlbCkgPT4ge1xuICAgICAgICAvLyBUaXRsZVxuICAgICAgICBlbC5jcmVhdGVFbChcImg2XCIsIHsgdGV4dDogXCJUZXh0XCIgfSk7XG5cbiAgICAgICAgLy8gVGV4dCBhcmVhXG4gICAgICAgIG5ldyBUZXh0QXJlYUNvbXBvbmVudChlbClcbiAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIkVudGVyIHRleHQgaGVyZVwiKVxuICAgICAgICAgICAgLnNldFZhbHVlKHNlbGVjdGVkVGV4dClcbiAgICAgICAgICAgIC5zZXREaXNhYmxlZCh0cnVlKTtcblxuICAgICAgICAvLyBDaGFyYWN0ZXIgY291bnRcbiAgICAgICAgY29uc3QgY2hhckNvdW50RWwgPSBlbC5jcmVhdGVEaXYoXCJjaGFyLWNvdW50XCIpO1xuICAgICAgICBjaGFyQ291bnRFbC5zZXRUZXh0KGBDaGFyYWN0ZXJzOiAke3NlbGVjdGVkVGV4dC5sZW5ndGh9YCk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGFkZFZvaWNlc1RvT3B0aW9uR3JvdXAoXG4gICAgdm9pY2VzOiBhbnlbXSxcbiAgICBvcHRncm91cEVsOiBIVE1MRWxlbWVudCxcbiAgICBzZWxlY3RlZFZvaWNlSWQ6IHN0cmluZ1xuKSB7XG4gICAgdm9pY2VzLmZvckVhY2goKHZvaWNlKSA9PiB7XG4gICAgICAgIGNvbnN0IG9wdGlvbkVsID0gb3B0Z3JvdXBFbC5jcmVhdGVFbChcIm9wdGlvblwiLCB7XG4gICAgICAgICAgICB0ZXh0OiB2b2ljZS5uYW1lLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWNlLnZvaWNlX2lkLFxuICAgICAgICB9KTtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBvcHRpb24gd2FzIHRoZSBwcmV2aW91c2x5IHNlbGVjdGVkIG9wdGlvblxuICAgICAgICBpZiAodm9pY2Uudm9pY2VfaWQgPT09IHNlbGVjdGVkVm9pY2VJZCkge1xuICAgICAgICAgICAgb3B0aW9uRWwuc2V0QXR0cmlidXRlKFwic2VsZWN0ZWRcIiwgXCJzZWxlY3RlZFwiKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBhZGRDYXRlZ29yeShcbiAgICBzZWxlY3RFbDogSFRNTEVsZW1lbnQsXG4gICAgbGFiZWw6IHN0cmluZyxcbiAgICB2b2ljZXM6IGFueVtdIHwgdW5kZWZpbmVkLFxuICAgIHNlbGVjdGVkVm9pY2VJZDogc3RyaW5nXG4pIHtcbiAgICBpZiAodm9pY2VzKSB7XG4gICAgICAgIGNvbnN0IG9wdGdyb3VwRWwgPSBzZWxlY3RFbC5jcmVhdGVFbChcIm9wdGdyb3VwXCIpO1xuICAgICAgICBvcHRncm91cEVsLmxhYmVsID0gbGFiZWw7XG4gICAgICAgIGFkZFZvaWNlc1RvT3B0aW9uR3JvdXAodm9pY2VzLCBvcHRncm91cEVsLCBzZWxlY3RlZFZvaWNlSWQpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gdm9pY2VzR3JvdXBlZEJ5Q2F0ZWdvcnkodm9pY2VzOiBhbnlbXSkge1xuICAgIHJldHVybiB2b2ljZXMucmVkdWNlKChhY2MsIHZvaWNlKSA9PiB7XG4gICAgICAgIC8vIElmIHRoZSBjYXRlZ29yeSBoYXNuJ3QgYmVlbiBzZWVuIGJlZm9yZSwgY3JlYXRlIGFuIGVtcHR5IGFycmF5IGZvciBpdFxuICAgICAgICBpZiAoIWFjYy5oYXModm9pY2UuY2F0ZWdvcnkpKSB7XG4gICAgICAgICAgICBhY2Muc2V0KHZvaWNlLmNhdGVnb3J5LCBbXSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBQdXNoIHRoZSBjdXJyZW50IHZvaWNlIHRvIGl0cyBjYXRlZ29yeSBhcnJheVxuICAgICAgICBhY2MuZ2V0KHZvaWNlLmNhdGVnb3J5KS5wdXNoKHZvaWNlKTtcblxuICAgICAgICByZXR1cm4gYWNjO1xuICAgIH0sIG5ldyBNYXAoKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJWb2ljZVNlbGVjdChcbiAgICBwbHVnaW46IEVsZXZlbkxhYnNQbHVnaW4sXG4gICAgcGFyZW50OiBIVE1MRWxlbWVudCxcbiAgICBvblZvaWNlU2VsZWN0ZWQ6ICgpID0+IHZvaWRcbik6IEhUTUxTZWxlY3RFbGVtZW50IHtcbiAgICBjb25zdCB2b2ljZXM6IGFueVtdID0gcGx1Z2luLnZvaWNlcztcbiAgICBjb25zdCBzZWxlY3RlZFZvaWNlSWQ6IHN0cmluZyA9IHBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZFZvaWNlSWQgfHwgXCJcIjtcbiAgICByZXR1cm4gcGFyZW50LmNyZWF0ZUVsKFwic2VsZWN0XCIsIFwiZHJvcGRvd25cIiwgKHNlbGVjdEVsKSA9PiB7XG4gICAgICAgIC8vIEFkZCBkZWZhdWx0IHByb21wdCBvcHRpb25cbiAgICAgICAgY29uc3QgZGVmYXVsdE9wdGlvbkVsID0gc2VsZWN0RWwuY3JlYXRlRWwoXCJvcHRpb25cIiwge1xuICAgICAgICAgICAgdGV4dDogXCJTZWxlY3QgYSB2b2ljZVwiLFxuICAgICAgICB9KTtcbiAgICAgICAgZGVmYXVsdE9wdGlvbkVsLnNldEF0dHJpYnV0ZShcInNlbGVjdGVkXCIsIFwic2VsZWN0ZWRcIik7XG4gICAgICAgIGRlZmF1bHRPcHRpb25FbC5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBcImRpc2FibGVkXCIpO1xuXG4gICAgICAgIC8vIEFkZCB2b2ljZXMgdG8gZHJvcGRvd24gKGdyb3VwZWQgYnkgY2F0ZWdvcnkpXG4gICAgICAgIGNvbnN0IGdyb3VwZWRCeUNhdGVnb3J5OiBNYXA8c3RyaW5nLCBhbnlbXT4gPVxuICAgICAgICAgICAgdm9pY2VzR3JvdXBlZEJ5Q2F0ZWdvcnkodm9pY2VzKTtcblxuICAgICAgICBhZGRDYXRlZ29yeShcbiAgICAgICAgICAgIHNlbGVjdEVsLFxuICAgICAgICAgICAgXCJDbG9uZWRcIixcbiAgICAgICAgICAgIGdyb3VwZWRCeUNhdGVnb3J5LmdldChcImNsb25lZFwiKSxcbiAgICAgICAgICAgIHNlbGVjdGVkVm9pY2VJZFxuICAgICAgICApO1xuICAgICAgICBhZGRDYXRlZ29yeShcbiAgICAgICAgICAgIHNlbGVjdEVsLFxuICAgICAgICAgICAgXCJHZW5lcmF0ZWRcIixcbiAgICAgICAgICAgIGdyb3VwZWRCeUNhdGVnb3J5LmdldChcImdlbmVyYXRlZFwiKSxcbiAgICAgICAgICAgIHNlbGVjdGVkVm9pY2VJZFxuICAgICAgICApO1xuICAgICAgICBhZGRDYXRlZ29yeShcbiAgICAgICAgICAgIHNlbGVjdEVsLFxuICAgICAgICAgICAgXCJQcmVtYWRlXCIsXG4gICAgICAgICAgICBncm91cGVkQnlDYXRlZ29yeS5nZXQoXCJwcmVtYWRlXCIpLFxuICAgICAgICAgICAgc2VsZWN0ZWRWb2ljZUlkXG4gICAgICAgICk7XG5cbiAgICAgICAgc2VsZWN0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCAoXykgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRPcHRpb24gPSBzZWxlY3RFbC52YWx1ZTtcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZFZvaWNlSWQgPSBzZWxlY3RlZE9wdGlvbjtcbiAgICAgICAgICAgIHBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIG9uVm9pY2VTZWxlY3RlZCgpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlck1vZGVsU2VsZWN0KFxuICAgIHBsdWdpbjogRWxldmVuTGFic1BsdWdpbixcbiAgICBwYXJlbnQ6IEhUTUxFbGVtZW50LFxuICAgIG9uTW9kZWxTZWxlY3RlZDogKCkgPT4gdm9pZFxuKTogSFRNTFNlbGVjdEVsZW1lbnQge1xuICAgIGNvbnN0IG1vZGVsczogYW55W10gPSBwbHVnaW4ubW9kZWxzO1xuICAgIGNvbnN0IHNlbGVjdGVkTW9kZWxJZDogc3RyaW5nID0gcGx1Z2luLnNldHRpbmdzLnNlbGVjdGVkTW9kZWxJZCB8fCBcIlwiO1xuXG4gICAgY29uc3Qgb3B0aW9uczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IG1vZGVscy5yZWR1Y2UoKGFjYywgb2JqKSA9PiB7XG4gICAgICAgIGFjY1tvYmoubW9kZWxfaWRdID0gb2JqLm5hbWU7XG4gICAgICAgIHJldHVybiBhY2M7XG4gICAgfSwge30gYXMgUmVjb3JkPHN0cmluZywgc3RyaW5nPik7XG5cbiAgICBjb25zdCBkcm9wZG93biA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChwYXJlbnQpXG4gICAgICAgIC5hZGRPcHRpb25zKG9wdGlvbnMpXG4gICAgICAgIC5zZXRWYWx1ZShzZWxlY3RlZE1vZGVsSWQgfHwgREVGQVVMVF9NT0RFTF9JRClcbiAgICAgICAgLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgcGx1Z2luLnNldHRpbmdzLnNlbGVjdGVkTW9kZWxJZCA9IHZhbHVlO1xuICAgICAgICAgICAgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgb25Nb2RlbFNlbGVjdGVkKCk7XG4gICAgICAgIH0pO1xuXG4gICAgZHJvcGRvd24uc2VsZWN0RWwuY2xhc3NMaXN0LmFkZChcImVsZXZlbi1sYWJzLW1vZGVsLXNlbGVjdFwiKTtcblxuICAgIHJldHVybiBkcm9wZG93bi5zZWxlY3RFbDtcbn1c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QWE7QUFDZixRQUFJO0FBQ0EsWUFBTSxXQUFXLE1BQU0sd0JBQWM7QUFBQSxRQUNqQyxLQUFLLFNBQVM7QUFBQSxNQUNsQjtBQUNBLFdBQUssU0FBUyxTQUFTLEtBQUs7QUFBQSxRQUN4QixDQUFDLE1BQVcsRUFBRTtBQUFBLE1BQ2xCO0FBQUEsSUFDSixTQUFTLE9BQVA7QUFDRSxjQUFRLElBQUksS0FBSztBQUFBLElBQ3JCO0FBQUEsRUFDSjtBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQ2pCLFNBQUssV0FBVyxPQUFPO0FBQUEsTUFDbkIsQ0FBQztBQUFBLE1BQ0Q7QUFBQSxNQUNBLE1BQU0sS0FBSyxTQUFTO0FBQUEsSUFDeEI7QUFBQSxFQUNKO0FBQUEsRUFFQSxNQUFNLGVBQWU7QUFDakIsVUFBTSxLQUFLLFNBQVMsS0FBSyxRQUFRO0FBQUEsRUFDckM7QUFDSjsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiJdCn0K
