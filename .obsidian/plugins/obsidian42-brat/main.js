"use strict";var Qt=Object.create;var ge=Object.defineProperty;var Jt=Object.getOwnPropertyDescriptor;var Zt=Object.getOwnPropertyNames;var es=Object.getPrototypeOf,ts=Object.prototype.hasOwnProperty;var $=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),ss=(i,e)=>{for(var t in e)ge(i,t,{get:e[t],enumerable:!0})},We=(i,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Zt(e))!ts.call(i,n)&&n!==t&&ge(i,n,{get:()=>e[n],enumerable:!(s=Jt(e,n))||s.enumerable});return i};var is=(i,e,t)=>(t=i!=null?Qt(es(i)):{},We(e||!i||!i.__esModule?ge(t,"default",{value:i,enumerable:!0}):t,i)),ns=i=>We(ge({},"__esModule",{value:!0}),i);var De=$((ai,Qe)=>{"use strict";var os=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...i)=>console.error("SEMVER",...i):()=>{};Qe.exports=os});var xe=$((li,Je)=>{"use strict";var rs="2.0.0",as=Number.MAX_SAFE_INTEGER||9007199254740991,ls=16,us=250,cs=["major","premajor","minor","preminor","patch","prepatch","prerelease"];Je.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:ls,MAX_SAFE_BUILD_LENGTH:us,MAX_SAFE_INTEGER:as,RELEASE_TYPES:cs,SEMVER_SPEC_VERSION:rs,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var Oe=$((O,Ze)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:$e,MAX_SAFE_BUILD_LENGTH:gs,MAX_LENGTH:ds}=xe(),ps=De();O=Ze.exports={};var ms=O.re=[],hs=O.safeRe=[],m=O.src=[],fs=O.safeSrc=[],h=O.t={},bs=0,Se="[a-zA-Z0-9-]",ws=[["\\s",1],["\\d",ds],[Se,gs]],Ts=i=>{for(let[e,t]of ws)i=i.split(`${e}*`).join(`${e}{0,${t}}`).split(`${e}+`).join(`${e}{1,${t}}`);return i},T=(i,e,t)=>{let s=Ts(e),n=bs++;ps(i,n,e),h[i]=n,m[n]=e,fs[n]=s,ms[n]=new RegExp(e,t?"g":void 0),hs[n]=new RegExp(s,t?"g":void 0)};T("NUMERICIDENTIFIER","0|[1-9]\\d*");T("NUMERICIDENTIFIERLOOSE","\\d+");T("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${Se}*`);T("MAINVERSION",`(${m[h.NUMERICIDENTIFIER]})\\.(${m[h.NUMERICIDENTIFIER]})\\.(${m[h.NUMERICIDENTIFIER]})`);T("MAINVERSIONLOOSE",`(${m[h.NUMERICIDENTIFIERLOOSE]})\\.(${m[h.NUMERICIDENTIFIERLOOSE]})\\.(${m[h.NUMERICIDENTIFIERLOOSE]})`);T("PRERELEASEIDENTIFIER",`(?:${m[h.NONNUMERICIDENTIFIER]}|${m[h.NUMERICIDENTIFIER]})`);T("PRERELEASEIDENTIFIERLOOSE",`(?:${m[h.NONNUMERICIDENTIFIER]}|${m[h.NUMERICIDENTIFIERLOOSE]})`);T("PRERELEASE",`(?:-(${m[h.PRERELEASEIDENTIFIER]}(?:\\.${m[h.PRERELEASEIDENTIFIER]})*))`);T("PRERELEASELOOSE",`(?:-?(${m[h.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${m[h.PRERELEASEIDENTIFIERLOOSE]})*))`);T("BUILDIDENTIFIER",`${Se}+`);T("BUILD",`(?:\\+(${m[h.BUILDIDENTIFIER]}(?:\\.${m[h.BUILDIDENTIFIER]})*))`);T("FULLPLAIN",`v?${m[h.MAINVERSION]}${m[h.PRERELEASE]}?${m[h.BUILD]}?`);T("FULL",`^${m[h.FULLPLAIN]}$`);T("LOOSEPLAIN",`[v=\\s]*${m[h.MAINVERSIONLOOSE]}${m[h.PRERELEASELOOSE]}?${m[h.BUILD]}?`);T("LOOSE",`^${m[h.LOOSEPLAIN]}$`);T("GTLT","((?:<|>)?=?)");T("XRANGEIDENTIFIERLOOSE",`${m[h.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);T("XRANGEIDENTIFIER",`${m[h.NUMERICIDENTIFIER]}|x|X|\\*`);T("XRANGEPLAIN",`[v=\\s]*(${m[h.XRANGEIDENTIFIER]})(?:\\.(${m[h.XRANGEIDENTIFIER]})(?:\\.(${m[h.XRANGEIDENTIFIER]})(?:${m[h.PRERELEASE]})?${m[h.BUILD]}?)?)?`);T("XRANGEPLAINLOOSE",`[v=\\s]*(${m[h.XRANGEIDENTIFIERLOOSE]})(?:\\.(${m[h.XRANGEIDENTIFIERLOOSE]})(?:\\.(${m[h.XRANGEIDENTIFIERLOOSE]})(?:${m[h.PRERELEASELOOSE]})?${m[h.BUILD]}?)?)?`);T("XRANGE",`^${m[h.GTLT]}\\s*${m[h.XRANGEPLAIN]}$`);T("XRANGELOOSE",`^${m[h.GTLT]}\\s*${m[h.XRANGEPLAINLOOSE]}$`);T("COERCEPLAIN",`(^|[^\\d])(\\d{1,${$e}})(?:\\.(\\d{1,${$e}}))?(?:\\.(\\d{1,${$e}}))?`);T("COERCE",`${m[h.COERCEPLAIN]}(?:$|[^\\d])`);T("COERCEFULL",m[h.COERCEPLAIN]+`(?:${m[h.PRERELEASE]})?(?:${m[h.BUILD]})?(?:$|[^\\d])`);T("COERCERTL",m[h.COERCE],!0);T("COERCERTLFULL",m[h.COERCEFULL],!0);T("LONETILDE","(?:~>?)");T("TILDETRIM",`(\\s*)${m[h.LONETILDE]}\\s+`,!0);O.tildeTrimReplace="$1~";T("TILDE",`^${m[h.LONETILDE]}${m[h.XRANGEPLAIN]}$`);T("TILDELOOSE",`^${m[h.LONETILDE]}${m[h.XRANGEPLAINLOOSE]}$`);T("LONECARET","(?:\\^)");T("CARETTRIM",`(\\s*)${m[h.LONECARET]}\\s+`,!0);O.caretTrimReplace="$1^";T("CARET",`^${m[h.LONECARET]}${m[h.XRANGEPLAIN]}$`);T("CARETLOOSE",`^${m[h.LONECARET]}${m[h.XRANGEPLAINLOOSE]}$`);T("COMPARATORLOOSE",`^${m[h.GTLT]}\\s*(${m[h.LOOSEPLAIN]})$|^$`);T("COMPARATOR",`^${m[h.GTLT]}\\s*(${m[h.FULLPLAIN]})$|^$`);T("COMPARATORTRIM",`(\\s*)${m[h.GTLT]}\\s*(${m[h.LOOSEPLAIN]}|${m[h.XRANGEPLAIN]})`,!0);O.comparatorTrimReplace="$1$2$3";T("HYPHENRANGE",`^\\s*(${m[h.XRANGEPLAIN]})\\s+-\\s+(${m[h.XRANGEPLAIN]})\\s*$`);T("HYPHENRANGELOOSE",`^\\s*(${m[h.XRANGEPLAINLOOSE]})\\s+-\\s+(${m[h.XRANGEPLAINLOOSE]})\\s*$`);T("STAR","(<|>)?=?\\s*\\*");T("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");T("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var tt=$((ui,et)=>{"use strict";var Es=Object.freeze({loose:!0}),ys=Object.freeze({}),vs=i=>i?typeof i!="object"?Es:i:ys;et.exports=vs});var ot=$((ci,nt)=>{"use strict";var st=/^[0-9]+$/,it=(i,e)=>{if(typeof i=="number"&&typeof e=="number")return i===e?0:i<e?-1:1;let t=st.test(i),s=st.test(e);return t&&s&&(i=+i,e=+e),i===e?0:t&&!s?-1:s&&!t?1:i<e?-1:1},Ps=(i,e)=>it(e,i);nt.exports={compareIdentifiers:it,rcompareIdentifiers:Ps}});var fe=$((gi,at)=>{"use strict";var de=De(),{MAX_LENGTH:rt,MAX_SAFE_INTEGER:pe}=xe(),{safeRe:me,t:he}=Oe(),Is=tt(),{compareIdentifiers:Fe}=ot(),Be=class i{constructor(e,t){if(t=Is(t),e instanceof i){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>rt)throw new TypeError(`version is longer than ${rt} characters`);de("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let s=e.trim().match(t.loose?me[he.LOOSE]:me[he.FULL]);if(!s)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>pe||this.major<0)throw new TypeError("Invalid major version");if(this.minor>pe||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>pe||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map(n=>{if(/^[0-9]+$/.test(n)){let o=+n;if(o>=0&&o<pe)return o}return n}):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(de("SemVer.compare",this.version,this.options,e),!(e instanceof i)){if(typeof e=="string"&&e===this.version)return 0;e=new i(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof i||(e=new i(e,this.options)),this.major<e.major?-1:this.major>e.major?1:this.minor<e.minor?-1:this.minor>e.minor?1:this.patch<e.patch?-1:this.patch>e.patch?1:0}comparePre(e){if(e instanceof i||(e=new i(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let s=this.prerelease[t],n=e.prerelease[t];if(de("prerelease compare",t,s,n),s===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(s===void 0)return-1;if(s===n)continue;return Fe(s,n)}while(++t)}compareBuild(e){e instanceof i||(e=new i(e,this.options));let t=0;do{let s=this.build[t],n=e.build[t];if(de("build compare",t,s,n),s===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(s===void 0)return-1;if(s===n)continue;return Fe(s,n)}while(++t)}inc(e,t,s){if(e.startsWith("pre")){if(!t&&s===!1)throw new Error("invalid increment argument: identifier is empty");if(t){let n=`-${t}`.match(this.options.loose?me[he.PRERELEASELOOSE]:me[he.PRERELEASE]);if(!n||n[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,s);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,s);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,s),this.inc("pre",t,s);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,s),this.inc("pre",t,s);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let n=Number(s)?1:0;if(this.prerelease.length===0)this.prerelease=[n];else{let o=this.prerelease.length;for(;--o>=0;)typeof this.prerelease[o]=="number"&&(this.prerelease[o]++,o=-2);if(o===-1){if(t===this.prerelease.join(".")&&s===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(n)}}if(t){let o=[t,n];s===!1&&(o=[t]),Fe(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=o):this.prerelease=o}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};at.exports=Be});var Me=$((di,ut)=>{"use strict";var lt=fe(),Rs=(i,e,t)=>new lt(i,t).compare(new lt(e,t));ut.exports=Rs});var dt=$((pi,gt)=>{"use strict";var ct=fe(),As=(i,e,t=!1)=>{if(i instanceof ct)return i;try{return new ct(i,e)}catch(s){if(!t)return null;throw s}};gt.exports=As});var Ve=$((mi,pt)=>{"use strict";var Cs=fe(),Ns=dt(),{safeRe:be,t:we}=Oe(),Ls=(i,e)=>{if(i instanceof Cs)return i;if(typeof i=="number"&&(i=String(i)),typeof i!="string")return null;e=e||{};let t=null;if(!e.rtl)t=i.match(e.includePrerelease?be[we.COERCEFULL]:be[we.COERCE]);else{let g=e.includePrerelease?be[we.COERCERTLFULL]:be[we.COERCERTL],c;for(;(c=g.exec(i))&&(!t||t.index+t[0].length!==i.length);)(!t||c.index+c[0].length!==t.index+t[0].length)&&(t=c),g.lastIndex=c.index+c[1].length+c[2].length;g.lastIndex=-1}if(t===null)return null;let s=t[2],n=t[3]||"0",o=t[4]||"0",a=e.includePrerelease&&t[5]?`-${t[5]}`:"",u=e.includePrerelease&&t[6]?`+${t[6]}`:"";return Ns(`${s}.${n}.${o}${a}${u}`,e)};pt.exports=Ls});var Xt=$(y=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0});var I=require("obsidian"),Ge="YYYY-MM-DD",je="gggg-[W]ww",St="YYYY-MM",Ot="YYYY-[Q]Q",Ft="YYYY";function se(i){var t,s;let e=window.app.plugins.getPlugin("periodic-notes");return e&&((s=(t=e.settings)==null?void 0:t[i])==null?void 0:s.enabled)}function ie(){var i,e,t,s;try{let{internalPlugins:n,plugins:o}=window.app;if(se("daily")){let{format:c,folder:r,template:l}=((e=(i=o.getPlugin("periodic-notes"))==null?void 0:i.settings)==null?void 0:e.daily)||{};return{format:c||Ge,folder:(r==null?void 0:r.trim())||"",template:(l==null?void 0:l.trim())||""}}let{folder:a,format:u,template:g}=((s=(t=n.getPluginById("daily-notes"))==null?void 0:t.instance)==null?void 0:s.options)||{};return{format:u||Ge,folder:(a==null?void 0:a.trim())||"",template:(g==null?void 0:g.trim())||""}}catch(n){console.info("No custom daily note settings found!",n)}}function ne(){var i,e,t,s,n,o,a;try{let u=window.app.plugins,g=(i=u.getPlugin("calendar"))==null?void 0:i.options,c=(t=(e=u.getPlugin("periodic-notes"))==null?void 0:e.settings)==null?void 0:t.weekly;if(se("weekly"))return{format:c.format||je,folder:((s=c.folder)==null?void 0:s.trim())||"",template:((n=c.template)==null?void 0:n.trim())||""};let r=g||{};return{format:r.weeklyNoteFormat||je,folder:((o=r.weeklyNoteFolder)==null?void 0:o.trim())||"",template:((a=r.weeklyNoteTemplate)==null?void 0:a.trim())||""}}catch(u){console.info("No custom weekly note settings found!",u)}}function oe(){var e,t,s,n;let i=window.app.plugins;try{let o=se("monthly")&&((t=(e=i.getPlugin("periodic-notes"))==null?void 0:e.settings)==null?void 0:t.monthly)||{};return{format:o.format||St,folder:((s=o.folder)==null?void 0:s.trim())||"",template:((n=o.template)==null?void 0:n.trim())||""}}catch(o){console.info("No custom monthly note settings found!",o)}}function re(){var e,t,s,n;let i=window.app.plugins;try{let o=se("quarterly")&&((t=(e=i.getPlugin("periodic-notes"))==null?void 0:e.settings)==null?void 0:t.quarterly)||{};return{format:o.format||Ot,folder:((s=o.folder)==null?void 0:s.trim())||"",template:((n=o.template)==null?void 0:n.trim())||""}}catch(o){console.info("No custom quarterly note settings found!",o)}}function ae(){var e,t,s,n;let i=window.app.plugins;try{let o=se("yearly")&&((t=(e=i.getPlugin("periodic-notes"))==null?void 0:e.settings)==null?void 0:t.yearly)||{};return{format:o.format||Ft,folder:((s=o.folder)==null?void 0:s.trim())||"",template:((n=o.template)==null?void 0:n.trim())||""}}catch(o){console.info("No custom yearly note settings found!",o)}}function Bt(...i){let e=[];for(let s=0,n=i.length;s<n;s++)e=e.concat(i[s].split("/"));let t=[];for(let s=0,n=e.length;s<n;s++){let o=e[s];!o||o==="."||t.push(o)}return e[0]===""&&t.unshift(""),t.join("/")}function Os(i){let e=i.substring(i.lastIndexOf("/")+1);return e.lastIndexOf(".")!=-1&&(e=e.substring(0,e.lastIndexOf("."))),e}async function Fs(i){let e=i.replace(/\\/g,"/").split("/");if(e.pop(),e.length){let t=Bt(...e);window.app.vault.getAbstractFileByPath(t)||await window.app.vault.createFolder(t)}}async function le(i,e){e.endsWith(".md")||(e+=".md");let t=I.normalizePath(Bt(i,e));return await Fs(t),t}async function q(i){let{metadataCache:e,vault:t}=window.app,s=I.normalizePath(i);if(s==="/")return Promise.resolve(["",null]);try{let n=e.getFirstLinkpathDest(s,""),o=await t.cachedRead(n),a=window.app.foldManager.load(n);return[o,a]}catch(n){return console.error(`Failed to read the daily note template '${s}'`,n),new I.Notice("Failed to read the daily note template"),["",null]}}function x(i,e="day"){let t=i.clone().startOf(e).format();return`${e}-${t}`}function Mt(i){return i.replace(/\[[^\]]*\]/g,"")}function Bs(i,e){if(e==="week"){let t=Mt(i);return/w{1,2}/i.test(t)&&(/M{1,4}/.test(t)||/D{1,4}/.test(t))}return!1}function z(i,e){return Vt(i.basename,e)}function Ms(i,e){return Vt(Os(i),e)}function Vt(i,e){let s={day:ie,week:ne,month:oe,quarter:re,year:ae}[e]().format.split("/").pop(),n=window.moment(i,s,!0);if(!n.isValid())return null;if(Bs(s,e)&&e==="week"){let o=Mt(s);if(/w{1,2}/i.test(o))return window.moment(i,s.replace(/M{1,4}/g,"").replace(/D{1,4}/g,""),!1)}return n}var qe=class extends Error{};async function Ut(i){let e=window.app,{vault:t}=e,s=window.moment,{template:n,format:o,folder:a}=ie(),[u,g]=await q(n),c=i.format(o),r=await le(a,c);try{let l=await t.create(r,u.replace(/{{\s*date\s*}}/gi,c).replace(/{{\s*time\s*}}/gi,s().format("HH:mm")).replace(/{{\s*title\s*}}/gi,c).replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(d,f,b,p,w,v)=>{let C=s(),P=i.clone().set({hour:C.get("hour"),minute:C.get("minute"),second:C.get("second")});return b&&P.add(parseInt(p,10),w),v?P.format(v.substring(1).trim()):P.format(o)}).replace(/{{\s*yesterday\s*}}/gi,i.clone().subtract(1,"day").format(o)).replace(/{{\s*tomorrow\s*}}/gi,i.clone().add(1,"d").format(o)));return e.foldManager.save(l,g),l}catch(l){console.error(`Failed to create file: '${r}'`,l),new I.Notice("Unable to create new file.")}}function Vs(i,e){var t;return(t=e[x(i,"day")])!=null?t:null}function Us(){let{vault:i}=window.app,{folder:e}=ie(),t=i.getAbstractFileByPath(I.normalizePath(e));if(!t)throw new qe("Failed to find daily notes folder");let s={};return I.Vault.recurseChildren(t,n=>{if(n instanceof I.TFile){let o=z(n,"day");if(o){let a=x(o,"day");s[a]=n}}}),s}var ze=class extends Error{};function Hs(){let{moment:i}=window,e=i.localeData()._week.dow,t=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(;e;)t.push(t.shift()),e--;return t}function _s(i){return Hs().indexOf(i.toLowerCase())}async function Ht(i){let{vault:e}=window.app,{template:t,format:s,folder:n}=ne(),[o,a]=await q(t),u=i.format(s),g=await le(n,u);try{let c=await e.create(g,o.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(r,l,d,f,b,p)=>{let w=window.moment(),v=i.clone().set({hour:w.get("hour"),minute:w.get("minute"),second:w.get("second")});return d&&v.add(parseInt(f,10),b),p?v.format(p.substring(1).trim()):v.format(s)}).replace(/{{\s*title\s*}}/gi,u).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*(sunday|monday|tuesday|wednesday|thursday|friday|saturday)\s*:(.*?)}}/gi,(r,l,d)=>{let f=_s(l);return i.weekday(f).format(d.trim())}));return window.app.foldManager.save(c,a),c}catch(c){console.error(`Failed to create file: '${g}'`,c),new I.Notice("Unable to create new file.")}}function Gs(i,e){var t;return(t=e[x(i,"week")])!=null?t:null}function js(){let i={};if(!Gt())return i;let{vault:e}=window.app,{folder:t}=ne(),s=e.getAbstractFileByPath(I.normalizePath(t));if(!s)throw new ze("Failed to find weekly notes folder");return I.Vault.recurseChildren(s,n=>{if(n instanceof I.TFile){let o=z(n,"week");if(o){let a=x(o,"week");i[a]=n}}}),i}var Xe=class extends Error{};async function _t(i){let{vault:e}=window.app,{template:t,format:s,folder:n}=oe(),[o,a]=await q(t),u=i.format(s),g=await le(n,u);try{let c=await e.create(g,o.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(r,l,d,f,b,p)=>{let w=window.moment(),v=i.clone().set({hour:w.get("hour"),minute:w.get("minute"),second:w.get("second")});return d&&v.add(parseInt(f,10),b),p?v.format(p.substring(1).trim()):v.format(s)}).replace(/{{\s*date\s*}}/gi,u).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,u));return window.app.foldManager.save(c,a),c}catch(c){console.error(`Failed to create file: '${g}'`,c),new I.Notice("Unable to create new file.")}}function qs(i,e){var t;return(t=e[x(i,"month")])!=null?t:null}function zs(){let i={};if(!jt())return i;let{vault:e}=window.app,{folder:t}=oe(),s=e.getAbstractFileByPath(I.normalizePath(t));if(!s)throw new Xe("Failed to find monthly notes folder");return I.Vault.recurseChildren(s,n=>{if(n instanceof I.TFile){let o=z(n,"month");if(o){let a=x(o,"month");i[a]=n}}}),i}var Ye=class extends Error{};async function Xs(i){let{vault:e}=window.app,{template:t,format:s,folder:n}=re(),[o,a]=await q(t),u=i.format(s),g=await le(n,u);try{let c=await e.create(g,o.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(r,l,d,f,b,p)=>{let w=window.moment(),v=i.clone().set({hour:w.get("hour"),minute:w.get("minute"),second:w.get("second")});return d&&v.add(parseInt(f,10),b),p?v.format(p.substring(1).trim()):v.format(s)}).replace(/{{\s*date\s*}}/gi,u).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,u));return window.app.foldManager.save(c,a),c}catch(c){console.error(`Failed to create file: '${g}'`,c),new I.Notice("Unable to create new file.")}}function Ys(i,e){var t;return(t=e[x(i,"quarter")])!=null?t:null}function Ks(){let i={};if(!qt())return i;let{vault:e}=window.app,{folder:t}=re(),s=e.getAbstractFileByPath(I.normalizePath(t));if(!s)throw new Ye("Failed to find quarterly notes folder");return I.Vault.recurseChildren(s,n=>{if(n instanceof I.TFile){let o=z(n,"quarter");if(o){let a=x(o,"quarter");i[a]=n}}}),i}var Ke=class extends Error{};async function Ws(i){let{vault:e}=window.app,{template:t,format:s,folder:n}=ae(),[o,a]=await q(t),u=i.format(s),g=await le(n,u);try{let c=await e.create(g,o.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(r,l,d,f,b,p)=>{let w=window.moment(),v=i.clone().set({hour:w.get("hour"),minute:w.get("minute"),second:w.get("second")});return d&&v.add(parseInt(f,10),b),p?v.format(p.substring(1).trim()):v.format(s)}).replace(/{{\s*date\s*}}/gi,u).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,u));return window.app.foldManager.save(c,a),c}catch(c){console.error(`Failed to create file: '${g}'`,c),new I.Notice("Unable to create new file.")}}function Qs(i,e){var t;return(t=e[x(i,"year")])!=null?t:null}function Js(){let i={};if(!zt())return i;let{vault:e}=window.app,{folder:t}=ae(),s=e.getAbstractFileByPath(I.normalizePath(t));if(!s)throw new Ke("Failed to find yearly notes folder");return I.Vault.recurseChildren(s,n=>{if(n instanceof I.TFile){let o=z(n,"year");if(o){let a=x(o,"year");i[a]=n}}}),i}function Zs(){var s,n;let{app:i}=window,e=i.internalPlugins.plugins["daily-notes"];if(e&&e.enabled)return!0;let t=i.plugins.getPlugin("periodic-notes");return t&&((n=(s=t.settings)==null?void 0:s.daily)==null?void 0:n.enabled)}function Gt(){var t,s;let{app:i}=window;if(i.plugins.getPlugin("calendar"))return!0;let e=i.plugins.getPlugin("periodic-notes");return e&&((s=(t=e.settings)==null?void 0:t.weekly)==null?void 0:s.enabled)}function jt(){var t,s;let{app:i}=window,e=i.plugins.getPlugin("periodic-notes");return e&&((s=(t=e.settings)==null?void 0:t.monthly)==null?void 0:s.enabled)}function qt(){var t,s;let{app:i}=window,e=i.plugins.getPlugin("periodic-notes");return e&&((s=(t=e.settings)==null?void 0:t.quarterly)==null?void 0:s.enabled)}function zt(){var t,s;let{app:i}=window,e=i.plugins.getPlugin("periodic-notes");return e&&((s=(t=e.settings)==null?void 0:t.yearly)==null?void 0:s.enabled)}function ei(i){let e={day:ie,week:ne,month:oe,quarter:re,year:ae}[i];return e()}function ti(i,e){return{day:Ut,month:_t,week:Ht}[i](e)}y.DEFAULT_DAILY_NOTE_FORMAT=Ge;y.DEFAULT_MONTHLY_NOTE_FORMAT=St;y.DEFAULT_QUARTERLY_NOTE_FORMAT=Ot;y.DEFAULT_WEEKLY_NOTE_FORMAT=je;y.DEFAULT_YEARLY_NOTE_FORMAT=Ft;y.appHasDailyNotesPluginLoaded=Zs;y.appHasMonthlyNotesPluginLoaded=jt;y.appHasQuarterlyNotesPluginLoaded=qt;y.appHasWeeklyNotesPluginLoaded=Gt;y.appHasYearlyNotesPluginLoaded=zt;y.createDailyNote=Ut;y.createMonthlyNote=_t;y.createPeriodicNote=ti;y.createQuarterlyNote=Xs;y.createWeeklyNote=Ht;y.createYearlyNote=Ws;y.getAllDailyNotes=Us;y.getAllMonthlyNotes=zs;y.getAllQuarterlyNotes=Ks;y.getAllWeeklyNotes=js;y.getAllYearlyNotes=Js;y.getDailyNote=Vs;y.getDailyNoteSettings=ie;y.getDateFromFile=z;y.getDateFromPath=Ms;y.getDateUID=x;y.getMonthlyNote=qs;y.getMonthlyNoteSettings=oe;y.getPeriodicNoteSettings=ei;y.getQuarterlyNote=Ys;y.getQuarterlyNoteSettings=re;y.getTemplateInfo=q;y.getWeeklyNote=Gs;y.getWeeklyNoteSettings=ne;y.getYearlyNote=Qs;y.getYearlyNoteSettings=ae});var si={};ss(si,{default:()=>Ce});module.exports=ns(si);var Wt=require("obsidian");var L=require("obsidian");var X=require("obsidian"),Le=class extends X.Modal{constructor(t,s){super(t.app);this.resolve=s;this.isConfirmed=!1;let n={app:t.app,cancelButtonText:"Cancel",cssClass:"",message:t.message,okButtonText:"OK",title:""};this.options={...n,...t},this.containerEl.addClass("confirm-modal")}onClose(){super.onClose(),this.resolve(this.isConfirmed)}onOpen(){super.onOpen(),this.titleEl.setText(this.options.title),this.contentEl.createEl("p",{text:this.options.message});let t=new X.ButtonComponent(this.contentEl);t.setClass("ok-button"),t.setButtonText(this.options.okButtonText),t.setCta(),t.onClick(()=>{this.isConfirmed=!0,this.close()});let s=new X.ButtonComponent(this.contentEl);s.setButtonText(this.options.cancelButtonText),s.onClick(this.close.bind(this))}};async function ke(i){return await new Promise(e=>{new Le(i,e).open()})}var D=class extends Error{constructor(t,s,n,o){let a=Math.ceil((n-Math.floor(Date.now()/1e3))/60);super(`GitHub API rate limit exceeded. Reset in ${a} minutes.`);this.limit=t;this.remaining=s;this.reset=n;this.requestUrl=o}getMinutesToReset(){return Math.ceil((this.reset-Math.floor(Date.now()/1e3))/60)}},S=class extends Error{constructor(e){var s,n;super(`GitHub API error ${e}: ${e.message}`),this.message=e.message;let t=e;this.status=(s=t.status)!=null?s:400,this.headers=(n=t.headers)!=null?n:{},this.name="GitHubResponseError"}};var B=require("obsidian");var ks=Me(),mt=Ve();var Te=i=>{let e=i.replace(/https?:\/\/github\.com\//i,"");return e.endsWith("/")&&(e=e.slice(0,-1)),e.toLowerCase().endsWith(".git")&&(e=e.slice(0,-4)),e},ht=["ghp_","github_pat_"],Ds=/^(gh[ps]_[a-zA-Z0-9]{36}|github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59})$/,ft=async(i,e)=>{var o,a,u,g,c,r,l,d,f,b,p;let t=["repo","public_repo","metadata=read"],s=ht.some(w=>i.toLowerCase().startsWith(w.toLowerCase())),n=Ds.test(i);if(!s||!n)return{validToken:!1,currentScopes:[],acceptedScopes:[],acceptedPermissions:[],expirationDate:null,rateLimit:{limit:0,remaining:0,reset:0,resource:"",used:0},error:{type:s?"invalid_format":"invalid_prefix",message:"Invalid token format",details:{validPrefixes:ht}}};try{let w=Date.now()%1e3,v=e||`user${w}/repo${w%100}`;if(await Ee({url:`https://api.github.com/repos/${v}`,headers:{Authorization:`Token ${i}`,Accept:"application/vnd.github.v3+json"}}),e)return{validToken:!0,currentScopes:[],acceptedScopes:[],acceptedPermissions:[],expirationDate:null,rateLimit:{limit:0,remaining:0,reset:0,resource:"",used:0},error:{type:"none",message:"No error",details:{}}};throw new Error("Expected request to fail")}catch(w){if(!(w instanceof S))throw w;let v=w.headers;if(!v)throw new Error("No headers in GitHub response");let C=v["github-authentication-token-expiration"],P=C?new Date(C):null,ce=P&&!Number.isNaN(P.getTime())?P.toISOString():null,A={validToken:!1,currentScopes:(a=(o=v["x-oauth-scopes"])==null?void 0:o.split(", "))!=null?a:[],acceptedScopes:(g=(u=v["x-accepted-oauth-scopes"])==null?void 0:u.split(", "))!=null?g:[],acceptedPermissions:(r=(c=v["x-accepted-github-permissions"])==null?void 0:c.split(", "))!=null?r:[],expirationDate:ce,rateLimit:{limit:Number.parseInt((l=v["x-ratelimit-limit"])!=null?l:"0",10),remaining:Number.parseInt((d=v["x-ratelimit-remaining"])!=null?d:"0",10),reset:Number.parseInt((f=v["x-ratelimit-reset"])!=null?f:"0",10),resource:(b=v["x-ratelimit-resource"])!=null?b:"",used:Number.parseInt((p=v["x-ratelimit-used"])!=null?p:"0",10)},error:{type:"none",message:"No error",details:{}}};return A.expirationDate&&new Date(A.expirationDate)<new Date?(A.error={type:"expired",message:"Token has expired",details:{expirationDate:A.expirationDate}},A):A.currentScopes.some(Ne=>t.includes(Ne))||A.acceptedPermissions.some(Ne=>t.includes(Ne))?(A.validToken=w.status===404,A):(A.error={type:"insufficient_scope",message:"Token lacks required scopes. Check documentation for requirements.",details:{currentScopes:[...A.acceptedScopes,...A.acceptedPermissions]}},A)}},Ue=async(i,e=!0,t="")=>{let s=`https://api.github.com/repos/${i}`;try{return(await Ee({url:s,headers:t?{Authorization:`Token ${t}`}:{}})).json.private}catch(n){if(n instanceof D)throw n;return e&&console.log("error in isPrivateRepo",s,n),!1}},bt=async(i,e=!0,t="")=>{let s=`https://api.github.com/repos/${i}/releases`;try{return(await Ee({url:`${s}?per_page=100`,headers:t?{Authorization:`Token ${t}`}:{}})).json.map(a=>({version:a.tag_name,prerelease:a.prerelease}))}catch(n){if(n instanceof D||n instanceof S)throw n;return e&&console.log("Error in fetchReleaseVersions",s,n),null}},Y=async(i,e,t=!0,s=!1,n="")=>{try{let o=i.assets.find(c=>c.name===e);if(!o)return null;let a={Accept:"application/octet-stream"};s&&n&&(a.Authorization=`Token ${n}`);let u=s?o.url:o.browser_download_url,g=await(0,B.requestUrl)({url:u,headers:a});return g.status!==200?null:g.text}catch(o){if(o instanceof D)throw o;return t&&console.log("error in grabReleaseFileFromRepository",i,o),null}},wt=async(i=!0)=>{let e="https://raw.githubusercontent.com/obsidianmd/obsidian-releases/HEAD/community-plugins.json";try{let t=await(0,B.requestUrl)({url:e});return t.status===404?null:t.json}catch(t){return i&&console.log("error in grabCommmunityPluginList",t),null}},Tt=async(i=!0)=>{let e="https://raw.githubusercontent.com/obsidianmd/obsidian-releases/HEAD/community-css-themes.json";try{let t=await(0,B.requestUrl)({url:e});return t.status===404?null:t.json}catch(t){return i&&console.log("error in grabCommmunityThemesList",t),null}},H=async(i,e=!1,t=!1)=>{let s=`https://raw.githubusercontent.com/${i}/HEAD/theme${e?"-beta":""}.css`;try{let n=await(0,B.requestUrl)({url:s});return n.status===404?null:n.text}catch(n){return t&&console.log("error in grabCommmunityThemeCssFile",n),null}},Et=async(i,e=!0)=>{let t=`https://raw.githubusercontent.com/${i}/HEAD/manifest.json`;try{let s=await(0,B.requestUrl)({url:t});return s.status===404?null:s.text}catch(s){return e&&console.log("error in grabCommmunityThemeManifestFile",s),null}},xs=i=>{let e=0;for(let t=0;t<i.length;t++)e+=i.charCodeAt(t);return e},K=i=>xs(i).toString(),W=async(i,e,t)=>{let s=await H(i,e,t);return s?K(s):"0"},$s=async(i,e,t=!0)=>{let s=`https://api.github.com/repos/${i}/commits?path=${e}&page=1&per_page=1`;try{let n=await(0,B.requestUrl)({url:s});return n.status===404?null:n.json}catch(n){return t&&console.log("error in grabLastCommitInfoForAFile",n),null}},yt=async(i,e)=>{var s;let t=await $s(i,e);return t&&t.length>0&&((s=t[0].commit.committer)!=null&&s.date)?t[0].commit.committer.date:""},He=async(i,e,t=!1,s=!1,n=!1,o)=>{var a;try{let u=e&&e!=="latest"?`https://api.github.com/repos/${i}/releases/tags/${e}`:`https://api.github.com/repos/${i}/releases`,g={Accept:"application/vnd.github.v3+json"};(n&&o||o)&&(g.Authorization=`Token ${o}`);let c=await Ee({url:u,headers:g});if(c.status===404)return null;let r=e&&e!=="latest"?[c.json]:c.json;return s&&console.log(`grabReleaseFromRepository for ${i}:`,r),(a=r.sort((l,d)=>{try{let f=mt(l.tag_name,{includePrerelease:!0,loose:!0}),b=mt(d.tag_name,{includePrerelease:!0,loose:!0});return ks(b,f)}catch(f){let b=new Date(l.published_at).getTime(),p=new Date(d.published_at).getTime();return b<p?1:b>p?-1:0}}).filter(l=>t||!l.prerelease)[0])!=null?a:null}catch(u){throw s&&console.log(`Error in grabReleaseFromRepository for ${i}:`,u),u}},Ee=async(i,e)=>{let t=0,s=0,n=0;i.headers={...i.headers,"User-Agent":"Obsidian/BRAT-Plugin"};try{return await(0,B.requestUrl)(i)}catch(o){let a=new S(o),u=a.headers;if(u&&(t=Number.parseInt(u["x-ratelimit-limit"],10),s=Number.parseInt(u["x-ratelimit-remaining"],10),n=Number.parseInt(u["x-ratelimit-reset"],10)),a.status===403&&s===0){let g=new D(t,s,n,i.url);throw e&&console.error(`BRAT
GitHub API rate limit exceeded:`,`
Request: ${g.requestUrl}`,`
Rate limits - Remaining: ${g.remaining}`,`
Reset in: ${g.getMinutesToReset()} minutes`),g}throw e&&console.log("GitHub request failed:",o),a}};var _e={pluginList:[],pluginSubListFrozenVersion:[],themesList:[],updateAtStartup:!0,updateThemesAtStartup:!0,enableAfterInstall:!0,loggingEnabled:!1,loggingPath:"BRAT-log",loggingVerboseEnabled:!1,debuggingMode:!1,notificationsEnabled:!0,personalAccessToken:"",selectLatestPluginVersionByDefault:!1,allowIncompatiblePlugins:!1};function vt(i,e,t="latest",s="",n=!1){let o=!1;i.settings.pluginList.contains(e)||(i.settings.pluginList.unshift(e),o=!0);let a=i.settings.pluginSubListFrozenVersion.find(u=>u.repo===e);a?(Object.assign(a,{repo:e,version:t,token:s.trim()!==""?s:void 0,isIncompatible:n||void 0}),o=!0):(i.settings.pluginSubListFrozenVersion.unshift({repo:e,version:t,token:s||void 0,isIncompatible:n||void 0}),o=!0),o&&i.saveSettings()}function Pt(i,e){return i.settings.pluginList.contains(e)}function It(i,e,t){let s={repo:e,lastUpdate:K(t)};i.settings.themesList.unshift(s),i.saveSettings()}function Rt(i,e){return!!i.settings.themesList.find(s=>s.repo===e)}function At(i,e,t){for(let s of i.settings.themesList)s.repo===e&&(s.lastUpdate=t,i.saveSettings())}var N=require("obsidian");var _=class{constructor(e,t){this.tokenEl=e,this.statusEl=t}async validateToken(e,t){var s,n,o,a,u,g,c,r,l,d,f,b,p;if((s=this.tokenEl)==null||s.inputEl.removeClass("valid-input","invalid-input"),!e)return(n=this.statusEl)==null||n.setText("No token provided"),(o=this.statusEl)==null||o.addClass("invalid"),(a=this.statusEl)==null||a.removeClass("valid"),!1;try{let w=await ft(e,t);return(u=this.statusEl)==null||u.removeClass("invalid","valid"),(g=this.statusEl)==null||g.empty(),w.validToken?((c=this.tokenEl)==null||c.inputEl.addClass("valid-input"),(r=this.statusEl)==null||r.addClass("valid"),this.showValidTokenInfo(w),!0):((l=this.tokenEl)==null||l.inputEl.addClass("invalid-input"),(d=this.statusEl)==null||d.addClass("invalid"),this.showErrorMessage(w.error),!1)}catch(w){return console.error("Token validation error:",w),(f=this.tokenEl)==null||f.inputEl.addClass("invalid-input"),(b=this.statusEl)==null||b.setText("Failed to validate token"),(p=this.statusEl)==null||p.addClass("invalid"),!1}}showValidTokenInfo(e){var s,n;let t=(s=this.statusEl)==null?void 0:s.createDiv({cls:"brat-token-details"});if(t&&(t.createDiv({text:"\u2713 Valid token",cls:"brat-token-status valid"}),(n=e.currentScopes)!=null&&n.length&&t.createDiv({text:`Scopes: ${e.currentScopes.join(", ")}`,cls:"brat-token-scopes"}),e.rateLimit&&t.createDiv({text:`Rate Limit: ${e.rateLimit.remaining}/${e.rateLimit.limit}`,cls:"brat-token-rate"}),e.expirationDate)){let o=new Date(e.expirationDate),a=Math.ceil((o.getTime()-Date.now())/(1e3*60*60*24));a<7&&t.createDiv({text:`\u26A0\uFE0F Token expires in ${a} days`,cls:"brat-token-warning"})}}showErrorMessage(e){var s,n,o;let t=(s=this.statusEl)==null?void 0:s.createDiv({cls:"brat-token-error"});if(t&&(t.createDiv({text:e.message}),e.details))switch(e.type){case"invalid_prefix":t.createDiv({text:`Valid prefixes: ${(n=e.details.validPrefixes)==null?void 0:n.join(", ")}`});break;case"insufficient_scope":t.createDiv({text:`Required scopes: ${(o=e.details.requiredScopes)==null?void 0:o.join(", ")}`});break}}};function Q(i,e){let t=new DocumentFragment,s=document.createElement("a");if(s.textContent=i,s.href=`https://github.com/${i}`,s.target="_blank",t.appendChild(s),e){let n=document.createTextNode(e);t.appendChild(n)}return t}function Ct({prependText:i,url:e,text:t,appendText:s}){let n=new DocumentFragment,o=document.createElement("a");if(o.textContent=t,o.href=e,i){let a=document.createTextNode(i);n.appendChild(a)}if(n.appendChild(o),s){let a=document.createTextNode(s);n.appendChild(a)}return n}var ye=require("obsidian");function E(i,e,t=10,s){if(!i.settings.notificationsEnabled)return;let n=s?ye.Platform.isDesktop?"(click=dismiss, right-click=Info)":"(click=dismiss)":"",o=new ye.Notice(`BRAT
${e}
${n}`,t*1e3);s&&(o.noticeEl.oncontextmenu=()=>{s()})}var G=(i,e=!0)=>{let t=i.createEl("div");t.style.float="right",e?(t.style.padding="15px",t.style.paddingLeft="15px",t.style.paddingRight="15px",t.style.marginLeft="15px"):(t.style.padding="10px",t.style.paddingLeft="15px",t.style.paddingRight="15px");let s=t.createDiv("coffee");s.addClass("ex-twitter-span"),s.style.paddingLeft="10px";let n=s.createDiv();n.innerText="Learn more about my work at:",s.appendChild(n);let o=s.createEl("a",{href:"https://tfthacker.com"});return o.innerText="https://tfthacker.com",t};var Nt=require("obsidian"),ve=class extends Nt.SuggestModal{constructor(e,t,s,n,o){super(e),this.versions=s,this.selected=n,this.onChoose=o,this.setTitle("Select a version"),this.setPlaceholder(`Type to search for a version for ${t}`),this.setInstructions([{command:"\u2191\u2193",purpose:"Navigate versions"},{command:"\u21B5",purpose:"Select version"},{command:"esc",purpose:"Dismiss modal"}])}getSuggestions(e){let t=e.toLowerCase();return this.versions.filter(s=>s.version.toLowerCase().contains(t))}renderSuggestion(e,t){t.createEl("div",{text:`${e.version} ${e.prerelease?"(Prerelease)":""}`})}onChooseSuggestion(e){this.onChoose(e.version)}onNoSuggestion(){this.onChoose(this.selected?this.selected:""),this.close()}};var M=class extends N.Modal{constructor(t,s,n=!1,o=!1,a="",u="",g=""){super(t.app);this.versionSetting=null;this.repositoryAddressEl=null;this.tokenInputEl=null;this.validateButton=null;this.validator=null;this.addPluginButton=null;this.cancelButton=null;this.plugin=t,this.betaPlugins=s,this.address=a,this.version=u,this.privateApiKey=g,this.usePrivateApiKey=!(g===""||g===void 0),this.openSettingsTabAfterwards=n,this.updateVersion=o,this.enableAfterInstall=t.settings.enableAfterInstall}async submitForm(){var o,a,u,g,c,r,l,d;if(this.address==="")return;let t=Te(this.address);if(this.plugin.settings.pluginSubListFrozenVersion.find(f=>f.repo===t)){await this.betaPlugins.addPlugin(t,!1,!1,!1,this.version,!0,this.enableAfterInstall,this.usePrivateApiKey?this.privateApiKey:void 0)&&this.close(),(o=this.cancelButton)==null||o.setDisabled(!1),(a=this.addPluginButton)==null||a.setDisabled(!1),(u=this.addPluginButton)==null||u.setButtonText("Add Plugin"),(g=this.versionSetting)==null||g.setDisabled(!1);return}if(!this.version&&Pt(this.plugin,t)){E(this.plugin,"This plugin is already in the list for beta testing",10);return}await this.betaPlugins.addPlugin(t,!1,!1,!1,this.version,!1,this.enableAfterInstall,this.usePrivateApiKey?this.privateApiKey:void 0)&&this.close(),(c=this.cancelButton)==null||c.setDisabled(!1),(r=this.addPluginButton)==null||r.setDisabled(!1),(l=this.addPluginButton)==null||l.setButtonText("Add Plugin"),(d=this.versionSetting)==null||d.setDisabled(!1)}updateVersionDropdown(t,s,n=""){let o;t.clear(),s.length>0&&!n&&this.plugin.settings.selectLatestPluginVersionByDefault?(o="latest",this.version="latest"):o=n,s.length<20||N.Platform.isMobile?t.addDropdown(u=>{u.addOption("","Select a version"),u.addOption("latest","Latest version");for(let g of s)u.addOption(g.version,`${g.version} ${g.prerelease?"(Prerelease)":""}`);u.onChange(g=>{var c;this.version=g,(c=this.addPluginButton)==null||c.setDisabled(this.version==="")}),u.setValue(o),u.selectEl.addClass("brat-version-selector"),u.selectEl.style.width="100%"}):t.addButton(u=>{u.setButtonText(o==="latest"?"Latest version":o||"Select a version...").setClass("brat-version-selector").setClass("button").onClick(g=>{g.preventDefault();let r=[{version:"latest",prerelease:!1},...s];new ve(this.app,this.address,r,o,d=>{var f;this.version=d,u.setButtonText(d==="latest"?"Latest version":d||"Select a version..."),(f=this.addPluginButton)==null||f.setDisabled(this.version==="")}).open()})})}onOpen(){let t=this.contentEl.createEl("h4");this.address?(t.appendText("Change plugin version: "),t.appendChild(Q(this.address))):t.setText("Github repository for beta plugin:"),this.contentEl.createEl("form",{},s=>{s.addClass("brat-modal"),(!this.address||!this.updateVersion)&&new N.Setting(s).setClass("repository-setting").then(g=>{g.addText(c=>{this.repositoryAddressEl=c,c.setPlaceholder("Repository (example: https://github.com/GitHubUserName/repository-name)"),c.setValue(this.address),c.onChange(r=>{var l,d;this.address=Te(r.trim()),this.version!==""&&(!this.address||!this.isGitHubRepositoryMatch(this.address))&&this.versionSetting&&(this.updateVersionDropdown(this.versionSetting,[]),this.versionSetting.settingEl.classList.add("disabled-setting"),this.versionSetting.setDisabled(!0),c.inputEl.classList.remove("valid-repository"),c.inputEl.classList.remove("invalid-repository")),this.version||(this.isGitHubRepositoryMatch(this.address)?(l=this.addPluginButton)==null||l.setDisabled(!1):(d=this.addPluginButton)==null||d.setDisabled(!0))}),c.inputEl.addEventListener("keydown",async r=>{var l,d,f;r.key==="Enter"&&(this.address&&(this.updateVersion&&this.version!==""||!this.updateVersion)&&(r.preventDefault(),(l=this.addPluginButton)==null||l.setDisabled(!0),(d=this.cancelButton)==null||d.setDisabled(!0),(f=this.versionSetting)==null||f.setDisabled(!0),this.submitForm()),await this.updateRepositoryVersionInfo(this.version,n))}),c.inputEl.addEventListener("blur",async()=>{await this.updateRepositoryVersionInfo(this.version,n)}),g.setDesc("Repository"),c.inputEl.style.width="100%"})});let n=s.createDiv("validation-status");this.address||n.setText("Enter a GitHub repository address to validate it."),this.versionSetting=new N.Setting(s).setClass("version-setting").setClass("disabled-setting"),this.updateVersionDropdown(this.versionSetting,[],this.version),this.versionSetting.setDisabled(!0),s.createDiv("modal-button-container",u=>{u.createEl("label",{cls:"mod-checkbox"},c=>{let r=c.createEl("input",{attr:{tabindex:-1},type:"checkbox"});r.checked=this.usePrivateApiKey,r.addEventListener("click",()=>{var l,d;this.usePrivateApiKey=r.checked,(l=this.validateButton)==null||l.setDisabled(!this.usePrivateApiKey||!this.validToken),(d=this.tokenInputEl)==null||d.setDisabled(!this.usePrivateApiKey),(!this.usePrivateApiKey||this.validToken&&this.usePrivateApiKey)&&this.updateRepositoryVersionInfo(this.version,n)}),c.appendText("Use token for this repository")}),this.tokenInputEl=new N.TextComponent(u).setPlaceholder("GitHub API key for private repository").setValue(this.privateApiKey).setDisabled(!this.usePrivateApiKey).onChange(async c=>{var r,l,d;this.privateApiKey=c.trim(),this.privateApiKey?((r=this.validateButton)==null||r.setButtonText("Validate"),(l=this.validateButton)==null||l.setDisabled(!1)):(d=this.validateButton)==null||d.setDisabled(!0)}),this.tokenInputEl.inputEl.type="password",s.createDiv("brat-token-validation-status")&&this.tokenInputEl.inputEl.parentElement&&(this.validateButton=new N.ButtonComponent(this.tokenInputEl.inputEl.parentElement).setButtonText("Validate").setDisabled(this.privateApiKey==="").onClick(async c=>{var r,l,d,f,b;c.preventDefault(),this.validToken=await((r=this.validator)==null?void 0:r.validateToken(this.privateApiKey,this.address)),this.validToken?((f=this.validateButton)==null||f.setButtonText("Valid"),(b=this.validateButton)==null||b.setDisabled(!0),this.address&&await this.updateRepositoryVersionInfo(this.version,n)):((l=this.validateButton)==null||l.setButtonText("Invalid"),(d=this.validateButton)==null||d.setDisabled(!1))}).then(async()=>{var c,r,l;this.validator=new _(this.tokenInputEl),this.validToken=await((c=this.validator)==null?void 0:c.validateToken(this.privateApiKey,this.address)),this.validToken&&this.usePrivateApiKey&&((r=this.validateButton)==null||r.setButtonText("Valid"),(l=this.validateButton)==null||l.setDisabled(!0))}))}),s.createDiv("modal-button-container",u=>{var g;u.createEl("label",{cls:"mod-checkbox"},c=>{let r=c.createEl("input",{attr:{tabindex:-1},type:"checkbox"});r.checked=this.enableAfterInstall,r.addEventListener("click",()=>{this.enableAfterInstall=r.checked}),c.appendText("Enable after installing the plugin")}),this.cancelButton=new N.ButtonComponent(u).setButtonText("Never mind").setClass("mod-cancel").onClick(()=>{this.close()}),this.addPluginButton=new N.ButtonComponent(u).setButtonText(this.updateVersion&&this.address?"Change version":"Add plugin").setCta().onClick(c=>{var r,l,d,f;c.preventDefault(),this.address!==""&&(this.updateVersion&&this.version!==""||!this.updateVersion)&&((r=this.addPluginButton)==null||r.setDisabled(!0),(l=this.addPluginButton)==null||l.setButtonText("Installing \u2026"),(d=this.cancelButton)==null||d.setDisabled(!0),(f=this.versionSetting)==null||f.setDisabled(!0),this.submitForm())}),(this.updateVersion||this.address==="")&&((g=this.addPluginButton)==null||g.setDisabled(!0))});let o=s.createDiv();o.style.borderTop="1px solid #ccc",o.style.marginTop="30px";let a=o.createSpan();a.createEl("a",{href:"https://bit.ly/o42-twitter",text:"TFTHacker"}),a.appendText(" and "),a.createEl("a",{href:"https://github.com/johannrichard",text:"johannrichard"}),a.style.fontStyle="italic",o.appendChild(a),G(o,!1),window.setTimeout(()=>{let u=s.querySelectorAll(".brat-modal .setting-item-info");for(let g of Array.from(u))g.remove()},50),s.addEventListener("submit",u=>{var g;u.preventDefault(),this.address!==""&&(this.updateVersion&&this.version!==""||!this.updateVersion)&&((g=this.addPluginButton)==null||g.setDisabled(!0),this.submitForm())})}),this.address&&window.setTimeout(async()=>{await this.updateRepositoryVersionInfo(this.version)},100)}async updateRepositoryVersionInfo(t="",s){var a,u,g,c,r,l;let n=this.repositoryAddressEl;if(this.plugin.settings.debuggingMode&&console.log(`[BRAT] Updating version dropdown for ${this.address} with selected version ${t}`),!this.address){s==null||s.setText("Repository address is required."),s==null||s.addClass("validation-status-error");return}s==null||s.setText("Validating repository address..."),s==null||s.removeClass("validation-status-error"),this.versionSetting&&this.updateVersion&&this.updateVersionDropdown(this.versionSetting,[]);let o=Te(this.address);try{let d=await bt(o,this.plugin.settings.debuggingMode,this.usePrivateApiKey?this.privateApiKey:this.plugin.settings.personalAccessToken);d&&d.length>0?(n==null||n.inputEl.classList.remove("invalid-repository"),n==null||n.inputEl.classList.add("valid-repository"),s==null||s.setText(""),this.versionSetting&&(this.versionSetting.settingEl.classList.remove("disabled-setting"),this.versionSetting.setDisabled(!1),this.updateVersionDropdown(this.versionSetting,d,t))):(n==null||n.inputEl.classList.remove("valid-repository"),n==null||n.inputEl.classList.add("invalid-repository"),s==null||s.setText("Error: No releases found in this repository."),s==null||s.addClass("validation-status-error"),(a=this.versionSetting)==null||a.settingEl.classList.add("disabled-setting"),(u=this.versionSetting)==null||u.setDisabled(!0),(g=this.addPluginButton)==null||g.setDisabled(!0))}catch(d){if(d instanceof D&&(n==null||n.inputEl.classList.remove("valid-repository"),n==null||n.inputEl.classList.add("validation-error"),s==null||s.setText(`GitHub API rate limit exceeded. Try again in ${d.getMinutesToReset()} minutes.`),this.versionSetting&&(this.versionSetting.settingEl.classList.add("disabled-setting"),this.versionSetting.setDisabled(!0),(c=this.addPluginButton)==null||c.setDisabled(!0)),E(this.plugin,`${d.message} Consider adding a personal access token in BRAT settings for higher limits. See documentation for details.`,20,()=>{window.open("https://github.com/TfTHacker/obsidian42-brat/blob/main/BRAT-DEVELOPER-GUIDE.md#github-api-rate-limits")})),d instanceof S){let f=d;switch(f.status){case 404:s==null||s.setText("Repository not found. Check the address or provide a valid token for access to a private repository.");break;case 403:s==null||s.setText("Access denied. Check your personal access token.");break;default:s==null||s.setText(`Error: ${f.message}`);break}s==null||s.addClass("validation-status-error"),(r=this.versionSetting)==null||r.setDisabled(!0),(l=this.addPluginButton)==null||l.setDisabled(!0),E(this.plugin,`${f.message} `,20)}}}onClose(){this.openSettingsTabAfterwards&&(this.plugin.app.setting.open(),this.plugin.app.setting.openTabById(this.plugin.APP_ID))}isGitHubRepositoryMatch(t){let s=t.trim().replace(/\.git$/,"").toLowerCase();return/^(?:https?:\/\/github\.com\/)?([a-zA-Z0-9._-]+)\/([a-zA-Z0-9._-]+)$/i.test(s)}};var Lt=require("obsidian");async function Pe(){try{let i=await(0,Lt.requestUrl)(`https://obsidian.md/?${Math.random()}`);return i.status>=200&&i.status<300}catch(i){return!1}}var kt=Me(),Ie=Ve(),J=class{constructor(e){this.plugin=e}displayAddNewPluginModal(e=!1,t=!1,s="",n="",o=""){new M(this.plugin,this,e,t,s,n,o).open()}async validateRepository(e,t=!1,s=!1,n="",o=""){try{let u=await Ue(e,this.plugin.settings.debuggingMode,o),g=await He(e,n,t,this.plugin.settings.debuggingMode,u,o);if(!g)return s&&(E(this.plugin,`${e}
This does not seem to be an obsidian plugin with valid releases, as there are no releases available.`,15),console.error("BRAT: validateRepository",e,t,s)),null;let c=await Y(g,"manifest.json",this.plugin.settings.debuggingMode,u,o);if(!c)return s&&(E(this.plugin,`${e}
This does not seem to be an obsidian plugin, as there is no manifest.json file.`,15),console.error("BRAT: validateRepository",e,t,s)),null;let r=JSON.parse(c);if(!("id"in r))return s&&E(this.plugin,`${e}
The plugin id attribute for the release is missing from the manifest file`,15),null;if(!("version"in r))return s&&E(this.plugin,`${e}
The version attribute for the release is missing from the manifest file`,15),null;try{let l=Ie(g.tag_name,{includePrerelease:!0,loose:!0}),d=Ie(r.version,{includePrerelease:!0,loose:!0});kt(l,d)!==0&&(s&&E(this.plugin,`${e}
Version mismatch detected:
Release tag version: ${g.tag_name}
Manifest version: ${r.version}

The release tag version will be used to ensure consistency.`,15),r.version=l.version)}catch(l){}return r}catch(u){if(u instanceof D){let g=`GitHub API rate limit exceeded. Reset in ${u.getMinutesToReset()} minutes.`;throw s&&E(this.plugin,g,15),console.error(`BRAT: validateRepository ${u}`),E(this.plugin,`${u.message} Consider adding a personal access token in BRAT settings for higher limits. See documentation for details.`,20,()=>{window.open("https://github.com/TfTHacker/obsidian42-brat/blob/main/BRAT-DEVELOPER-GUIDE.md#github-api-rate-limits")}),u}if(u instanceof S)throw s&&(u.status===401?E(this.plugin,`${e}
GitHub API Authentication error. Please verify that your personal access token is valid and set correctly.`,15):E(this.plugin,`${e}
GitHub API error ${u.status}: ${u.message}`,15)),console.error(`BRAT: validateRepository ${u}`),u;return s&&E(this.plugin,`${e}
Unspecified error encountered: ${u}, verify debug for more information.`,15),null}}async getAllReleaseFiles(e,t,s="",n=""){let o=await Ue(e,this.plugin.settings.debuggingMode,n),a=await He(e,s,t,this.plugin.settings.debuggingMode,o,n);if(!a)return Promise.reject("No release found");let u=t||s!=="";return console.log({reallyGetManifestOrNot:u,version:a.tag_name}),{mainJs:await Y(a,"main.js",this.plugin.settings.debuggingMode,o,n),manifest:u?await Y(a,"manifest.json",this.plugin.settings.debuggingMode,o,n):"",styles:await Y(a,"styles.css",this.plugin.settings.debuggingMode,o,n)}}async writeReleaseFilesToPluginFolder(e,t){var o,a;let s=`${(0,L.normalizePath)(`${this.plugin.app.vault.configDir}/plugins/${e}`)}/`,{adapter:n}=this.plugin.app.vault;await n.exists(s)||await n.mkdir(s),await n.write(`${s}main.js`,(o=t.mainJs)!=null?o:""),await n.write(`${s}manifest.json`,(a=t.manifest)!=null?a:""),t.styles&&await n.write(`${s}styles.css`,t.styles)}async addPlugin(e,t=!1,s=!1,n=!1,o="",a=!1,u=this.plugin.settings.enableAfterInstall,g=""){try{this.plugin.settings.debuggingMode&&console.log("BRAT: addPlugin",e,t,s,n,o,a,u,g?"private":"public");let c=10,r=await this.validateRepository(e,!0,!0,o,g||this.plugin.settings.personalAccessToken),l=!!r;if(l||(r=await this.validateRepository(e,!1,!0,o,g||this.plugin.settings.personalAccessToken)),r===null){let b=`${e}
A manifest.json file does not exist in the latest release of the repository. This plugin cannot be installed.`;return await this.plugin.log(b,!0),E(this.plugin,b,c),!1}if(!Object.hasOwn(r,"version")){let b=`${e}
The manifest.json file in the latest release or pre-release of the repository does not have a version number in the file. This plugin cannot be installed.`;return await this.plugin.log(b,!0),E(this.plugin,b,c),!1}let d=!1;if(Object.hasOwn(r,"minAppVersion")&&!(0,L.requireApiVersion)(r.minAppVersion)){if(o===""||o==="latest"||!this.plugin.settings.allowIncompatiblePlugins){let p=`Plugin: ${e}

The manifest.json for this plugin indicates that the Obsidian version of the app needs to be ${r.minAppVersion}, but this installation of Obsidian is ${L.apiVersion}. 

You will need to update your Obsidian to use this plugin or contact the plugin developer for more information.`;return await this.plugin.log(p,!0),E(this.plugin,p,30),!1}if(!await ke({app:this.plugin.app,message:createFragment(p=>{p.appendText("Plugin: "),p.createEl("code",{text:e}),p.createEl("br"),p.appendText("The "),p.createEl("code",{text:"manifest.json"}),p.appendText(" for this plugin indicates that the Obsidian version of the app needs to be "),p.createEl("code",{text:r.minAppVersion}),p.appendText(", but this installation of Obsidian is "),p.createEl("code",{text:L.apiVersion}),p.appendText("."),p.createEl("br"),p.appendText("Using this plugin is not recommended and may not work as expected. Use at your own risk."),p.createEl("br"),p.appendText("Do you want to install it anyways?")})}))return!1;d=!0}let f=async()=>{var w,v;let b=await this.getAllReleaseFiles(e,l,o,g||this.plugin.settings.personalAccessToken);console.log("rFiles",b),(l||b.manifest==="")&&(b.manifest=JSON.stringify(r));let p=JSON.parse((w=b.manifest)!=null?w:"");if(d&&(p.brat={isIncompatible:!0,minAppVersionOriginal:p.minAppVersion},p.minAppVersion=L.apiVersion),L.Platform.isMobile&&p.isDesktopOnly)if(this.plugin.settings.allowIncompatiblePlugins){if(!await ke({app:this.plugin.app,message:createFragment(P=>{P.appendText("Plugin: "),P.createEl("code",{text:e}),P.createEl("br"),P.appendText("The "),P.createEl("code",{text:"manifest.json"}),P.appendText(" for this plugin indicates that the plugin has "),P.createEl("code",{text:"isDesktopOnly: true"}),P.appendText(", but you are using a mobile device."),P.createEl("br"),P.appendText("Using this plugin is not recommended and may not work as expected. Use at your own risk."),P.createEl("br"),P.appendText("Do you want to forcefully run it on mobile anyways?")})}))return null;p.isDesktopOnly=!1,(v=p.brat)!=null||(p.brat={}),p.brat.isDesktopOnlyOriginal=!0,p.brat.isIncompatible=!0,d=!0}else{let C=`Plugin: ${e}

The manifest.json for this plugin indicates that the plugin has isDesktopOnly: true, but you are using a mobile device.

The plugin will not be installed.`;return await this.plugin.log(C,!0),E(this.plugin,C,30),null}if(d&&(b.manifest=JSON.stringify(p)),this.plugin.settings.debuggingMode&&console.log("BRAT: rFiles.manifest",l,b),b.mainJs===null){let C=`${e}
The release is not complete and cannot be downloaded. main.js is missing from the Release`;return await this.plugin.log(C,!0),E(this.plugin,C,c),null}return b};if(!t||a){let b=await f();if(b===null)return!1;if(await this.writeReleaseFilesToPluginFolder(r.id,b),vt(this.plugin,e,o,g,d),u){let{plugins:p}=this.plugin.app,w=(0,L.normalizePath)(`${p.getPluginFolder()}/${r.id}`);await p.loadManifest(w),await p.enablePluginAndSave(r.id)}if(await this.plugin.app.plugins.loadManifests(),a)await this.reloadPlugin(r.id),await this.plugin.log(`${e} reinstalled`,!0),E(this.plugin,`${e}
Plugin has been reinstalled and reloaded with version ${r.version}`,c);else{let p=o===""?"":` (version: ${o})`,w=`${e}${p}
The plugin has been registered with BRAT.`;u||(w+=" You may still need to enable it the Community Plugin List."),await this.plugin.log(w,!0),E(this.plugin,w,c)}}else{let b=`${this.plugin.app.vault.configDir}/plugins/${r.id}/`,p="";try{p=await this.plugin.app.vault.adapter.read(`${b}manifest.json`)}catch(P){if(P.errno===-4058||P.errno===-2)return await this.addPlugin(e,!1,l,!1,o,!1,u,g),!0;console.log("BRAT - Local Manifest Load",r.id,JSON.stringify(P,null,2))}if(o!==""&&o!=="latest")return E(this.plugin,`The version of ${e} is frozen, not updating.`,3),!1;let w=await JSON.parse(p),v=Ie(w.version,{includePrerelease:!0,loose:!0}),C=Ie(r.version,{includePrerelease:!0,loose:!0});if(kt(v,C)===-1){let P=await f();if(P===null)return!1;if(s){let A=`There is an update available for ${r.id} from version ${w.version} to ${r.version}. `;return await this.plugin.log(`${A}[Release Info](https://github.com/${e}/releases/tag/${r.version})`,!0),E(this.plugin,A,30,()=>{r&&window.open(`https://github.com/${e}/releases/tag/${r.version}`)}),!1}await this.writeReleaseFilesToPluginFolder(r.id,P),await this.plugin.app.plugins.loadManifests(),await this.reloadPlugin(r.id);let ce=`${r.id}
Plugin has been updated from version ${w.version} to ${r.version}. `;return await this.plugin.log(`${ce}[Release Info](https://github.com/${e}/releases/tag/${r.version})`,!0),E(this.plugin,ce,30,()=>{r&&window.open(`https://github.com/${e}/releases/tag/${r.version}`)}),!0}return n&&E(this.plugin,`No update available for ${e}`,3),!0}}catch(c){console.error(`BRAT: Error adding plugin ${e}:`,{error:c,updatePluginFiles:t,seeIfUpdatedOnly:s,specifyVersion:o,forceReinstall:a});let r=c instanceof Error?c.message:"Unknown error occurred";return await this.plugin.log(`Error ${t?"updating":"adding"} plugin ${e}: ${r}`,!0),!1}return!0}async reloadPlugin(e){let{plugins:t}=this.plugin.app;try{await t.disablePlugin(e),await t.enablePlugin(e)}catch(s){this.plugin.settings.debuggingMode&&console.log("reload plugin",s)}}async updatePlugin(e,t=!1,s=!1,n=!1,o=""){let a=await this.addPlugin(e,!0,t,s,"",n,!1,o);return!a&&!t&&E(this.plugin,`${e}
Update of plugin failed.`),a}async checkForPluginUpdatesAndInstallUpdates(e=!1,t=!1){var u,g;if(!await Pe()){console.log("BRAT: No internet detected.");return}let s,n="Checking for plugin updates STARTED";await this.plugin.log(n,!0),e&&this.plugin.settings.notificationsEnabled&&(s=new L.Notice(`BRAT
${n}`,3e4));let o=new Map(this.plugin.settings.pluginSubListFrozenVersion.map(c=>[c.repo,{version:c.version,token:c.token}]));for(let c of this.plugin.settings.pluginList)o.has(c)&&((u=o.get(c))==null?void 0:u.version)!=="latest"||await this.updatePlugin(c,t,!1,!1,(g=o.get(c))==null?void 0:g.token);let a="Checking for plugin updates COMPLETED";await this.plugin.log(a,!0),e&&(s&&s.hide(),E(this.plugin,a,10))}deletePlugin(e){let t=`Removed ${e} from BRAT plugin list`;this.plugin.log(t,!0),this.plugin.settings.pluginList=this.plugin.settings.pluginList.filter(s=>s!==e),this.plugin.settings.pluginSubListFrozenVersion=this.plugin.settings.pluginSubListFrozenVersion.filter(s=>s.repo!==e),this.plugin.saveSettings()}getEnabledDisabledPlugins(e){let t=this.plugin.app.plugins,s=Object.values(t.manifests),n=Object.values(t.plugins).map(o=>o.manifest);return e?s.filter(o=>n.find(a=>o.id===a.id)):s.filter(o=>!n.find(a=>o.id===a.id))}checkIncompatiblePlugins(){let e=this.plugin.settings.pluginSubListFrozenVersion.filter(t=>t.isIncompatible).map(t=>t.repo);e.length>0&&E(this.plugin,`The following incompatible plugins were forcefully installed by BRAT and may not work as expected:
${e.join(`
`)}`,30)}};var V=require("obsidian");var Z=async(i,e,t)=>{let s=await H(e,!0,i.settings.debuggingMode);if(s||(s=await H(e,!1,i.settings.debuggingMode)),!s)return E(i,"There is no theme.css or theme-beta.css file in the root path of this repository, so there is no theme to install."),!1;let n=await Et(e,i.settings.debuggingMode);if(!n)return E(i,"There is no manifest.json file in the root path of this repository, so theme cannot be installed."),!1;let o=await JSON.parse(n),a=(0,V.normalizePath)(Ss(i)+o.name),{adapter:u}=i.app.vault;await u.exists(a)||await u.mkdir(a),await u.write((0,V.normalizePath)(`${a}/theme.css`),s),await u.write((0,V.normalizePath)(`${a}/manifest.json`),n),At(i,e,K(s));let g="";return t?(It(i,e,s),g=`${o.name} theme installed from ${e}. `,setTimeout(()=>{i.app.customCss.setTheme(o.name)},500)):g=`${o.name} theme updated from ${e}.`,i.log(`${g}[Theme Info](https://github.com/${e})`,!1),E(i,g,20,()=>{window.open(`https://github.com/${e}`)}),!0},j=async(i,e)=>{if(!await Pe()){console.log("BRAT: No internet detected.");return}let t,s="Checking for beta theme updates STARTED";await i.log(s,!0),e&&i.settings.notificationsEnabled&&(t=new V.Notice(`BRAT
${s}`,3e4));for(let o of i.settings.themesList){let a=await W(o.repo,!0,i.settings.debuggingMode);a==="0"&&(a=await W(o.repo,!1,i.settings.debuggingMode)),console.log("BRAT: lastUpdateOnline",a),a!==o.lastUpdate&&await Z(i,o.repo,!1)}let n="Checking for beta theme updates COMPLETED";(async()=>await i.log(n,!0))(),e&&(i.settings.notificationsEnabled&&t&&t.hide(),E(i,n))},Re=(i,e)=>{i.settings.themesList=i.settings.themesList.filter(s=>s.repo!==e),i.saveSettings();let t=`Removed ${e} from BRAT themes list and will no longer be updated. However, the theme files still exist in the vault. To remove them, go into Settings > Appearance and remove the theme.`;i.log(t,!0),E(i,t)},Ss=i=>`${(0,V.normalizePath)(`${i.app.vault.configDir}/themes`)}/`;var U=require("obsidian");var F=class extends U.Modal{constructor(e,t=!1){super(e.app),this.plugin=e,this.address="",this.openSettingsTabAfterwards=t}async submitForm(){if(this.address==="")return;let e=this.address.replace("https://github.com/","");if(Rt(this.plugin,e)){E(this.plugin,"This theme is already in the list for beta testing",10);return}await Z(this.plugin,e,!0)&&this.close()}onOpen(){this.contentEl.createEl("h4",{text:"Github repository for beta theme:"}),this.contentEl.createEl("form",{},e=>{e.addClass("brat-modal"),new U.Setting(e).addText(n=>{n.setPlaceholder("Repository (example: https://github.com/GitHubUserName/repository-name"),n.setValue(this.address),n.onChange(o=>{this.address=o.trim()}),n.inputEl.addEventListener("keydown",o=>{o.key==="Enter"&&this.address!==" "&&(o.preventDefault(),this.submitForm())}),n.inputEl.style.width="100%",window.setTimeout(()=>{let o=document.querySelector(".setting-item-info");o&&o.remove(),n.inputEl.focus()},10)}),e.createDiv("modal-button-container",n=>{new U.ButtonComponent(n).setButtonText("Never mind").onClick(()=>{this.close()}),new U.ButtonComponent(n).setButtonText("Add theme").setCta().onClick(o=>{o.preventDefault(),console.log("Add theme button clicked"),this.address!==""&&this.submitForm()})});let t=e.createDiv();t.style.borderTop="1px solid #ccc",t.style.marginTop="30px";let s=t.createSpan();s.createEl("a",{href:"https://bit.ly/o42-twitter",text:"TFTHacker"}),s.appendText(" and "),s.createEl("a",{href:"https://github.com/johannrichard",text:"johannrichard"}),s.style.fontStyle="italic",t.appendChild(s),G(t,!1),window.setTimeout(()=>{let n=e.querySelectorAll(".brat-modal .setting-item-info");for(let o of Array.from(n))o.remove()},50)})}onClose(){this.openSettingsTabAfterwards&&(this.plugin.app.setting.openTab(),this.plugin.app.setting.openTabById(this.plugin.APP_ID))}};var Dt=require("obsidian"),k=class extends Dt.FuzzySuggestModal{constructor(t){super(t.app);this.data=[];this.scope.register(["Shift"],"Enter",s=>{this.enterTrigger(s)}),this.scope.register(["Ctrl"],"Enter",s=>{this.enterTrigger(s)})}setSuggesterData(t){this.data=t}display(t){this.callbackFunction=t,this.open()}getItems(){return this.data}getItemText(t){return t.display}onChooseItem(){}renderSuggestion(t,s){s.createEl("div",{text:t.item.display})}enterTrigger(t){var o;let s=(o=document.querySelector(".suggestion-item.is-selected div"))==null?void 0:o.textContent,n=this.data.find(a=>a.display===s);n&&(this.invokeCallback(n,t),this.close())}onChooseSuggestion(t,s){this.invokeCallback(t.item,s)}invokeCallback(t,s){typeof this.callbackFunction=="function"&&this.callbackFunction(t,s)}};var ee=class{constructor(e){this.bratCommands=[{id:"AddBetaPlugin",icon:"BratIcon",name:"Plugins: Add a beta plugin for testing (with or without version)",showInRibbon:!0,callback:()=>{this.plugin.betaPlugins.displayAddNewPluginModal(!1,!0)}},{id:"checkForUpdatesAndUpdate",icon:"BratIcon",name:"Plugins: Check for updates to all beta plugins and UPDATE",showInRibbon:!0,callback:async()=>{await this.plugin.betaPlugins.checkForPluginUpdatesAndInstallUpdates(!0,!1)}},{id:"checkForUpdatesAndDontUpdate",icon:"BratIcon",name:"Plugins: Only check for updates to beta plugins, but don't Update",showInRibbon:!0,callback:async()=>{await this.plugin.betaPlugins.checkForPluginUpdatesAndInstallUpdates(!0,!0)}},{id:"updateOnePlugin",icon:"BratIcon",name:"Plugins: Choose a single plugin version to update",showInRibbon:!0,callback:()=>{let e=new Map(this.plugin.settings.pluginSubListFrozenVersion.map(n=>[n.repo,{version:n.version,token:n.token}])),t=Object.values(this.plugin.settings.pluginList).filter(n=>{let o=e.get(n);return!(o!=null&&o.version)||o.version==="latest"}).map(n=>({display:n,info:n})),s=new k(this.plugin);s.setSuggesterData(t),s.display(n=>{let o=`Checking for updates for ${n.info}`,a=e.get(n.info);this.plugin.log(o,!0),E(this.plugin,`
${o}`,3),this.plugin.betaPlugins.updatePlugin(n.info,!1,!0,!1,a==null?void 0:a.token)})}},{id:"reinstallOnePlugin",icon:"BratIcon",name:"Plugins: Choose a single plugin to reinstall",showInRibbon:!0,callback:()=>{let e=new Set(this.plugin.settings.pluginSubListFrozenVersion.map(n=>n.repo)),t=Object.values(this.plugin.settings.pluginList).filter(n=>!e.has(n)).map(n=>({display:n,info:n})),s=new k(this.plugin);s.setSuggesterData(t),s.display(n=>{let o=`Reinstalling ${n.info}`;E(this.plugin,`
${o}`,3),this.plugin.log(o,!0),this.plugin.betaPlugins.updatePlugin(n.info,!1,!1,!0)})}},{id:"restartPlugin",icon:"BratIcon",name:"Plugins: Restart a plugin that is already installed",showInRibbon:!0,callback:()=>{let e=Object.values(this.plugin.app.plugins.manifests).map(s=>({display:s.id,info:s.id})),t=new k(this.plugin);t.setSuggesterData(e),t.display(s=>{E(this.plugin,`${s.info}
Plugin reloading .....`,5),this.plugin.betaPlugins.reloadPlugin(s.info)})}},{id:"disablePlugin",icon:"BratIcon",name:"Plugins: Disable a plugin - toggle it off",showInRibbon:!0,callback:()=>{let e=this.plugin.betaPlugins.getEnabledDisabledPlugins(!0).map(s=>({display:`${s.name} (${s.id})`,info:s.id})),t=new k(this.plugin);t.setSuggesterData(e),t.display(s=>{this.plugin.log(`${s.display} plugin disabled`,!1),this.plugin.settings.debuggingMode&&console.log(s.info),this.plugin.app.plugins.disablePluginAndSave(s.info)})}},{id:"enablePlugin",icon:"BratIcon",name:"Plugins: Enable a plugin - toggle it on",showInRibbon:!0,callback:()=>{let e=this.plugin.betaPlugins.getEnabledDisabledPlugins(!1).map(s=>({display:`${s.name} (${s.id})`,info:s.id})),t=new k(this.plugin);t.setSuggesterData(e),t.display(s=>{this.plugin.log(`${s.display} plugin enabled`,!1),this.plugin.app.plugins.enablePluginAndSave(s.info)})}},{id:"openGitHubZRepository",icon:"BratIcon",name:"Plugins: Open the GitHub repository for a plugin",showInRibbon:!0,callback:async()=>{let e=await wt(this.plugin.settings.debuggingMode);if(e){let t=Object.values(e).map(o=>({display:`Plugin: ${o.name}  (${o.repo})`,info:o.repo})),s=Object.values(this.plugin.settings.pluginList).map(o=>({display:`BRAT: ${o}`,info:o}));for(let o of t)s.push(o);let n=new k(this.plugin);n.setSuggesterData(s),n.display(o=>{o.info&&window.open(`https://github.com/${o.info}`)})}}},{id:"openGitHubRepoTheme",icon:"BratIcon",name:"Themes: Open the GitHub repository for a theme (appearance)",showInRibbon:!0,callback:async()=>{let e=await Tt(this.plugin.settings.debuggingMode);if(e){let t=Object.values(e).map(n=>({display:`Theme: ${n.name}  (${n.repo})`,info:n.repo})),s=new k(this.plugin);s.setSuggesterData(t),s.display(n=>{n.info&&window.open(`https://github.com/${n.info}`)})}}},{id:"opentPluginSettings",icon:"BratIcon",name:"Plugins: Open Plugin Settings Tab",showInRibbon:!0,callback:()=>{let e=this.plugin.app.setting,t=Object.values(e.pluginTabs).map(o=>({display:`Plugin: ${o.name}`,info:o.id})),s=new k(this.plugin),n=Object.values(e.settingTabs).map(o=>({display:`Core: ${o.name}`,info:o.id}));for(let o of t)n.push(o);s.setSuggesterData(n),s.display(o=>{e.open(),e.openTabById(o.info)})}},{id:"GrabBetaTheme",icon:"BratIcon",name:"Themes: Grab a beta theme for testing from a Github repository",showInRibbon:!0,callback:()=>{new F(this.plugin).open()}},{id:"updateBetaThemes",icon:"BratIcon",name:"Themes: Update beta themes",showInRibbon:!0,callback:async()=>{await j(this.plugin,!0)}},{id:"allCommands",icon:"BratIcon",name:"All Commands list",showInRibbon:!1,callback:()=>{this.ribbonDisplayCommands()}}];this.plugin=e;for(let t of this.bratCommands)this.plugin.addCommand({id:t.id,name:t.name,icon:t.icon,callback:()=>{t.callback()}})}ribbonDisplayCommands(){let e=[];for(let a of this.bratCommands)a.showInRibbon&&e.push({display:a.name,info:a.callback});let t=new k(this.plugin),s=this.plugin.app.setting,n=Object.values(s.settingTabs).map(a=>({display:`Core: ${a.name}`,info:()=>{s.open(),s.openTabById(a.id)}})),o=Object.values(s.pluginTabs).map(a=>({display:`Plugin: ${a.name}`,info:()=>{s.open(),s.openTabById(a.id)}}));e.push({display:"---- Core Plugin Settings ----",info:()=>{this.ribbonDisplayCommands()}});for(let a of n)e.push(a);e.push({display:"---- Plugin Settings ----",info:()=>{this.ribbonDisplayCommands()}});for(let a of o)e.push(a);t.setSuggesterData(e),t.display(a=>{typeof a.info=="function"&&a.info()})}};var R=require("obsidian");var Ae=class extends R.PluginSettingTab{constructor(t,s){super(t,s);this.accessTokenSetting=null;this.accessTokenButton=null;this.tokenInfo=null;this.validator=null;this.plugin=s}display(){let{containerEl:t}=this;t.empty(),t.addClass("brat-settings"),new R.Setting(t).setName("Auto-enable plugins after installation").setDesc('If enabled beta plugins will be automatically enabled after installtion by default. Note: you can toggle this on and off for each plugin in the "Add Plugin" form.').addToggle(r=>{r.setValue(this.plugin.settings.enableAfterInstall).onChange(async l=>{this.plugin.settings.enableAfterInstall=l,await this.plugin.saveSettings()})}),new R.Setting(t).setName("Auto-update plugins at startup").setDesc("If enabled all beta plugins will be checked for updates each time Obsidian starts. Note: this does not update frozen version plugins.").addToggle(r=>{r.setValue(this.plugin.settings.updateAtStartup).onChange(async l=>{this.plugin.settings.updateAtStartup=l,await this.plugin.saveSettings()})}),new R.Setting(t).setName("Auto-update themes at startup").setDesc("If enabled all beta themes will be checked for updates each time Obsidian starts.").addToggle(r=>{r.setValue(this.plugin.settings.updateThemesAtStartup).onChange(async l=>{this.plugin.settings.updateThemesAtStartup=l,await this.plugin.saveSettings()})}),new R.Setting(t).setName("Select latest plugin version by default").setDesc("If enabled the latest version will be selected by default when adding a new plugin.").addToggle(r=>{r.setValue(this.plugin.settings.selectLatestPluginVersionByDefault).onChange(async l=>{this.plugin.settings.selectLatestPluginVersionByDefault=l,await this.plugin.saveSettings()})}),new R.Setting(t).setName("Allow incompatible plugins").setDesc("If enabled, plugins with higher app versions will be allowed to be installed. Also it allows desktop-only plugins to be installed on mobile devices.").addToggle(r=>{r.setValue(this.plugin.settings.allowIncompatiblePlugins).onChange(async l=>{this.plugin.settings.allowIncompatiblePlugins=l,await this.plugin.saveSettings()})}),G(t,!0),t.createEl("hr"),new R.Setting(t).setName("Beta plugin list").setHeading(),t.createEl("div",{text:'The following is a list of beta plugins added via the command "Add a beta plugin for testing". You can chose to add the latest version or a frozen version. A frozen version is a specific release of a plugin based on its release tag.'}),t.createEl("p"),t.createEl("div",{text:"Click the 'Edit' button next to a plugin to change the installed version and the x button next to a plugin to remove it from the list."}),t.createEl("p"),t.createEl("span").createEl("b",{text:"Note: "}),t.createSpan({text:"Removing from the list does not delete the plugin, this should be done from the Community Plugins tab in Settings."});let s=t.createDiv("brat-filter-and-button"),n=s.createEl("input",{type:"text",placeholder:"Filter plugins",cls:"brat-filter-input"});n.setAttribute("auotocorrect","off"),n.setAttribute("autocapitalize","off"),n.setAttribute("spellcheck","false"),new R.Setting(s).addButton(r=>{r.setButtonText("Add beta plugin").setCta().onClick(()=>{this.plugin.betaPlugins.displayAddNewPluginModal(!0)})});let o=new Map(this.plugin.settings.pluginSubListFrozenVersion.map(r=>[r.repo,r])),a=new Map;for(let r of this.plugin.settings.pluginList){let l=o.get(r),d=new R.Setting(t).setName(Q(r)).setDesc((l!=null&&l.version?` Tracked version: ${l.version} ${l.version==="latest"?"":"(frozen)"}`:"")+(l!=null&&l.isIncompatible?" (incompatible)":"")),f=d.settingEl;f.addClass("brat-plugin-item"),a.set(r,{container:f,pluginName:r.toLowerCase()}),(!(l!=null&&l.version)||l.version==="latest")&&d.addButton(b=>{b.setIcon("sync").setTooltip("Check and update plugin").onClick(async()=>{await this.plugin.betaPlugins.updatePlugin(r,!1,!0,!1,l==null?void 0:l.token)})}),d.addButton(b=>{b.setIcon("edit").setTooltip("Change version").onClick(()=>{this.plugin.betaPlugins.displayAddNewPluginModal(!0,!0,r,l==null?void 0:l.version,l==null?void 0:l.token),this.plugin.app.setting.updatePluginSection()})}).addButton(b=>{b.setIcon("cross").setTooltip("Remove this beta plugin").setWarning().onClick(()=>{if(b.buttonEl.textContent==="")b.setButtonText("Click once more to confirm removal");else{let{buttonEl:p}=b,{parentElement:w}=p;w!=null&&w.parentElement&&(w.parentElement.remove(),this.plugin.betaPlugins.deletePlugin(r))}})})}n.addEventListener("input",r=>{let l=r.target.value.toLowerCase().trim();a.forEach(({container:d,pluginName:f})=>{l===""||f.includes(l)?d.removeAttribute("hidden"):d.setAttribute("hidden","true")})}),new R.Setting(t).setName("Beta themes list").setHeading();let u=t.createDiv("brat-filter-and-button"),g=u.createEl("input",{type:"text",placeholder:"Filter themes",cls:"brat-filter-input"});g.setAttribute("auotocorrect","off"),g.setAttribute("autocapitalize","off"),g.setAttribute("spellcheck","false"),new R.Setting(u).addButton(r=>{r.setButtonText("Add beta theme").setCta().onClick(()=>{this.plugin.app.setting.close(),new F(this.plugin).open()})});let c=new Map;for(let r of this.plugin.settings.themesList){let l=new R.Setting(t).setName(Q(r.repo)),d=l.settingEl;d.addClass("brat-theme-item"),c.set(r.repo,{container:d,themeName:r.repo.toLowerCase()}),l.addButton(f=>{f.setIcon("cross").setTooltip("Delete this beta theme").onClick(()=>{if(f.buttonEl.textContent==="")f.setButtonText("Click once more to confirm removal");else{let{buttonEl:b}=f,{parentElement:p}=b;p!=null&&p.parentElement&&(p.parentElement.remove(),Re(this.plugin,r.repo))}})})}g.addEventListener("input",r=>{let l=r.target.value.toLowerCase().trim();c.forEach(({container:d,themeName:f})=>{l===""||f.includes(l)?d.removeAttribute("hidden"):d.setAttribute("hidden","true")})}),new R.Setting(t).setName("Monitoring").setHeading(),new R.Setting(t).setName("Enable notifications").setDesc("BRAT will provide popup notifications for its various activities. Turn this off means  no notifications from BRAT.").addToggle(r=>{r.setValue(this.plugin.settings.notificationsEnabled),r.onChange(async l=>{this.plugin.settings.notificationsEnabled=l,await this.plugin.saveSettings()})}),new R.Setting(t).setName("Enable logging").setDesc("Plugin updates will be logged to a file in the log file.").addToggle(r=>{r.setValue(this.plugin.settings.loggingEnabled).onChange(async l=>{this.plugin.settings.loggingEnabled=l,await this.plugin.saveSettings()})}),new R.Setting(this.containerEl).setName("BRAT log file location").setDesc("Logs will be saved to this file. Don't add .md to the file name.").addSearch(r=>{r.setPlaceholder("Example: BRAT-log").setValue(this.plugin.settings.loggingPath).onChange(async l=>{this.plugin.settings.loggingPath=l,await this.plugin.saveSettings()})}),new R.Setting(t).setName("Enable verbose logging").setDesc("Get a lot  more information in  the log.").addToggle(r=>{r.setValue(this.plugin.settings.loggingVerboseEnabled).onChange(async l=>{this.plugin.settings.loggingVerboseEnabled=l,await this.plugin.saveSettings()})}),new R.Setting(t).setName("Debugging mode").setDesc("Atomic Bomb level console logging. Can be used for troubleshooting and development.").addToggle(r=>{r.setValue(this.plugin.settings.debuggingMode).onChange(async l=>{this.plugin.settings.debuggingMode=l,await this.plugin.saveSettings()})}),new R.Setting(t).setName("Personal access token").setDesc(Ct({prependText:"Set a personal access token to increase rate limits for public repositories on GitHub. You can create one in ",url:"https://github.com/settings/tokens/new?scopes=public_repo",text:"your GitHub account settings",appendText:" and then add it here. Please consult the documentation for more details."})).addText(r=>{var l;this.accessTokenSetting=r,r.setPlaceholder("Enter your personal access token").setValue((l=this.plugin.settings.personalAccessToken)!=null?l:"").onChange(async d=>{var f,b,p;d===""?(this.plugin.settings.personalAccessToken="",this.plugin.saveSettings(),(f=this.accessTokenButton)==null||f.setDisabled(!0),(b=this.validator)==null||b.validateToken("")):(p=this.accessTokenButton)==null||p.setDisabled(!1)}),r.inputEl.addClass("brat-token-input")}).addExtraButton(r=>{r.setIcon("cross").setTooltip("Clear personal access token").onClick(async()=>{var l,d;this.plugin.settings.personalAccessToken="",(l=this.accessTokenSetting)==null||l.setValue(""),await((d=this.validator)==null?void 0:d.validateToken("")),this.plugin.saveSettings()})}).addButton(r=>{this.accessTokenButton=r,r.setButtonText("Validate").setCta().onClick(async()=>{var d,f,b;let l=(d=this.accessTokenSetting)==null?void 0:d.inputEl.value;l&&await((f=this.validator)==null?void 0:f.validateToken(l))&&(this.plugin.settings.personalAccessToken=l,this.plugin.saveSettings(),(b=this.accessTokenButton)==null||b.setDisabled(!0))})}).then(()=>{var r,l;this.tokenInfo=this.createTokenInfoElement(t),this.validator=new _(this.accessTokenSetting,this.tokenInfo),(l=this.validator)==null||l.validateToken((r=this.plugin.settings.personalAccessToken)!=null?r:"").then(d=>{var f;(f=this.accessTokenButton)==null||f.setDisabled(d||this.plugin.settings.personalAccessToken==="")})})}createTokenInfoElement(t){let s=t.createDiv({cls:"brat-token-info"});return s.createDiv({cls:"brat-token-status"}),s.createDiv({cls:"brat-token-details"}),s}};var xt=require("obsidian");function $t(){(0,xt.addIcon)("BratIcon",'<path fill="currentColor" stroke="currentColor"  d="M 41.667969 41.667969 C 41.667969 39.367188 39.800781 37.5 37.5 37.5 C 35.199219 37.5 33.332031 39.367188 33.332031 41.667969 C 33.332031 43.96875 35.199219 45.832031 37.5 45.832031 C 39.800781 45.832031 41.667969 43.96875 41.667969 41.667969 Z M 60.417969 58.582031 C 59.460938 58.023438 58.320312 57.867188 57.25 58.148438 C 56.179688 58.429688 55.265625 59.125 54.707031 60.082031 C 53.746094 61.777344 51.949219 62.820312 50 62.820312 C 48.050781 62.820312 46.253906 61.777344 45.292969 60.082031 C 44.734375 59.125 43.820312 58.429688 42.75 58.148438 C 41.679688 57.867188 40.539062 58.023438 39.582031 58.582031 C 37.597656 59.726562 36.910156 62.257812 38.042969 64.25 C 40.5 68.53125 45.0625 71.171875 50 71.171875 C 54.9375 71.171875 59.5 68.53125 61.957031 64.25 C 63.089844 62.257812 62.402344 59.726562 60.417969 58.582031 Z M 62.5 37.5 C 60.199219 37.5 58.332031 39.367188 58.332031 41.667969 C 58.332031 43.96875 60.199219 45.832031 62.5 45.832031 C 64.800781 45.832031 66.667969 43.96875 66.667969 41.667969 C 66.667969 39.367188 64.800781 37.5 62.5 37.5 Z M 50 8.332031 C 26.988281 8.332031 8.332031 26.988281 8.332031 50 C 8.332031 73.011719 26.988281 91.667969 50 91.667969 C 73.011719 91.667969 91.667969 73.011719 91.667969 50 C 91.667969 26.988281 73.011719 8.332031 50 8.332031 Z M 50 83.332031 C 33.988281 83.402344 20.191406 72.078125 17.136719 56.363281 C 14.078125 40.644531 22.628906 24.976562 37.5 19.042969 C 37.457031 19.636719 37.457031 20.238281 37.5 20.832031 C 37.5 27.738281 43.097656 33.332031 50 33.332031 C 52.300781 33.332031 54.167969 31.46875 54.167969 29.167969 C 54.167969 26.867188 52.300781 25 50 25 C 47.699219 25 45.832031 23.132812 45.832031 20.832031 C 45.832031 18.53125 47.699219 16.667969 50 16.667969 C 68.410156 16.667969 83.332031 31.589844 83.332031 50 C 83.332031 68.410156 68.410156 83.332031 50 83.332031 Z M 50 83.332031 " />')}var te=class{constructor(e){this.console=(e,...t)=>{console.log(`BRAT: ${e}`,...t)};this.themes={themeseCheckAndUpates:async e=>{await j(this.plugin,e)},themeInstallTheme:async e=>{let t=e.replace("https://github.com/","");await Z(this.plugin,t,!0)},themesDelete:e=>{let t=e.replace("https://github.com/","");Re(this.plugin,t)},grabCommmunityThemeCssFile:async(e,t=!1)=>await H(e,t,this.plugin.settings.debuggingMode),grabChecksumOfThemeCssFile:async(e,t=!1)=>await W(e,t,this.plugin.settings.debuggingMode),grabLastCommitDateForFile:async(e,t)=>await yt(e,t)};this.plugin=e}};var ue=require("obsidian"),Yt=is(Xt());async function Kt(i,e,t=!1){if(i.settings.debuggingMode&&console.log(`BRAT: ${e}`),i.settings.loggingEnabled){if(!i.settings.loggingVerboseEnabled&&t)return;let s=`${i.settings.loggingPath}.md`,n=`[[${(0,ue.moment)().format((0,Yt.getDailyNoteSettings)().format).toString()}]] ${(0,ue.moment)().format("HH:mm")}`,o=window.require("os"),a=ue.Platform.isDesktop?o.hostname():"MOBILE",u=`${n} ${a} ${e.replace(`
`," ")}
`,g=i.app.vault.getAbstractFileByPath(s);g?await i.app.vault.append(g,u):g=await i.app.vault.create(s,u)}}var Ce=class extends Wt.Plugin{constructor(){super(...arguments);this.APP_NAME="BRAT";this.APP_ID="obsidian42-brat";this.settings=_e;this.betaPlugins=new J(this);this.commands=new ee(this);this.bratApi=new te(this);this.obsidianProtocolHandler=t=>{if(!t.plugin&&!t.theme){E(this,"Could not locate the repository from the URL.",10);return}for(let s of["plugin","theme"])if(t[s]){let n;switch(s){case"plugin":n=new M(this,this.betaPlugins,!0,!1,t[s],t.version?t.version:void 0),n.open();break;case"theme":n=new F(this),n.address=t[s],n.open();break}return}}}onload(){console.log(`loading ${this.APP_NAME}`),$t(),this.addRibbonIcon("BratIcon","BRAT",()=>{this.commands.ribbonDisplayCommands()}),this.loadSettings().then(()=>{this.app.workspace.onLayoutReady(()=>{this.addSettingTab(new Ae(this.app,this)),this.registerObsidianProtocolHandler("brat",this.obsidianProtocolHandler),this.betaPlugins.checkIncompatiblePlugins(),this.settings.updateAtStartup&&setTimeout(()=>{this.betaPlugins.checkForPluginUpdatesAndInstallUpdates(!1)},6e4),this.settings.updateThemesAtStartup&&setTimeout(()=>{j(this,!1)},12e4),setTimeout(()=>{window.bratAPI=this.bratApi},500)})}).catch(t=>{console.error("Failed to load settings:",t)})}async log(t,s=!1){await Kt(this,t,s)}onunload(){console.log(`unloading ${this.APP_NAME}`)}async loadSettings(){this.settings=Object.assign({},_e,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}};

/* nosourcemap */